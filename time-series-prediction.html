<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-07-03 Mon 11:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Time Series Prediction</title>
<meta name="author" content="Zain Jabbar" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<title></title><link rel="stylesheet" href="static/css/site.css" type="text/css"/>
<header><div class="menu"><ul>
<li><a href="/">/</a></li>
<li><a href="/about">/about</a></li>
<li><a href="/posts">/posts</a></li></ul></div></header><script src="static/js/nastaliq.js"></script>

<script>
  MathJax = {
    loader: {
      load: ['[custom]/xypic.js'],
      paths: {custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/'}
    },
    tex: {
      packages: {'[+]': ['xypic']}
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml-full.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Time Series Prediction</h1>
<p>
Here we will use and become familiar with the following Python packages for data science
</p>

<ul class="org-ul">
<li>SQLAlchemy</li>
<li>Pandas</li>
<li>TensorFlow</li>
</ul>

<p>
Here we will learn to use TensorFlow to build a predictive model which can forecast power consumption of a given building.
</p>

<div id="outline-container-org03eafef" class="outline-2">
<h2 id="org03eafef"><span class="section-number-2">1.</span> What We're Building Towards</h2>
<div class="outline-text-2" id="text-1">
<p>
I tend to be verbose when explaining. Here is a plug and play version of the code.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #8f0075;">print</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"Hello World"</span><span style="color: #000000;">)</span>
</pre>
</div>

<p>
We would like the model to use data from the previous week to predict the next days worth of data.
</p>

<p>
From the previous week we will use 
</p>
</div>
</div>


<div id="outline-container-orgce1be74" class="outline-2">
<h2 id="orgce1be74"><span class="section-number-2">2.</span> Importing the Dataset</h2>
<div class="outline-text-2" id="text-2">
<p>
In order to train the model, we need something to train <b>on</b>. 
</p>
</div>

<div id="outline-container-org698502e" class="outline-3">
<h3 id="org698502e"><span class="section-number-3">2.1.</span> Locating the Data in SQL</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The data is stored on a server
</p>
</div>
</div>


<div id="outline-container-org4d020d7" class="outline-3">
<h3 id="org4d020d7"><span class="section-number-3">2.2.</span> Creating a Pandas DataFrame</h3>
<div class="outline-text-3" id="text-2-2">
<p>
In Python, the easiest way to manipulate data for sake of plotting and wrangling is via Pandas. So far we have created a <code>SQLAlchemy</code> selectable. To execute the query and hold the data in memory, we use <code>pd.read_sql</code>.
</p>
</div>
</div>


<div id="outline-container-orgd89e7fb" class="outline-3">
<h3 id="orgd89e7fb"><span class="section-number-3">2.3.</span> Creating TensorFlow dataset</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Now that we have the data in memory and visualized we will now begin to make the data represented in a manner which is more efficient to train on.
</p>

<p>
Firstly, we want the data to be in the form \( X,y \) where \( X = \text{Input}, y = \text{Response} \) where the model will try to learn a function \( \begin{xy} \xymatrix{X \ar[r]^{f} & y} \end{xy} \). Here \( X = \text{Previous Week Data}, y = \text{Tomorrow Kw} \).
</p>

<p>
Second, we want the data to be managed in memory in a way that will keep our GPU's at full capacity. We want to avoid data starvation for the GPU.
</p>

<p>
Here we will use a <code>TensorFlow</code> dataset using the <code>tf.keras.preprocessing.time_series_dataset_from_array</code> function. The dataset is a Python generator so we may grab elements using a for loop.
</p>
</div>
</div>
</div>


<div id="outline-container-orgbb6c67b" class="outline-2">
<h2 id="orgbb6c67b"><span class="section-number-2">3.</span> Exploring the Dataset</h2>
</div>


<div id="outline-container-org47f7c53" class="outline-2">
<h2 id="org47f7c53"><span class="section-number-2">4.</span> Baseline Model ARIMA</h2>
</div>



<div id="outline-container-orgf7c06be" class="outline-2">
<h2 id="orgf7c06be"><span class="section-number-2">5.</span> Engineering Features for Machine Learning</h2>
<div class="outline-text-2" id="text-5">
<p>
To start doing machine learning, we must first define the model we want to use, then we engineer features based on what the model will do best with.
</p>
</div>
</div>


<div id="outline-container-orgef29318" class="outline-2">
<h2 id="orgef29318"><span class="section-number-2">6.</span> Representing the Data in TensorFlow</h2>
<div class="outline-text-2" id="text-6">
<p>
Currently our data is in a <code>pandas.DataFrame</code> object. TensorFlow wants the dataset to be in a <code>tf.Tensor</code> format. Timeseries are a common enough format for Keras to have a preprocessing function <code>tf.keras.utils.timeseries_dataset_from_array</code>.
</p>
</div>

<div id="outline-container-org7cab85d" class="outline-3">
<h3 id="org7cab85d"><span class="section-number-3">6.1.</span> Create a</h3>
</div>
</div>


<div id="outline-container-orga648ee8" class="outline-2">
<h2 id="orga648ee8"><span class="section-number-2">7.</span> Predictions</h2>
<div class="outline-text-2" id="text-7">
<p>
The output of a TensorFlow model is, of course, another <code>tf.Tensor</code>. In this model we wish to perform the following steps.
</p>
</div>

<div id="outline-container-org962bd94" class="outline-3">
<h3 id="org962bd94"><span class="section-number-3">7.1.</span> Outputting Predictions</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Given the <code>model</code> of type <code>tf.keras.sequential</code>, we have access to the <code>*.predict</code> method. Recall that we <b>standardized</b> our dataset by subtracting off the mean and dividing by the standard deviation of the training set. This means that the input and output will use standardized features. That is, our model has the following behavior
</p>

<p>
\[ \text{Standardized Inputs} \to \text{Model} \to \text{Standardized Outputs} \]
</p>

<p>
We may write a function which uses this model but has the inputs and outputs be in the original representation.
</p>

<p>
\[ \text{Regular Inputs} \to \left[ \text{Standardized Inputs} \to \text{Model} \to \text{Standardized Outputs} \right] \to \text{Regular Outputs} \]
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #531ab6;">def</span> <span style="color: #721045;">inverse_</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7025726" class="outline-3">
<h3 id="org7025726"><span class="section-number-3">7.2.</span> Matching Date &amp; Time</h3>
</div>
</div>
</div>
</body>
</html>
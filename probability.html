<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-11-03 Thu 16:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Maybe, भि में میں بھی, 明媚.</title>
<meta name="author" content="Zain Jabbar" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<title>明媚, शायद. میں بھی</title><link rel="stylesheet" href="/css/main-dark.css" type="text/css"/>
<header><div class="menu"><ul>
<li><a href="/">/</a></li>
<li><a href="/about">/about</a></li>
</ul></div></header>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Maybe, भि में میں بھی, 明媚.</h1>

<div id="outline-container-org85b17d4" class="outline-2">
<h2 id="org85b17d4"><span class="section-number-2">1.</span> Definitions</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgf3abe51" class="outline-3">
<h3 id="orgf3abe51"><span class="section-number-3">1.1.</span> Probability Space</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Bruh
</p>
</div>
</div>



<div id="outline-container-org5e53efe" class="outline-3">
<h3 id="org5e53efe"><span class="section-number-3">1.2.</span> Pushforward Measure</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Given \[ X \colon \Omega \to \mathbb{R} \] and \[ g \colon \mathbb{R} \to \mathbb{R} \] both measureable, we have that \[ g \circ X \] is also measureable.
</p>

<p>
The pushforward measure is then:
\( \begin{tikzcd}
\Omega & A & \mathbb{R}_{\geq 0} \\
& & \mathbb{R}_{\geq 0}
\arrow["X", from=1-1, to=1-2]
\arrow["g", from=1-2, to=1-3]
\arrow["P", from=1-1, to=2-3]
\arrow["X_*P", from=1-2, to=2-3]
\arrow["(g \circ X)_* P", from=1-3, to=2-3]
\end{tikzcd}\)
</p>
</div>
</div>
</div>


<div id="outline-container-org1a46d7c" class="outline-2">
<h2 id="org1a46d7c"><span class="section-number-2">2.</span> MATH 649K Nasrin</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org00985c0" class="outline-3">
<h3 id="org00985c0"><span class="section-number-3">2.1.</span> Homework 1</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-orgecefbf7" class="outline-4">
<h4 id="orgecefbf7"><span class="section-number-4">2.1.1.</span> Problem 1</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
\(\lambda\)
</p>
<ul class="org-ul">
<li>\((\Omega, \mathcal{F}, P)\) be a probability space</li>
<li>\(|A| \leq \mathbb{N}\)</li>
<li>\(X \colon \Omega \to A\) be a random variable</li>
<li>\(g \colon A \to [0, \infty]\)</li>
</ul>



<p>
\(\therefore\)
</p>

<p>
Let \(Y=g(X)\), then,
\[\begin{align*}
\mathbb{E}[Y]
&= \sum_{y \in Y} y P(Y = y) \\
&= \sum_{y \in Y} y \sum_{x \in g^{-1}[y]} P(X = x) \\
&= \sum_{y \in Y} \sum_{x \in g^{-1}[y]} g(x) P(X = x) \\
\end{align*}\]  
Note: \(\{y\}\) is a partition of \(\text{im}(g)\) hence \(g^{-1}(y)\) forms a partition of \(X\).
Hence: \[ \sum_{y \in Y} \sum_{x \in g^{-1}[y]} \simeq \sum_{x \in X} \]
So we have the desired result, \[ \sum_{x \in X} g(x) P(X = x) \] 
</p>
</div>
</div>
<div id="outline-container-org99e6c3f" class="outline-4">
<h4 id="org99e6c3f"><span class="section-number-4">2.1.2.</span> Problem 2</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
\(\lambda\)
</p>
<ul class="org-ul">
<li>\(\{E_n\}_{n=1}^{\infty}\) be a sequence of independent events</li>
</ul>

<p>
Note that \(\left\{\bigcap_{n = 1}^{i} E_n \right\}_{i = 1}^{\infty}\)  is a decreasing sequence of events. 
</p>

<p>
\[ P(\bigcap_{n = 1}^{\infty} E_n)
= P(\lim_{i \to \infty} \bigcap_{n = 1}^{i} E_n) \\
= \lim_{i \to \infty} P( \bigcap_{n = 1}^{i} E_n) \\
= \lim_{i \to \infty} \prod_{n = 1}^{i} E_n = \prod_{n = 1}^{\infty} P(E_n)\] 
</p>
</div>
</div>

<div id="outline-container-org891e688" class="outline-4">
<h4 id="org891e688"><span class="section-number-4">2.1.3.</span> Problem 3</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
\(\lambda\)
</p>
<ul class="org-ul">
<li>\(T\) be the text "A Chronicle of Ancient Sunlight", partition \(\mathbb{N}\) by the residue classes \(\mod \ell (T)\) (the length of \(T\))</li>
<li>\(E_k \in \mathcal{F}\) be the event that $T $begins at position \(k \cdot \ell (T)\)</li>
</ul>

<p>
\[ \forall k \in \mathbb{N} . P(E_k) = \frac{1}{K^{\ell(T)}} > 0 \]
</p>

<p>
Thus, \[ \sum_{k \in \mathbb{N}} P(E_k) = \infty \] and \[ \{E_k\}_{k \in \mathbb{N}} \] are an independent set of events.
</p>

<p>
Hence by Borel-Cantelli we have that \[ P(\{E_k \ \text{i.o.} \}) = 1 \] The chimp will almost surely write the novel.
(Infinitely many times in fact; what a hard worker!)
</p>
</div>
</div>

<div id="outline-container-orgd233176" class="outline-4">
<h4 id="orgd233176"><span class="section-number-4">2.1.4.</span> Problem 4</h4>
<div class="outline-text-4" id="text-2-1-4">
\begin{align*}

p \left(\left|\frac{1}{n} \sum_{m = 1}^{n} (X_m - \mathbb{E}(X_m))\right| \geq \delta \right) \\
&\leq \frac{1}{\delta^2} \mathbb{E}\left[ \left| \frac{1}{n} \sum_{m = 1}^{n} (X_m - \mathbb{E}(X_m)) \right|^2 \right] \\
&\leq \frac{1}{\delta^2 n^2} \mathbb{E}\left[ \left| \sum_{m = 1}^{n} (X_m - \mathbb{E}(X_m)) \right|^2 \right] \\
&\leq \frac{1}{\delta^2 n^2} \mathbb{E}\left[ \sum_{m = 1}^{n} (X_m - \mathbb{E}(X_m))^2 \right] \\
&= \frac{1}{\delta^2 n^2} \sum_{m = 1}^{n} \mathbb{E}\left[  (X_m - \mathbb{E}(X_m))^2 \right] \\
&= \frac{1}{\delta^2 n^2} \sum_{m = 1}^{n} \right( \mathbb{E}\left[  (X_m - \mathbb{E}(X_m))^2 \right] + \mathbb{E}\left[  (X_m - \mathbb{E}(X_m)) \right]^2 \right) \\
&= \frac{1}{\delta^2 n^2} \sum_{m=1}^{n} \text{Var}(X_m)
\end{align*}
</div>
</div>
<div id="outline-container-org0daebbc" class="outline-4">
<h4 id="org0daebbc"><span class="section-number-4">2.1.5.</span> Problem 5</h4>
<div class="outline-text-4" id="text-2-1-5">
<ul class="org-ul">
<li>a</li>
</ul>
<p>
We get that \(Y_n\) is the result of pulling all coins out of the barrel.
This means that \(P(Y_n = j) = 0\) when \(j\) is not the number of silver coins and \(1\) when \(j\) is the number of silver coins.
</p>

<p>
\[ P(Y_n = j) = \sum_{i \in [0 .. n]} P(Y_n = j \vert \ i \text{ Silver Coins}) P(i \text{ Silver Coins}) = \frac{1}{n+1} \] 
</p>

<ul class="org-ul">
<li>b</li>
</ul>
<p>
Let us condition on two properties, \[ Y_n = i \] and that the "Next coin is Silver = S" or "Next coin is Gold = G".
</p>

<p>
\[\begin{align*}
P(Y_{n-1} = j)
&= \sum_{i \in [0 .. n]} P(Y_{n-1} = j \vert S \land \ Y_n = i) P(S \land Y_n = i) \\
&+ P(Y_{n-1} = j \vert G \land \ Y_n = i) P(G \land Y_n = i) \\
&= \sum_{i \in [0 .. n]} P(Y_{n-1} = j \vert S \land \ Y_n = i) P(S \vert Y_n = i) P(Y_n = i) \\
&+ P(Y_{n-1} = j \vert G \land \ Y_n = i) P(G \vert Y_n = i) P(Y_n = i) \\
\end{align*}\]
Now we may evaluate some of the expressions.
\[ P(Y_{n-1} = j \vert S \land \ Y_n = i) = \begin{cases} 1 & j = i-1 \\ 0 & \text{else} \end{cases} \] 
\[ P(Y_{n-1} = j \vert G \land \ Y_n = i) = \begin{cases} 1 & j = i \\ 0 & \text{else} \end{cases} \] 
\[ P(S \vert \ Y_n = i) =  \frac{i}{n} \] 
\[ P(G \vert \ Y_n = i) =  \frac{n - i}{n} \]
\[ P(Y_n = i) = \frac{1}{n+1} \]
</p>

<p>
Due to the first two equations, we get a lot of zero terms. There are only two cases when there are non zero terms. That being when \[ i = j \] and \[ i = j + 1 \] 
So the sum becomes \[ 1 \cdot \frac{j + 1}{n} \cdot \frac{1}{n + 1} + 1 \cdot \frac{n - j}{n} \cdot \frac{1}{n+1} = \frac{1}{n} \]
</p>

<ul class="org-ul">
<li>c</li>
</ul>
<p>
I conjecture:
\[ P(Y_{k} = i) = \frac{1}{k+1} \] 
</p>


<ul class="org-ul">
<li>d</li>
</ul>

<p>
We can calculate this similarly to part (b) (and by similarly, I mean I literally copy pasted the result and did a search and replace)
</p>


<p>
Let us condition ok two properties, \[ Y_k = i \] and that the "Next coin is Silver = S" or "Next coin is Gold = G".
</p>

<p>
\[ \begin{align*}
P(Y_{k-1} = j)
&= \sum_{i \in [0 .. k]} P(Y_{k-1} = j \vert S \land \ Y_k = i) P(S \land Y_k = i)\\ &+ P(Y_{k-1} = j \vert G \land \ Y_k = i) P(G \land Y_k = i) \\
&= \sum_{i \in [0 .. k]} P(Y_{k-1} = j \vert S \land \ Y_k = i) P(S \vert Y_k = i) P(Y_k = i)\\ &+ P(Y_{k-1} = j \vert G \land \ Y_k = i) P(G \vert Y_k = i) P(Y_k = i) \\
\end{align*}\]
Now we may evaluate some of the expressions.
\[ P(Y_{k-1} = j \vert S \land \ Y_k = i) = \begin{cases} 1 & j = i-1 \\ 0 & \text{else} \end{cases} \] 
\[ P(Y_{k-1} = j \vert G \land \ Y_k = i) = \begin{cases} 1 & j = i \\ 0 & \text{else} \end{cases} \] 
\[ P(S \vert \ Y_k = i) =  \frac{i}{k} \] 
\[ P(G \vert \ Y_k = i) =  \frac{k - i}{k} \]
\[ P(Y_k = i) = \frac{1}{k+1} \]
</p>

<p>
Due to the first two equations, we get a lot of zero terms. There are only two cases when there are non zero terms. That being when \[ i = j \] and \[ i = j + 1 \] 
So the sum becomes \[ 1 \cdot \frac{j + 1}{k} \cdot \frac{1}{k + 1} + 1 \cdot \frac{k - j}{k} \cdot \frac{1}{k+1} = \frac{1}{k} \]
</p>
</div>
</div>

<div id="outline-container-org15be675" class="outline-4">
<h4 id="org15be675"><span class="section-number-4">2.1.6.</span> Problem 6</h4>
<div class="outline-text-4" id="text-2-1-6">
<ul class="org-ul">
<li>a</li>
</ul>
<p>
Let \(P_{n,m} := P(A \text{ is always ahead} \vert \ [A \text{ has } n \text{ votes}] \land [B \text{ has } m \text{ votes}])\)
</p>

<p>
Then \(1 - P_{m,n}\) is the probability of the negation; thus \(1 - P_{m,n} = P(A \text{ is not always ahead} \vert \ [A \text{ has } n \text{ votes}] \land [B \text{ has } m \text{ votes}])\)
If there is a point where \(A\) is not always ahead, then there exists a time where \(A\) is tied with \(B\). Hence, \(1 - P_{m,n} = P(A \text{ is at some point tied with } B \vert \ [A \text{ has } n \text{ votes}] \land [B \text{ has } m \text{ votes}])\)
</p>


<ul class="org-ul">
<li>b</li>
</ul>
<p>
We know that \(A\) eventually wins due to \(n > m\). Hence any sequence that begins with \(B\) will eventually tie. Also any sequence that begins with \(A\) can be put in put in bijection with a sequence starting with \(B\). This is because any sequence that ties with \(A\) starting can be flipped (A to B and B to A) into a sequence beginning with \(B\) and eventually tying. This is has an inverse, hence bijective.
</p>

<p>
Note: \(A\) and \(B\) cannot tie in the first vote because either \(A\) or \(B\) gets one vote and the other has zero. So someone is ahead on the first vote.
If \(A\) and \(B\) eventually tie, then there is one person who was ahead of the other, then there was one vote that tied them. Call the first such case the \(n\) th vote. Both are tied on the \(n\) th vote.
If one person was ahead of another, and they tie, that means the person that was behind was the one that got the \(n\) th vote.
</p>

<p>
Hence, the one who was ahead gets the first vote and the person who was behind gets the \(n\) th vote.
</p>

<p>
By reversing the order of the votes, we get a dual case where the person who was ahead in the original case is now the person who was behind in the dual case. This is a bijection of cases hence it does not matter who gets the first vote.
</p>

<ul class="org-ul">
<li>c</li>
</ul>
<p>
We prove this by counting.
</p>

<p>
\[ P(T) = \frac{\text{No. of Sequences with Ties}}{\text{No. of Sequences}} \] 
</p>

<p>
There are \[  \] 
</p>

<p>
Let \(t\) be the number of sequences that end have ties. Each sequence is determined by the places where \(n\) votes for \(A\) are given.  
</p>

<p>
The probability of tying is \[ P(T) = P(T \land A) + P(T \land B) = 2 \cdot P(T \land B) \]
</p>

<p>
\[ P(T) = 2 \cdot P(T | B) P(B) \] because there is a bijection between tying sequences beginning with \(A\) or \(B\). Because \(A\) always wins we know \(P(T | B) = 1\) hence \(P(T) = 2 \cdot \frac{m}{m + n}\).
</p>

<p>
Thus
\[ \begin{align*}
P_{n,m}
&= 1 - P(\text{Sequence eventually ties}) \\
&= 1 - 2 \cdot P(\text{Sequence begins with }B) \\
&= 1 - 2 \frac{m}{m+n} \\
&= \frac{n - m}{m+n} \\
\end{align*}\] 
</p>
</div>
</div>
</div>


<div id="outline-container-org9b9875a" class="outline-3">
<h3 id="org9b9875a"><span class="section-number-3">2.2.</span> Homework 2</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org87a9de9" class="outline-4">
<h4 id="org87a9de9"><span class="section-number-4">2.2.1.</span> Problem 1</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
\( \lambda \)
</p>
<ul class="org-ul">
<li>\( \{N(t), t \geq 0 \} \) be a PP with rate \( \lambda > 0 \)</li>
<li>\( G \) be a non-negative random variable with mean \( \mu \) and variance \( \sigma^2 \)</li>
<li>\( G \) be independent of \( N(t) \)</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org7d0be54"></a>A<br />
<div class="outline-text-5" id="text-2-2-1-1">
<p>
\( \Cov(G,N(G)) = \E[G \cdot N(G)] - \E[N(G)] \E[G] \)
</p>

<p>
We shall condition on \( G \).
</p>

<p>
\[ \E[G \cdot N(G)] = \E[\E[G \cdot N(G) \vert G]] = \E[G \cdot \lambda G]\]
\[ \E[N(G)] = \E[\E[ N(G) \vert G]] = \E[\lambda G] \]
Both of these calculations use \( \E[N(t)] = \lambda t \), when given \( G \) we can substitute in \( G \) for t.
Thus,
\( \Cov(G, N(G)) = \lambda (\E[G^2] - \E[G]^2) = \lambda \Var[G] = \lambda \sigma^2 \) 
</p>
</div>
</li>
<li><a id="org1e49c06"></a>B<br />
<div class="outline-text-5" id="text-2-2-1-2">
\begin{align*}
\Var[N(G)] &= \E[\E[N(G)^2 \vert G]] - \E[\E[N(G) \vert G]]^2  \\
&= \E[\lambda^2 G^2 + \lambda G] - \E[\lambda G]^2  \\
&= \E[\lambda^2 G^2] - \E[\lambda G]^2 + \E [\lambda G]   \\
&= \lambda^2 \Var[G] + \lambda \E[G]
\end{align*}
</div>
</li>
</ol>
</div>

<div id="outline-container-orgb5f53a0" class="outline-4">
<h4 id="orgb5f53a0"><span class="section-number-4">2.2.2.</span> Problem 2</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
\( \lambda \)
</p>
<ul class="org-ul">
<li>\( \{N(t), t \geq 0 \} \) be a PP (Using Definition 2.1.2) with rate \( \lambda \)</li>
<li>\( I \) be an interval of length \( t \)</li>
</ul>

<p>
Calculate the Laplace Transform of \( N(t) \)
</p>
\begin{align*}
F(t + h)
&= \E[e^{-s N(t + h)}] \\
&= \E[e^{-s (N(t) + (N(t+h) - N(t)))}] \\
&= \E[e^{-s N(t)} e^{-s (N(t+h) - N(t)}] \\
&= \E[e^{-s N(t)}] \E[e^{-s (N(t+h) - N(t)}] \\
&= F(t) \E[e^{-s (N(h))}] \\
\end{align*}
<p>
First equality is calculating the laplace transform and defining a function \( F \) to be the value of the laplace transform at \( x \).
Second equality is by using the properties of counting process.
Third equality is using properties of exponentials.
Fourth equality is using independence of increments.
Last equality is noticing that we have another term of the laplace transform. This gives us a functional relationship which will be used to actually solve for the values of \( F \).
</p>

<p>
To find the value of \( \E[e^{-s (N(h))}] \) we may condition on the value of \(N(h)\). This formatting looks gross sorry about that :(
</p>

\begin{align*}
\E[e^{-s (N(h))}]
&= \E[\E[e^{-s (N(h))} \vert N(h)]]\\
&= \E[e^{-s (N(h))} \vert N(h) = 0] P(N(h) = 0) + \\
&\E[e^{-s (N(h))} \vert N(h) = 1] P(N(h) = 1) + \\
&\E[e^{-s (N(h))} \vert N(h) \geq 2] P(N(h) \geq 2) \\
&= 1 \cdot (1 - (\lambda h + o(h) + o(h))) + e^{-s} (\lambda h + o(h)) + \sum_{i = 2}^{\infty} e^{-s \cdot i} P(N(h) = i) \\
&= 1 - \lambda h + e^{-s} \lambda h + o(h)
\end{align*}
<p>
We use three cases, \( n=0,1,\geq 2 \). These cases are motivated by the given definition of our process.
We then apply the properties of the process for the case of \( 0 \) and \( 1 \) and use summations for greater than \( 2 \).
Using the properties of the poisson process again and combining like terms we get the last equality.
</p>

<p>
Hence:
</p>

<p>
\(F(t + h) = F(t) (1 - \lambda h + e^{-s} \lambda h + o(h))\)
</p>

<p>
\(\implies\) \(\frac{F(t + h) - F(t)}{h} = F(t)(-\lambda + e^{-s} \lambda) + \frac{o(h)}{h}\)
</p>

<p>
By letting \(h \to 0\) we obtain, \(F'(t) = F(t)(-\lambda + e^{-s} \lambda)\)
</p>

<p>
Rearanging: \(\frac{F'(t)}{F(t)} = \lambda (-1 + e^{-s})\)
</p>

<p>
Integrating by \(t\) yields: \(\log(F(t)) = \lambda t (-1 + e^{-s})\)
</p>

<p>
So: \(F(t) = e^{\lambda t (-1 + e^{-s})}\) which is the Laplace transform of a Poisson random variable.
</p>

<p>
By uniqueness of the Laplace transform we get that \(N(t)\) is a Poisson random variable.
</p>
</div>
</div>
<div id="outline-container-orgd2abc41" class="outline-4">
<h4 id="orgd2abc41"><span class="section-number-4">2.2.3.</span> Problem 3</h4>
<div class="outline-text-4" id="text-2-2-3">
<p>
\( \lambda \)
</p>
<ul class="org-ul">
<li>\( \psi_i(t) \) be the indicator function of bug \( i \) causing an error by \( t \)</li>
</ul>

<p>
First, \( \E[M_2(t)] \), I'll use it in the next proof.
We use a different indicator function, \( I_i^{(2)} \) indicates bug \( i \) causes \( 2 \) errors. This is Poisson Distributed.
</p>

\begin{align*}
\E[M_2(t)]
&= \sum_i \E[I_i^{(2)}(t)] \\
&= \sum_{i} e^{-\lambda_i t} \frac{(\lambda_i t)^2}{2}
\end{align*}

\begin{align*}
\E\left[\left(\Lambda(t) - \frac{M_1(t)}{t}\right)^2\right]
&= \E\left[\left(\Lambda(t) - \frac{M_1(t)}{t}\right)^2\right] + 0 \\
&= \E\left[\left(\Lambda(t) - \frac{M_1(t)}{t}\right)^2\right] + \E\left[\left(\Lambda(t) - \frac{M_1(t)}{t}\right)\right]^2 \\
&= \Var[\Lambda(t) - \frac{M_1(t)}{t}] \\
&= \Var[\Lambda(t)] + \frac{\Var(M_1(t))}{t^2} - \frac{2}{t} \Cov(\Lambda(t), M_1(t)) \\
&= [\sum_i \lambda_i^2 (e^{-\lambda_i t})(1-e^{-\lambda_i t})] + \\
&\frac{[\sum_i (\lambda_i t e^{-\lambda_i t}) (1 - \lambda_i t e^{-\lambda_i t})]}{t^2} - \frac{2}{t} [\sum_i \Cov(\psi_i(t), I_i(t))] \\
&= [\sum_i \lambda_i^2 (e^{-\lambda_i t})(1-e^{-\lambda_i t})] + \\
&\frac{[\sum_i (\lambda_i t e^{-\lambda_i t}) (1 - \lambda_i t e^{-\lambda_i t})]}{t^2} - \frac{2}{t} [\sum_i \lambda_i e^{-\lambda_i t} \lambda_i t e^{-\lambda_i t}] \\
&= \sum_i \lambda_i^2 e^{- \lambda_i t} + \frac{\sum_i \lambda_i e^{-\lambda_i t}}{t} \\
&= \frac{\E[M_1(t) + 2 M_2(t)]}{t^2} \\
\end{align*}

<p>
First equality is by adding 0.
Second equality is by using \( \E[\Lambda(t) - \frac{M_1(t)}{t}] = 0 \) (we proved this in class). Hence \( \E\left[\left(\Lambda(t) - \frac{M_1(t)}{t}\right)\right]^2 = 0 \).
Third equality is from \( \Var(X) = \E[X^2] - \E[X]^2 \).
Fourth equality is by using definition of \( \Var \) for possibly non independent random variables.
Fifth equality is from breaking down \( \Lambda \) and \( M_1 \) into their summation forms and applying the variance to all of the terms.
Sixth equality is calculating the covariance between the summands.
Seventh equality is combining terms with the same index \( i \).
Last equality is to notice the two sums are the definitions of \( M_1 \) and \( 2M_2 \) (Which is only motivated because that was what we wanted to show). 
</p>
</div>
</div>
<div id="outline-container-orgec250d8" class="outline-4">
<h4 id="orgec250d8"><span class="section-number-4">2.2.4.</span> Problem 4</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
\( \lambda \)
</p>
<ul class="org-ul">
<li>\( N(t) \) be a non-homogeneous Poisson Process with rate \( \lambda(t) \)</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org3122065"></a>A<br />
<div class="outline-text-5" id="text-2-2-4-1">
<p>
\( \lambda(t) = \begin{cases} 6 & 0 \leq t < 2 \\ 15 & 2 \leq t < 4 \\ 15 - (\frac{5}{2})(t-4) & 4 \leq t \leq 6 \end{cases} \)
From this we can define \( m(t) \)
</p>

<p>
\( m(t) = \begin{cases} 6t & 0 \leq t < 2 \\ 15(t-2) + 12 & 2 \leq t < 4 \\ 15(t-4) - (\frac{5}{2})(\frac{1}{2}(t-4)^2-4(t-4)) + 42 & 4 \leq t \leq 6 \end{cases} \)
</p>
</div>
</li>

<li><a id="org320fefe"></a>B<br />
<div class="outline-text-5" id="text-2-2-4-2">
<p>
Calculate \( m(5) - m(3) = 62.75 \) 
\( P(N(5) - N(3) = 0) = \exp(-62.75) \frac{62.75^0}{0!} \simeq 5.5978500469\cdot 10^{-28}\) 
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org8bc369e" class="outline-4">
<h4 id="org8bc369e"><span class="section-number-4">2.2.5.</span> Problem 5</h4>
<div class="outline-text-4" id="text-2-2-5">
<p>
\( \lambda \)
</p>
<ul class="org-ul">
<li>\( M(t) \) be the total amount of money paid in \( (0,t] \)</li>
<li>The number of payments follow a Poisson Process with \( \lambda = 5 \)</li>
<li>The Payments are exponentially distributed with expected value \( 20,000 \)</li>
<li>\( \E[M(4)] \)</li>
</ul>

<p>
We have the following relationship between the terms:
</p>

<p>
\[ M(t) = \sum_{i=0}^{N(t)} P_i \]
Using the formula from the random number of random variables we can calculate the expected value.
</p>

<p>
Hence \( \E[M(t)] = \E[N(t)] \E[P_i] \)
</p>

<p>
\( \E[M(4)] = 5 \cdot 4 \cdot 20,000 = 400,000 \) 
</p>
</div>
</div>


<div id="outline-container-orge270498" class="outline-4">
<h4 id="orge270498"><span class="section-number-4">2.2.6.</span> Problem 6</h4>
<div class="outline-text-4" id="text-2-2-6">
<p>
\( \lambda \)
</p>
<ul class="org-ul">
<li>\(N(t)\) be a Poisson Process with rate \(1\)</li>
<li>\(\Lambda\) be a non negative non constant random variable.</li>
<li>\(N_\Lambda(t) := N(\Lambda t)\), \(N_\Lambda\) is then Poisson with rate \(\lambda\) when conditioning on \(\Lambda = \lambda\)</li>
</ul>

<p>
Suppose for sake of contradiction that \(N_\Lambda(t)\) had independent increments,
</p>

\begin{align*}
P(N_\Lambda(1) - N_\Lambda(0) = 0,N_\Lambda(2) - N_\Lambda(1) = 0) 
&= P(N_\Lambda(1) - N_\Lambda(0) = 0) P(N_\Lambda(2) - N_\Lambda(1) = 0) \\
&= P(N_\Lambda(2) = 0)
\end{align*}

<p>
Calculating \(P(N_\Lambda(1) = 0)\) yields:
</p>

<p>
\(P(N_\Lambda(1)) = \E[P(N(\lambda) = 0 \vert \Lambda = \lambda)] = \E[e^{-\Lambda}]\)
</p>

<p>
By stationary increments we also have
</p>

<p>
\(P(N_\Lambda(2) - N_\Lambda(1)) = \E[P(N(2\lambda) - N(\lambda) = 0 \vert \Lambda = \lambda)] = \E[e^{-\Lambda}]\)
</p>

<p>
Calculating \(P(N_\Lambda(2))\) yields:
</p>

<p>
\(P(N_\Lambda(2)) = \E[P(N(2\lambda) = 0 \vert \Lambda = \lambda)] = \E[e^{-2\Lambda}]\)
</p>

<p>
Hence:
</p>

\begin{align*}
P(N_\Lambda(1) - N_\Lambda(0) = 0) P(N_\Lambda(2) - N_\Lambda(1) = 0)
&= \E[e^{-\Lambda}]^2 \\
&< \E[e^{-2\Lambda}] \\
&= P(N_\Lambda(2) = 0)\\
\end{align*}

<p>
The inequality appears using Jensen's inequality where \( x^2 \) is a convex function.
The inequality is strict due to \(\Lambda\) being non constant in the hypothesis.
</p>
</div>
</div>
</div>


<div id="outline-container-org17132f6" class="outline-3">
<h3 id="org17132f6"><span class="section-number-3">2.3.</span> Homework 3</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org17a7be4" class="outline-4">
<h4 id="org17a7be4"><span class="section-number-4">2.3.1.</span> Problem 1</h4>
<div class="outline-text-4" id="text-2-3-1">
</div>
<ol class="org-ol">
<li><a id="orgfb3e5f4"></a>A<br />
<div class="outline-text-5" id="text-2-3-1-1">
<p>
Let \( F_{V}(v) \) denote the CDF of \( V \) at \( v \). Note that \( F_U(u) \) for \( U \) uniform from \( [0,1] \) has the property that \( \forall u \in [0,1] . F_U(u) = u \).
</p>

<p>
First we show that the \( CDF \) of \( X_i \) is the same as the CDF of \( \alpha \) for \( i = 0 \).
</p>
\begin{align*}
P(X_0 \leq j)
&= P(U_0 \leq \sum_{m = 1}^j \alpha_m) \\
&= P(U_0 \leq F_\alpha(j)) \\
&= F_\alpha(j)
\end{align*}

<p>
Next we show that the \( CDF \) of \( X_i \) is the same as the CDF of \( q_{X_{i - 1}} \) for \( i > 0 \).
</p>

\begin{align*}
P(X_n \leq j)
&= P(U_n \leq \sum_{m = 1}^j q_{X_{n-1}, m}) \\
&= P(U_n \leq F_{q_{X_{n-1}}}(j)) \\
&= F_{q_{X_{n-1}}}(j)
\end{align*}

<p>
Hence \( X_i \) has the distribution we want.
</p>

<p>
To show that \( X_i \) is a Markov Chain, we need to show that it has the Markov property.
</p>

<p>
Suppose \( X_n = j_n \) then \( X_{n+1} = \inf_{j_{n+1}} U_{n+1} \leq \sum_{m = 1}^{j_{n+1}} q_{i, m} \). So \( X_{n+1} \) only depends on random variables which are also independent of the past. So the Markov property holds. 
</p>
</div>
</li>

<li><a id="org3695808"></a>B<br />
<div class="outline-text-5" id="text-2-3-1-2">
<div class="org-src-container">
<pre class="src src-python3"><span style="color: #5317ac;">import</span> numpy <span style="color: #5317ac;">as</span> np
<span style="color: #5317ac;">import</span> matplotlib.pyplot <span style="color: #5317ac;">as</span> plt

np.random.seed<span style="color: #000000;">(</span>24599253<span style="color: #000000;">)</span>

<span style="color: #505050;"># </span><span style="color: #505050;">Input: Initial Distribution `alpha` and transition matrix `p`</span>
<span style="color: #00538b;">alpha</span> = np.array<span style="color: #000000;">(</span><span style="color: #a8007f;">[</span>1/6 <span style="color: #5317ac;">for</span> i <span style="color: #5317ac;">in</span> <span style="color: #8f0075;">range</span><span style="color: #005f88;">(</span>6<span style="color: #005f88;">)</span><span style="color: #a8007f;">]</span><span style="color: #000000;">)</span>
<span style="color: #00538b;">p</span> = np.array<span style="color: #000000;">(</span><span style="color: #a8007f;">[</span><span style="color: #005f88;">[</span>0, 1/3, 2/3, 0, 0, 0<span style="color: #005f88;">]</span>,
              <span style="color: #005f88;">[</span>1/2, 1/2, 0, 0, 0, 0<span style="color: #005f88;">]</span>,
              <span style="color: #005f88;">[</span>0, 0, 0, 1/4, 1/2, 1/4<span style="color: #005f88;">]</span>,
              <span style="color: #005f88;">[</span>0, 1/3, 1/6, 1/6, 1/3, 0<span style="color: #005f88;">]</span>,
              <span style="color: #005f88;">[</span>0, 0, 0, 0, 1/2, 1/2<span style="color: #005f88;">]</span>,
              <span style="color: #005f88;">[</span>1/4, 1/2, 1/4, 0, 0, 0<span style="color: #005f88;">]</span><span style="color: #a8007f;">]</span><span style="color: #000000;">)</span>

<span style="color: #505050;"># </span><span style="color: #505050;">Step 1:</span>
<span style="color: #00538b;">u_0</span> = np.random.uniform<span style="color: #000000;">()</span>

<span style="color: #00538b;">i</span> = 0
<span style="color: #5317ac;">while</span><span style="color: #000000;">(</span><span style="color: #8f0075;">sum</span><span style="color: #a8007f;">(</span>alpha<span style="color: #005f88;">[</span>:i<span style="color: #005f88;">]</span><span style="color: #a8007f;">)</span> &lt; u_0<span style="color: #000000;">)</span>:
    <span style="color: #00538b;">i</span> += 1
<span style="color: #00538b;">x_0</span> = i - 1

<span style="color: #00538b;">x_n</span> = <span style="color: #000000;">[</span>x_0<span style="color: #000000;">]</span>
<span style="color: #5317ac;">for</span> k <span style="color: #5317ac;">in</span> <span style="color: #8f0075;">range</span><span style="color: #000000;">(</span>10<span style="color: #000000;">)</span>:
    <span style="color: #505050;"># </span><span style="color: #505050;">Step 2:</span>
    <span style="color: #00538b;">u_n</span> = np.random.uniform<span style="color: #000000;">()</span>

    <span style="color: #505050;"># </span><span style="color: #505050;">Step 3:</span>
    <span style="color: #00538b;">i</span> = 0
    <span style="color: #5317ac;">while</span><span style="color: #000000;">(</span><span style="color: #8f0075;">sum</span><span style="color: #a8007f;">(</span>p<span style="color: #005f88;">[</span>x_n<span style="color: #904200;">[</span>-1<span style="color: #904200;">]</span>, :i<span style="color: #005f88;">]</span><span style="color: #a8007f;">)</span> &lt; u_n<span style="color: #000000;">)</span>:
        <span style="color: #00538b;">i</span> += 1
    x_n.append<span style="color: #000000;">(</span>i-1<span style="color: #000000;">)</span>

<span style="color: #00538b;">_</span> = plt.hist<span style="color: #000000;">(</span>x_n, bins = <span style="color: #a8007f;">[</span>0,1,2,3,4,5,6<span style="color: #a8007f;">]</span><span style="color: #000000;">)</span>
</pre>
</div>


<div id="org8f14b4d" class="figure">
<p><img src="./.ob-jupyter/05c37534cda2384b5d305f194bd834cf44bb7ca7.png" alt="05c37534cda2384b5d305f194bd834cf44bb7ca7.png" />
</p>
</div>
</div>
</li>
</ol>
</div>



<div id="outline-container-org978b29f" class="outline-4">
<h4 id="org978b29f"><span class="section-number-4">2.3.2.</span> Problem 2</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Consider a two-state Markov Chain with state space \( S = \{1,2\} \) and transition matrix \( P = \begin{pmatrix} 1 - p & p \\ q & 1-q \end{pmatrix} \).
</p>

<p>
Denote \( X = \begin{pmatrix} q & p \\ q & p \end{pmatrix} \) which has adjugate matrix \( \adj(X) = \begin{pmatrix} p & -p \\ -q & q \end{pmatrix} \) and determinant \( \det(X) = 0  \).
</p>

<p>
These \( X \) are very well behaved. We may prove some properties about them.
</p>

<p>
First, the definition of \( X \) is motivated by the problem statement.
</p>

\begin{align}
P^{(n)}
&=
\begin{pmatrix}
\frac{q}{p + q} + \frac{p}{p + q}(1 - p - q)^n & \frac{p}{p + q} - \frac{p}{p + q}(1 - p - q)^n \\
\frac{q}{p + q} - \frac{q}{p + q}(1 - p - q)^n & \frac{p}{p + q} + \frac{q}{p + q}(1 - p - q)^n \\
\end{pmatrix} \\
&=
\frac{1}{p + q}
\begin{pmatrix}
q + p(1 - p - q)^n & p - p(1 - p - q)^n \\
q - q(1 - p - q)^n & p + q(1 - p - q)^n \\
\end{pmatrix} \\
&=
\frac{1}{p + q}
\left( X +
\begin{pmatrix}
 p(1 - p - q)^n & - p(1 - p - q)^n \\
- q(1 - p - q)^n & q(1 - p - q)^n \\
\end{pmatrix}
 \right) \\
&=
\frac{1}{p + q}
\left( X + (1 - p - q)^n
\begin{pmatrix}
 p & - p \\
- q & q \\
\end{pmatrix}
 \right) \\
&=
\frac{1}{p + q}
\left( X + (1 - p - q)^n \adj(X)
 \right)
\end{align}

<p>
Second, \( X + \adj(X) = \begin{pmatrix} q + p & 0 \\ 0 & p + q \end{pmatrix} = (p+q) I_2 \)
</p>

<p>
Third, it's helpful to use \( \adj(X) \) because it tells these three facts
</p>
<ul class="org-ul">
<li>\( \adj(X)^2 = \adj(X^2) \)</li>
<li>\( X \adj(X) = \det(X) I = 0 \)</li>
<li>\( \adj(cX) = c \adj(X) \)</li>
</ul>


<p>
We will prove this problem using Induction and all of this preliminary work
</p>

<p>
Formally, we will show:
</p>

<p>
\[ P^{(n)} = \frac{1}{p+q} \left( X + (1 - p - q)^n \adj(X) \right) \]
</p>

<p>
Base Case: \( n = 0 \)
</p>

\begin{align}
P^{(0)}
&= \frac{1}{p + q}(X + (1 - p - q)^0 \adj(X)) \\
&= \frac{1}{p + q}(X + \adj(X)) \\
&= \frac{1}{p + q}((p + q) I_2) \\
&=  I_2 \\
\end{align}

<p>
Inductive Hypothesis: Suppose
</p>

<p>
\[ P^{(n)} = \frac{1}{p+q} \left( X + (1 - p - q)^n \adj(X) \right) \]
</p>

\begin{align*}
P^{(n)}P
&= \frac{1}{p+q} \left( X + (1 - p - q)^n \adj(X) \right) \cdot \frac{1}{p+q} \left( X + (1 - p - q)^1 \adj(X) \right) \\
&= \frac{1}{(p+q)^2} \left( X^2 + (1 - p - q) X \cdot \adj(X) + (1 - p - q)^n \adj(X) X + (1 - p - q)^{n + 1} \adj(X) \adj(X) \right) \\
&= \frac{1}{(p+q)^2} \left( X^2 + (1 - p - q)^{n + 1} \adj(X)^2 \right) \\
&= \frac{1}{(p+q)^2} \left( (p + q)X + (1 - p - q)^{n + 1} \adj(X^2) \right) \\
&= \frac{1}{(p+q)^2} \left( (p + q)X + (1 - p - q)^{n + 1} \adj((p + q)X) \right) \\
&= \frac{1}{(p+q)^2} \left( (p + q)X + (p + q)(1 - p - q)^{n + 1} \adj(X) \right) \\
&= \frac{1}{(p+q)} \left( X + (1 - p - q)^{n + 1} \adj(X) \right) \\
&= P^{(n + 1)}
\end{align*}

<p>
We have that going from one step to the next is just multiplying the transition matrix. First we multiply the two summation forms of \( P \) and distribute. We know that a matrix times its adjugate is the determinant times the identity, in this case it is \( 0 \). We then have nice forms for the squares of \( X \) and \( \adj(X) \) respectively. Performing matrix multiplication verifies that \( X^2 = (p+q) X \). We then use some rules of \( \adj \) from the third note above. Factoring yields the definition of \( P^{(n+1)} \) we wanted proving the induction.
</p>
</div>
</div>


<div id="outline-container-orga26d17c" class="outline-4">
<h4 id="orga26d17c"><span class="section-number-4">2.3.3.</span> Problem 3</h4>
<div class="outline-text-4" id="text-2-3-3">
<p>
Consider a discrete time Markov chain with transition matrix \( P = \begin{pmatrix} 1/2 & 1/3 & 1/6 \\ 3/4 & 0 & 1/4 \\ 0 & 1 & 0 \end{pmatrix} \) 
</p>
</div>
<ol class="org-ol">
<li><a id="orgacc17a9"></a>A<br />
<div class="outline-text-5" id="text-2-3-3-1">
<p>
\( P^{3} = \begin{pmatrix} 1/2 & 1/3 & 1/6 \\ 9/16 & 1/4 & 3/16 \\ 3/8 & 1/2 & 1/8 \end{pmatrix} \) hence irreducible.
\( P_{11} = 1/2 \) implies state \( 1 \) is aperiodic and the chain is irreducible meaning all states are aperiodic.
</p>
</div>
</li>


<li><a id="org63fd98f"></a>B<br />
<div class="outline-text-5" id="text-2-3-3-2">
<p>
\( P^2 \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} = \begin{bmatrix} 1/2 \\ 1/3 \\ 1/6 \end{bmatrix} \) Hence \( P_{13}^{2} = 1/6 \) 
</p>
</div>
</li>
<li><a id="orgbff80fa"></a>C<br />
<div class="outline-text-5" id="text-2-3-3-3">
<p>
We may diagonalize \( P \) as \( S J S^{-1} \) where
</p>

<p>
\( S =
\begin{pmatrix}
0 & \frac{-1}{3} & 1 \\
\frac{-1}{2} & 0 & 1 \\
1 & 1 & 1
\end{pmatrix} \) 
\( J =
\begin{pmatrix}
\frac{-1}{2} & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 1
\end{pmatrix} \) 
\( S^{-1} =
\begin{pmatrix}
1 & \frac{-4}{3} & \frac{1}{3} \\
\frac{-3}{2} & 1 & \frac{1}{2} \\
\frac{1}{2} & \frac{1}{3} & \frac{1}{6}
\end{pmatrix} \)
</p>

<p>
This is useful as \( P^n = SJ^n S^{-1} \)
</p>

<p>
Taking the limit as \( n \to \infty \) shows \( \pi = S E_{3,3} S^{-1} \)  where \( E \) is the unit matrix with one in row \( 3 \) column \( 3 \), that is \( E = \begin{pmatrix} 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 1 \end{pmatrix} \). It's worth naming \( E \) this way because it has nice multiplication properties, making it quick to work with. Similarly note the column of \( 1 \)'s in \( S \), that will pick out the bottom row in \( S^{-1} \).
</p>


\begin{align}
S E_{3,3} S^{-1}
&= (S E_{3,3}) S^{-1} \\
&= \begin{pmatrix} 0 & 0 & 1 \\ 0 & 0 & 1 \\ 0 & 0 & 1 \end{pmatrix} S^{-1} \\
&= \begin{pmatrix} \frac{1}{2} & \frac{1}{3} & \frac{1}{6} \\
\frac{1}{2} & \frac{1}{3} & \frac{1}{6} \\
\frac{1}{2} & \frac{1}{3} & \frac{1}{6} \end{pmatrix} \\
\end{align}
</div>
</li>
</ol>
</div>


<div id="outline-container-org7106fa3" class="outline-4">
<h4 id="org7106fa3"><span class="section-number-4">2.3.4.</span> Problem 4</h4>
<div class="outline-text-4" id="text-2-3-4">
<p>
Consider the Rainbow Warriors Baseball team. They either win or lose a season. There are four possible combinations of their performance during this year and the last. Denote their performance by a two character string, where the first character is the performance last year and the second character is how they performed this year. That is,
</p>

<ul class="org-ul">
<li>\( WW \) if they won the last year and this year</li>
<li>\( WL \) if they won the last year but lost this year</li>
<li>\( LW \) if they lost last year but one this year</li>
<li>\( LL \) if they lost last year and this year</li>
</ul>

<p>
Because the team can either win or lose, we can transition from one state to the next by their performance. Giving us the diagram:
</p>

\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2.8cm, thin, bend angle = 20] \tikzstyle{every state}=[fill=white,draw=black,thick,text=black,scale=1]
\node[state] (A) {$WW$}; 
\node[state] (B) [right of=A] {$WL$};
\node[state] (C) [below of=A] {$LW$};
\node[state] (D) [below of=B] {$LL$};
\path (A) edge [loop above] node[above] {$W$} (A);
\path (A) edge node[above] {$L$} (B);
\path (B) edge [bend right] node[sloped,above] {$W$} (C);
\path (B) edge node[right] {$L$} (D);
\path (C) edge node[left] {$W$} (A);
\path (C) edge [bend right] node[sloped,below] {$L$} (B);
\path (D) edge node[below] {$W$} (C);
\path (D) edge [loop below] node[below] {$L$} (D);
\end{tikzpicture}

<p>
Using the information from the problem statement we can fill in \( W \) and \( L \) on the arrows with the given probabilities. Note that we are given the probabilities in each state for \( W \) but the total probability leaving the state must be \( 1 \) hence we can infer \( L = 1 - W \).
</p>


\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2.8cm, thin, bend angle = 20] \tikzstyle{every state}=[fill=white,draw=black,thick,text=black,scale=1]
\node[state] (A) {$WW$}; 
\node[state] (B) [right of=A] {$WL$};
\node[state] (C) [below of=A] {$LW$};
\node[state] (D) [below of=B] {$LL$};
\path (A) edge [loop above] node[above] {$0.7$} (A);
\path (A) edge node[above] {$0.3$} (B);
\path (B) edge [bend right] node[sloped,above] {$0.4$} (C);
\path (B) edge node[right] {$0.6$} (D);
\path (C) edge node[left] {$0.5$} (A);
\path (C) edge [bend right] node[sloped,below] {$0.5$} (B);
\path (D) edge node[below] {$0.2$} (C);
\path (D) edge [loop below] node[below] {$0.8$} (D);
\end{tikzpicture}

<p>
We were also given standard names for each of the states in the problem.
</p>


\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=2.8cm, thin, bend angle = 20] \tikzstyle{every state}=[fill=white,draw=black,thick,text=black,scale=1]
\node[state] (A) {$0$}; 
\node[state] (B) [right of=A] {$2$};
\node[state] (C) [below of=A] {$1$};
\node[state] (D) [below of=B] {$3$};
\path (A) edge [loop above] node[above] {$0.7$} (A);
\path (A) edge node[above] {$0.3$} (B);
\path (B) edge [bend right] node[sloped,above] {$0.4$} (C);
\path (B) edge node[right] {$0.6$} (D);
\path (C) edge node[left] {$0.5$} (A);
\path (C) edge [bend right] node[sloped,below] {$0.5$} (B);
\path (D) edge node[below] {$0.2$} (C);
\path (D) edge [loop below] node[below] {$0.8$} (D);
\end{tikzpicture}
</div>

<ol class="org-ol">
<li><a id="orgc6be7b8"></a>A<br />
<div class="outline-text-5" id="text-2-3-4-1">
<p>
The transition probability matrix is read from the above diagram.
</p>

<p>
\( P = \begin{pmatrix}
0.7 & 0 & 0.3 & 0 \\
0.5 & 0 & 0.5 & 0 \\
0 & 0.4 & 0 & 0.6 \\
0 & 0.2 & 0 & 0.8 \\
\end{pmatrix} \) 
</p>
</div>
</li>

<li><a id="org405432a"></a>B<br />
<div class="outline-text-5" id="text-2-3-4-2">
<p>
The long run proportion \( \pi \) is a row vector satisfying:
\( \pi P = \pi \) this implies \( \pi (P - I) \) so \( \pi \) is an element of the null space of \( (P-I)^T \).
</p>

<p>
This is a standard linear algebra exercise.
The null space has dimension one and is spanned by the vector \( \begin{pmatrix} \frac{5}{9} & \frac{1}{3} & \frac{1}{3} & 1 \end{pmatrix} \). We have an additional constraint that the sum of the elements must add to one (meaning \( \frac{5}{9}c + \frac{1}{3}c + \frac{1}{3}c + 1c = 1 \implies c = \frac{9}{20} \implies \pi = \begin{pmatrix} \frac{1}{4} & \frac{3}{20} & \frac{3}{20} & \frac{9}{20} \end{pmatrix} \))
</p>
</div>
</li>
</ol>
</div>


<div id="outline-container-orge0fb4be" class="outline-4">
<h4 id="orge0fb4be"><span class="section-number-4">2.3.5.</span> Problem 5</h4>
<div class="outline-text-4" id="text-2-3-5">
<p>
The transition matrix is \( P = \begin{pmatrix}
0 & 1/2 & 1/2 \\
1/2 & 0 & 1/2 \\
1/2 & 1/2 & 0  \end{pmatrix} = \frac{1}{2} (J - I) \) where \( J = \begin{pmatrix} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1  \end{pmatrix} \)  is the matrix of ones and \( I \) is the identity matrix.
</p>

<p>
To find the probability that a state returns to itself, we need to find out the element of the diagonal of \( P^{(n)} \).
</p>

<p>
We may leverage symmetry in the problem to reduce computation.
</p>

<p>
Note, the matrix \( P \) is symmetric, hence \( P^n \) is also symmetric. Thus the elements on the diagonal are the same. We may then compute a diagonal element by using \( \tr(P^{n}) / 3 \).
</p>

<p>
Furthermore, the trace can also be computed in two ways. The trace is both the sum of the diagonal elements and the sum of the eigenvalues. In this problem calculating the sum of the eigenvalues is easier.
</p>

<p>
The matrix \( J \) has well known eigenvalues.
\( J \) has eigenvalues \( 2 \) with multiplicity \( 1 \) and \( 0 \) with multiplicity \( 2 \).
</p>

<p>
\( J - I \) then has eigenvalues \( 1 \) with multiplicity \( 1 \) and \( -1 \) with multiplicity \( 2 \).
</p>

<p>
\( P =  \frac{1}{2} (J - I) \) has eigenvalues \( 1 \) with multiplicity \( 1 \) and \( \frac{-1}{2} \) with multiplicity \( 2 \).
</p>

<p>
Hence, the eigenvalues of \( P^n \) is then \( 1 \) with multiplicity \( 1 \) and \( \left( \frac{-1}{2} \right)^n \) with multiplicity \( 2 \). 
</p>

<p>
Thus, \( \tr(P^n) = 1 + 2(\frac{-1}{2})^n \)
</p>

<p>
Hence the probability that the element returns to itself is \( \frac{1 + 2(\frac{-1}{2})^n}{3} \) 
</p>
</div>
</div>
</div>
</div>



<div id="outline-container-orge0927eb" class="outline-2">
<h2 id="orge0927eb"><span class="section-number-2">3.</span> MATH 649D Younsi</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org6f02d19" class="outline-3">
<h3 id="org6f02d19"><span class="section-number-3">3.1.</span> Homework 1</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org7f3b78f" class="outline-4">
<h4 id="org7f3b78f"><span class="section-number-4">3.1.1.</span> Problem 1</h4>
<div class="outline-text-4" id="text-3-1-1">
</div>
<ol class="org-ol">
<li><a id="org51b54e8"></a>A<br />
<div class="outline-text-5" id="text-3-1-1-1">
<p>
Denote \( E_i \) be the event where \( HTTHTH \) happens on the \( i \)-th toss. 
Note: \( \forall i \mathbb{P}(E_i) = \mathbb{P}(HTTHTH) = \frac{1}{2^6} \) because the tosses are independent.
\( \sum_i P(E_i) = \infty \) hence by Borel Cantelli \( \mathbb{P}(HTTHTH \text{ i.o}) = 1  \)  
</p>
</div>
</li>
<li><a id="org288cb98"></a>B<br />
<div class="outline-text-5" id="text-3-1-1-2">
<p>
Denote \( E_i \) be the event where \( H\ldots H \) \( i \)-times for tosses \( i \) to \( 2i \). 
Note: \( \forall i \mathbb{P}(E_i) = \frac{1}{2^i} \).
\( \sum_i P(E_i) = 1 \) hence by Borel Cantelli \( \mathbb{P}(HTTHTH \text{ i.o}) = 0  \)  
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgaec795f" class="outline-4">
<h4 id="orgaec795f"><span class="section-number-4">3.1.2.</span> Problem 2</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
First we do some preliminary simplification, then I will do the proof.
</p>

<p>
Let \( A \) be an arbitrary set and \( \mathbbm{1}_A \) be it's indicator function.
\( \mathcal{F}(\mathbbm{1}_A) = \{\mathbbm{1}_A^{-1}(B) \vert B \text{ Borel} \}\) The characteristic function is only \( 0 \) or \( 1 \) hence we have the cases for \( B \).
</p>

<ol class="org-ol">
<li>\( 0,1 \not \in B \) \( \implies \mathbbm{1}_A^{-1}(B) = \emptyset \)</li>
<li>\( 1 \in B \) and \( 0 \not \in B \) \( \implies \mathbbm{1}_A^{-1}(B) = A \)</li>
<li>\( 0 \in B \) and \( 1 \not \in B \) \( \implies \mathbbm{1}_A^{-1}(B) = A^c \)</li>
<li>\( 0,1 \in B \) \( \implies \mathbbm{1}_A^{-1}(B) = \Omega \)</li>
</ol>

<p>
\( \mathcal{F}(\mathbbm{1}_A) = \{ \emptyset, A, A^c, \Omega \}\)
</p>

<p>
Having proved this for a general indicator function this will be true for given \( A \) and \( B \).
</p>

<p>
Thus the probabilities we need to calculate can be organized into a table.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">\( \emptyset \)</th>
<th scope="col" class="org-left">\( A \)</th>
<th scope="col" class="org-left">\( A^c \)</th>
<th scope="col" class="org-left">\( \Omega \)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\( \emptyset \)</td>
<td class="org-right">0</td>
<td class="org-left">0</td>
<td class="org-left">0</td>
<td class="org-left">0</td>
</tr>

<tr>
<td class="org-left">\( B \)</td>
<td class="org-right">0</td>
<td class="org-left">\( P(A \cap B) \)</td>
<td class="org-left">\( P(A^c \cap B) \)</td>
<td class="org-left">\( P(B) \)</td>
</tr>

<tr>
<td class="org-left">\( B^c \)</td>
<td class="org-right">0</td>
<td class="org-left">\( P(A \cap B^c) \)</td>
<td class="org-left">\( P(A^c \cap B^c) \)</td>
<td class="org-left">\( P(B^c) \)</td>
</tr>

<tr>
<td class="org-left">\( \Omega \)</td>
<td class="org-right">0</td>
<td class="org-left">\( P(A) \)</td>
<td class="org-left">\( P(A^c) \)</td>
<td class="org-left">\( 1\)</td>
</tr>
</tbody>
</table>

<p>
To verify independence in our proof, we only need to see that \( P(A \cap B) = P(A)P(B) \). The rows containing \( \emptyset \) and \( \Omega \) have nothing to verify.
Also short lemma if \( A \) and \( B \) are independent then \( A \), \( A^c \), \( B \), and \( B^c \) are all independent.
</p>

\begin{align*}
P(A^c \cap B^c)
&= P((A \cup B)^c) \\
&= 1 - P(A \cup B) \\
&= 1 - [P(A) + P(B) - P(A \cap B)] \\
&= 1 - P(A) - P(B) + P(A)P(B) \\
&= (1 - P(A))(1 - P(B)) 
\end{align*}

\begin{align*}
P(A \cap B^c)
&= P(A) - P(A \cap B) \\
&= P(A) - P(A)P(B) \\
&= P(A)(1 - P(B))
\end{align*}

\begin{align*}
P(A^c \cap B)
&= P(B) - P(A \cap B) \\
&= P(B) - P(A)P(B) \\
&= P(B)(1 - P(A))
\end{align*}

<p>
Now, for the actual proof.
</p>

<p>
Suppose \( A  \) and \( B \) are independent.
</p>

<p>
Then the correspondent \( \sigma \)-algebras are independent using the lemma.
</p>

<p>
Suppose the \( \sigma \)-algebras are independent. Then all the sets are independent, namely \( A \) and \( B \) are independent.
</p>
</div>
</div>

<div id="outline-container-org6771a9f" class="outline-4">
<h4 id="org6771a9f"><span class="section-number-4">3.1.3.</span> Problem 3</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
Let \( X \sim U[-1,1] \) having density \( f(x) = \frac{1}{2} \) 
</p>

<p>
Then \( X \) and \( X^2 \) are not independent. However their expectations are multiplicative.
We will not need to compute \( \E[X^2] \) interestingly enough.
</p>

<p>
Because \( X \) and \( X^3 \) are odd functions on a symmetric interval their expectations are \( 0 \).
</p>

<p>
Hence \( \E[X^3] = 0 = \E[X^2] \E[X] = \E[X^2] \cdot 0 \) 
</p>
</div>
</div>

<div id="outline-container-orgb7e6d19" class="outline-4">
<h4 id="orgb7e6d19"><span class="section-number-4">3.1.4.</span> Problem 4</h4>
<div class="outline-text-4" id="text-3-1-4">
<p>
We have stated in class that a distribution determines a random variable.
</p>

<p>
Let \( F(x) = \begin{cases} 0 & x < 0 \\ c(x) & 0 \leq x \leq 1 \\ 1 & 1 < x\end{cases} \) 
</p>

<p>
Where \( c(x) \) is the Cantor Function (the famous counter example that goes from \( 0 \) to \( 1 \))
</p>

<p>
\( F(x) \) is \( 0 \) as \( x \to - \infty \)
\( F(x) \) is \( 1 \) as \( x \to \infty \)
\( F(x) \) is right continuous
\( F(x) \) is increasing
\( \forall x . 0 \leq F(x) \leq 1 \) 
</p>

<p>
Hence \( F \) is a distribution for a random variable \( X \).
</p>

<p>
But \( X \) has no density function.
</p>

<p>
If it did, then firstly, \( f = 0 \) on \( \mathbb{R} - [0,1] \).
</p>

<p>
Then suppose \( f \neq 0 \) on some interval \( J \subseteq [0,1] \) then \( \int_J f d \mu \neq 0 \). But every interval contains a constant part of the cantor function meaning the function should have been \( 0 \) on that constant portion. Hence a contradiction.
</p>
</div>
</div>

<div id="outline-container-org01c5b7e" class="outline-4">
<h4 id="org01c5b7e"><span class="section-number-4">3.1.5.</span> Problem 5</h4>
<div class="outline-text-4" id="text-3-1-5">
<p>
I remember talking about this problem!
Consider the experiment of two tosses of a coin.
The columns are the first coin, the rows are the second coin.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">H</td>
<td class="org-left">T</td>
</tr>

<tr>
<td class="org-left">H</td>
<td class="org-left">HH</td>
<td class="org-left">TH</td>
</tr>

<tr>
<td class="org-left">T</td>
<td class="org-left">HT</td>
<td class="org-left">TT</td>
</tr>
</tbody>
</table>

<p>
Let \( A_1 \) be the event where the first toss is heads.
Let \( A_2 \) be the event where the second toss is heads.
Let \( A_3 \) be the event where only one toss is heads.
</p>

<p>
Then,
</p>

<p>
\( P(A_1 \cap A_2)  = \frac{1}{4} = P(A_1) P(A_2) \) (This is the top left element of the table)
\( P(A_1 \cap A_3)  = \frac{1}{4} = P(A_1) P(A_3) \) (This is the bottom left element of the table)
\( P(A_2 \cap A_3)  = \frac{1}{4} = P(A_2) P(A_3) \) (This it the top right element of the table)
</p>

<p>
However,
</p>

<p>
\( P(A_1 \cap A_2 \cap A_3) = 0 \neq \frac{1}{8} \) We cannot have both coins be heads and only one coin be heads.
</p>
</div>
</div>

<div id="outline-container-org790a5ba" class="outline-4">
<h4 id="org790a5ba"><span class="section-number-4">3.1.6.</span> Problem 6</h4>
<div class="outline-text-4" id="text-3-1-6">
</div>
<ol class="org-ol">
<li><a id="orgafb4d2a"></a>A<br />
<div class="outline-text-5" id="text-3-1-6-1">
<p>
Let \( U \colon [0,1] \to \mathbb{R} \) via \( U(\omega) = \omega \).
</p>

<p>
The distribution of \( U \) is \( F_U(x) = \mathbb{P}(U^{-1}([-\infty,x])) = \mathbb{P}(U^{-1}([0,x])) = \mathbb{P}([0,x]) = x\).
The pushforward measure is the same as the original measure hence absolutely continuous and has density \( f \) given by the Radon-Nikodym theorem.
</p>

<p>
Hence \( \int_0^x f(x) dx = x \implies f(x) = 1 \).
</p>
</div>
</li>

<li><a id="orgb94599a"></a>B<br />
<div class="outline-text-5" id="text-3-1-6-2">
<p>
Let \( U(\omega) = \sum_{j = 1}^{\infty} \frac{B_j(\omega)}{2^j} \)
</p>

<p>
Note that \( B_j(\omega) \) is a Bernoulli random variable.
</p>

<p>
Let \( \{I_n\}_{n \in \mathbb{N}} \) be an infinite collection of infinite disjoint subsets of \( \mathbb{N} \). The following \( I \)'s work: \( I_n = \{p_n^k \vert k \in \mathbb{Z}_{>0}\} \), but the structure is both not given and irrelevant.
</p>

<p>
\( U_n = \sum_{j=1}^{\infty} \frac{B_{f_n(j)(\omega)}}{2^j} \), the generating function of each term is
</p>

<p>
\( M_{\frac{B_{f_n(j)}}{2^j}}(t) = \E[e^{t \frac{B_{f_n(j)}}{2^j}}] = e^0 P(\frac{B_{f_n(j)}}{2^j}} = 0) + e^{\frac{t}{2^j}}P(\frac{B_{f_n(j)}}{2^j}} = 2^{-j}) = \frac{e^{\frac{t}{2^k}} + 1}{2} \)
</p>

<p>
The MGF for \( U_n \) is
</p>
\begin{align}
M_{U_n}
&= \lim_{k \to \infty} \prod_{j=1}^{k} \frac{e^{\frac{t}{2^k}} + 1}{2} \\
&= \lim_{k \to \infty} \frac{1}{2^k} \prod_{j=1}^{k} e^{\frac{t}{2^k}} + 1 \\
&= \lim_{k \to \infty} \frac{1}{2^k} (\frac{e^{\frac{t}{2^k}} - 1}{e^{\frac{t}{2^k}} - 1}) \prod_{j=1}^{k} e^{\frac{t}{2^k}} + 1 \\
&= \lim_{k \to \infty} \frac{1}{2^k} (\frac{e^{\frac{t}{2^k}} - 1}{e^{\frac{t}{2^k}} - 1}) (e^{\frac{t}{2^k}} + 1) \prod_{j=1}^{k - 1} e^{\frac{t}{2^k}} + 1 \\
&= \lim_{k \to \infty} \frac{1}{2^k} (\frac{e^{\frac{t}{2^{k-1}}} - 1}{e^{\frac{t}{2^k}} - 1}) \prod_{j=1}^{k - 1} e^{\frac{t}{2^k}} + 1 \\
&= \lim_{k \to \infty} \frac{e^{t} -1}{2^k (e^{\frac{t}{2^{k}}} - 1)} \\
&= \frac{e^t - 1}{t} \\
\end{align}

<p>
This one is crazy.
First equality is due to sum of RV is product of MGF.
Second equality is me taking out the constant \( 2 \) in the denominator.
Third equality is multiplying by \( 1 \) (our favorite analysis trick).
Fourth equality is taking the \( n \)-th term of the product out and reducing the index.
Fifth equality is multiplying the numerators, notice the difference of squares.
Sixth equality is actual black magic, we can multiply \( e^{\frac{t}{2^{k-1}}} -1 \) outside of the product with the \( k-1 \)'st term inside the product, yielding another difference of squares. This reduces the problem (by telescoping) until the last term does not cancel with anything.
Last equality is taking the limit. Use the Taylor series of \( e \). This gives
</p>
\begin{align}
2^k \cdot (e^{\frac{t}{2^k}} - 1)
&= 2^k [\frac{t}{2^k} + \frac{1}{2!}\frac{t^2}{2^{2k}} + \cdots] \\
&= [\frac{t}{1} + \frac{1}{2!}\frac{t^2}{2^{k}} + \cdots] \\
&\to t \text{ as } k \to \infty
\end{align}

<p>
Now we may conclude that this is the MGF of a uniform normal variable. Hence \( U_n \) has a uniform distribution.
</p>

<p>
All the \( U_n \) are independent due to the \( B_{f_n(j)} \) only looks at the binary digits which are not found in any other \( f_i \) with \( i \neq n \) by construction.
</p>
</div>
</li>

<li><a id="org6723285"></a>C<br />
<div class="outline-text-5" id="text-3-1-6-3">
<p>
Done by calculating the distribution.
\( \mathbb{P}(\Phi^{-1}(U_n) \leq x) = \mathbb{P}(U_n \leq \Phi(x)) = \Phi(x) \) 
</p>

<p>
The first equality is applying \( \Phi \) to both sides not changing the set. The second equality is by noting that \( U_n \) is a uniform random variable, the distribution states \( \mathbb{P}(U_n \leq t) = t \).
</p>

<p>
Hence the \( X_n \) are random variables (composition of measurable functions) have distribution \( \Phi(x) \) (thus normal) and are independent (\( U_n \) independent implies \( g(U_n) \) independent for \( g \) Borel measurable). 
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org9feefba" class="outline-4">
<h4 id="org9feefba"><span class="section-number-4">3.1.7.</span> Problem 7</h4>
<div class="outline-text-4" id="text-3-1-7">
</div>
<ol class="org-ol">
<li><a id="org8d293b8"></a>A<br />
<div class="outline-text-5" id="text-3-1-7-1">
<p>
I will prove this statement using part B.
Let \( \mathcal{F}(X) \) and \( \mathcal{F}(Y, \mathcal{G}) \) be independent \( \sigma \)-algebras.
</p>

\begin{align}
\E[XY \vert \mathcal{G}]
&=  \E[\E[XY \vert \mathcal{F}(Y,\mathcal{G})] \vert \mathcal{G}]\\
&=  \E[Y \E[X \vert \mathcal{F}(Y,\mathcal{G})] \vert \mathcal{G}]\\
&=  \E[Y \E[X] \vert \mathcal{G}]\\
&=  \E[X]\E[Y \vert \mathcal{G}]\\
\end{align}
<p>
The first equality is the tower property.
The second equality is because \( Y \) is \( \mathcal{F}(Y) \)-measurable.
The third equality is because \( X \) is independent from \( \mathcal{F}(Y, \mathcal{G}) \) by hypothesis.
The last equality is linearity of expected value.
</p>
</div>
</li>

<li><a id="org0fcbc79"></a>B<br />
<div class="outline-text-5" id="text-3-1-7-2">
<p>
Suppose \( X \) is \( \mathcal{G} \)-measurable.
We will show that \( \E[XY \vert \mathcal{G}] = X\E[Y \vert \mathcal{G}] \). We do this proof in stages. We will also show that it is enough to know this fact for non-negative random variables. The justification is, given \( X \) and \( Y \) we may decompose using the standard notation \( X = X^+ - X^- \) and \( Y = Y^+ - Y^- \).
Then,
</p>
\begin{align}
\E[(X^+ - X^-)(Y^+ - Y^-) \vert \mathcal{G}]
&= \E[X^+ Y^+ \vert \mathcal{G}] - \\
   &\E[X^+ Y^- \vert \mathcal{G}] - \\
   &\E[X^- Y^+ \vert \mathcal{G}] + \\
   &\E[X^- Y^- \vert \mathcal{G}] \\
&= X^+\E[Y^+ \vert \mathcal{G}] - \\
   &X^+\E[ Y^- \vert \mathcal{G}] - \\
   &X^-\E[ Y^+ \vert \mathcal{G}] + \\
   &X^-\E[ Y^- \vert \mathcal{G}] \\
&= (X^+-X^-)\E[Y^+ \vert \mathcal{G}] - \\
   &(X^+ - X^-)\E[ Y^- \vert \mathcal{G}] \\
&= (X^+-X^-)\E[Y^+ - Y^- \vert \mathcal{G}] \\
&= X\E[Y \vert \mathcal{G}]
\end{align}

<p>
(I apologize for the formatting, I didn't know how to make this look better.)
By using linearity and assuming the theorem for the positive case we have proven it for the more general case. For the remainder of this proof assume \( X,Y \geq 0 \).
</p>

<p>
We have that \( X \E[Y \vert \mathcal{G}] \) is \( \mathcal{G} \)-measurable. It remains to be shown that given an \( A \in \mathcal{G} \)  \( \int_A X \E[Y \vert \mathcal{G}] dP = \int_A XY dP \) 
</p>

<p>
First assume that \( B \in \mathcal{G} \) and \( X = \mathbbm{1}_B \).
Then \(  \)
</p>
\begin{align*}
\int_A \mathbbm{1}_B \E[Y \vert \mathcal{G}] dP
&= \int_{A \cap B} \E[Y \vert \mathcal{G}] dP \) \\
&= \int_{A \cap B} Y dP \\
&= \int_{A} \mathbbm{1}_B Y dP \\
&= \int_{A} X Y dP \\
\end{align*}

<p>
Then we may extend this using linearity to simple functions. Suppose \( X = \sum_{j=1}^{n} c_j \mathbbm{1}_{B_j} \) 
</p>
\begin{align*}
\int_A [\sum_{j=1}^{n} c_j \mathbbm{1}_{B_j}] \E[Y \vert \mathcal{G}] dP
&= \sum_{j=1}^{n} \int_{A \cap B_j} c_j \E[Y \vert \mathcal{G}] dP \) \\
&= \sum_{j=1}^{n} \int_{A \cap Bj} c_j Y dP \\
&= \int_{A} [\sum_{j=1}^n c_j \mathbbm{1}_{B_j}] Y dP \\
&= \int_{A} X Y dP \\
\end{align*}
<p>
Then we suppose that there is an increasing sequence of simple functions \( X_n \to X \).
</p>
\begin{align*}
\lim_{n \to \infty} \int_A X_n \E[Y \vert \mathcal{G}] dP
&= \lim_{n \to \infty} \int_{A} X_n Y dP \\
&= \int_{A} X Y dP \\
\end{align*}
<p>
The first equation is true because of the last step and we know \( X_n \) are simple. The second one is due to the monotone convergence theorem.
</p>
</div>
</li>


<li><a id="org009ada5"></a>C<br />
<div class="outline-text-5" id="text-3-1-7-3">
<p>
Let \( f \colon \mathbb{R} \to \mathbb{R} \) be Borel Measureable.
We will show \( \E[f(X) Y \vert X] = f(X) \E[Y \vert X] \). 
</p>

<p>
We know that \( f(X) \) is \( \mathcal{F}(X) \)-measurable. Hence by part B we may pull it out of the expectation.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org355999a" class="outline-4">
<h4 id="org355999a"><span class="section-number-4">3.1.8.</span> Problem 8</h4>
<div class="outline-text-4" id="text-3-1-8">
<p>
First we calculate the expected value of \( W_n \)
</p>
\begin{align}
\E[W_n]
&= \E[\sum_{j=1}^{n} B_j X_j] \\
&= \sum_{j=1}^{n} \E[B_j X_j] \\
&= \sum_{j=1}^{n} [\E[\E[B_j X_j \vert B_j]]] \\
&= \sum_{j=1}^{n} \E[B_j \E[X_j]] \\
&= \sum_{j=1}^{n} \E[B_j \E[X_j \vert B_j]] \\
&= \sum_{j=1}^{n} \E[B_j \cdot 0] \\
&= 0
\end{align}

<p>
The first equality is the definition of \( W_n \).
The second equality uses linearity of expected value.
The third equality uses \( \E[X] = \E[\E[X \vert G]] \).
The fourth uses the fact \( B_j \) is measurable with respect to \( \mathcal{F}(B_j) \).
The fifth uses independence of coin flips. That is, \( B_j \) tells you about the previous \( j-1 \)  coin flips. But that is independent from the \( j \)-th coin flip.
The sixth is a straight calculation of expected value, \( X_j \) is symmetric around \( 0 \).
The last is multiplying and adding.
</p>

<p>
Now we calculate the expected value with respect to the previous filtration.
</p>
\begin{align}
\E[W_n \vert X_1, \cdots, X_{n-1}]
&= \E[\E[W_n \vert X_1, \cdots, X_n] \vert X_1, \cdots, X_{n_1}] \\
&= \E[\E[W_n] \vert X_1, \cdots, X_{n_1}] \\
&= \E[0 \vert X_1, \cdots, X_{n_1}] \\
&= 0 \\
&= \E[X_{n-1}]
\end{align}
<p>
The first equality uses the tower rule.
The second notes that \( W_n \) is \( X_1, \cdots, X_n \) measurable.
The third equality uses the expected value we calculated previously.
The rest is noting that the expectations are the same as what we desire.
</p>
</div>
</div>

<div id="outline-container-org5ffde62" class="outline-4">
<h4 id="org5ffde62"><span class="section-number-4">3.1.9.</span> Problem 9</h4>
<div class="outline-text-4" id="text-3-1-9">
<p>
Let \( X \sim N(\mu_1, \sigma_1^2) \) and \( Y \sim N(\mu_2, \sigma_2^2) \) be independent random variables.
</p>

<p>
Denote \( \varphi_{X + Y}(t) = \E[\exp(it(X + Y))] \) to be the characteristic function of \( X+Y \).
</p>

\begin{align}
\varphi_{X+Y}(t)
&= \varphi_X(t) \varphi_Y(t) \\
&= \exp(it \mu_1 - \frac{\sigma_1^2 t^2}{2}) \exp(it \mu_2 - \frac{\sigma_2^2 t^2}{2}) \\
&= \exp(it (\mu_1 + \mu_2) - \frac{(\sigma_1^2 \sigma_2^2) t^2}{2}) \\
\end{align}
<p>
Hence \( X+Y \sim N(\mu_1 + \mu_2, \sigma_1^2 + \sigma_2^2) \)
Similarly,
</p>
\begin{align}
\varphi_{X-Y}(t)
&= \varphi_X(t) \varphi_Y(-t) \\
&= \exp(it \mu_1 - \frac{\sigma_1^2 t^2}{2}) \exp(-it \mu_2 - \frac{\sigma_2^2 t^2}{2}) \\
&= \exp(it (\mu_1 - \mu_2) - \frac{(\sigma_1^2 \sigma_2^2) t^2}{2}) \\
\end{align}

<p>
Hence \( X-Y \sim N(\mu_1 - \mu_2, \sigma_1^2 + \sigma_2^2) \)
</p>

<p>
Independence: In class we had that for <b>normal</b> RV's \( \Cov(X,Y) = 0 \implies \) Independence (False in general).
Hence, we perform a quick calculation.
</p>

\begin{align*}
\Cov(X+Y,X-Y)
&= \Cov(X,X-Y) + \Cov(Y,X-Y) \\
&= \Cov(X,X) - \Cov(X, Y) + \Cov(Y,X) - \Cov(Y,Y) \\
&= \sigma_1^2 - \sigma_2^2
\end{align*}
<p>
This shows that if \( X \) and \( Y \) have the same variance then they are independent. It's curious, symbolically they must have the same variance if they want to be independent. But it's not intuitive for me at least.
</p>
</div>
</div>

<div id="outline-container-org77cc636" class="outline-4">
<h4 id="org77cc636"><span class="section-number-4">3.1.10.</span> Problem 10</h4>
<div class="outline-text-4" id="text-3-1-10">
<p>
Let \( X \sim \exp(\lambda) \). \( X \) has density \( f(x) \colon = \lambda e^{- \lambda x} . (x > 0)\).
</p>

<p>
\( X \) has distribution function
</p>

\begin{align*}
F(t)
&= \int_0^{t} \lambda e^{- \lambda x} dx \\
&= \lambda [\frac{1}{-\lambda} e^{- \lambda x}]_{x = 0}^{x = t} \\
&= - [e^{- \lambda t} - 1] \\
&= 1 - e^{-\lambda t}
\end{align*}
</div>


<ol class="org-ol">
<li><a id="orge038833"></a>A<br />
<div class="outline-text-5" id="text-3-1-10-1">
\begin{align*}
P\{X \geq s + t \vert X \geq s \}
&= \frac{P\{X \geq s + t\}}{P\{X \geq s\}} \\
&= \frac{1 - F(s + t)}{1 - F(s)} \\
&= \frac{e^{- \lambda (s + t)}}{e^{- \lambda s}} \\
&= \frac{e^{- \lambda s}e^{-\lambda t}}{e^{- \lambda s}} \\
&= e^{-\lambda t} \\
&= P\{X \geq t \}
\end{align*}
</div>
</li>

<li><a id="org52b0aa3"></a>B<br />
<div class="outline-text-5" id="text-3-1-10-2">
<p>
Suppose \( Y \) is a random variable that has the memoryless property.
</p>

<p>
Then \( P\{ Y \geq s + t \vert Y \geq s \} = P\{ Y \geq t \} \)
Also from the conditional distribution we have \( \frac{P\{ Y \geq s + t\}}{P\{ Y \geq s \}} = P\{ Y \geq t \} \)
Hence \( P\{Y \geq s + t\} = P\{Y \geq s \} P\{Y \geq t\} \)
</p>

<p>
Note, \( P\{ Y \geq s\} = 1 - F_Y(s) \), by hypothesis \( F_Y \) (the distribution of \( Y \)) is continuous.
</p>

<p>
Denote \( g(s) = 1 - F_Y(s) \). We then have a functional equation \( g(s+t) = g(s) g(t) \) where \( g \) is decreasing (\( F_Y \) is increasing function) and continuous because as \( F_Y \) is continuous again by hypothesis.
</p>

<p>
Setting \( h(x) = \log(g(x)) \) and taking the log of both sides gives us the famous Cauchy functional equation for a continuous function \( h(x + y) = h(x) + h(y) \)  meaning \( h(x) = \lambda x \). To actually prove it, I would show that \( h(nx) = nh(x) \) for any integer \( n \). Then I would show that \( h(qx) = qh(x) \) for any rational \( q \). Then I would show by continuity \( h(cx) = ch(x) \) for any real \( c \). Then I would show that \( h(x) = cx \) by linear algebra. Hopefully saying <b>famous</b> and <b>Cauchy</b> in the same sentence is a proof.
</p>

<p>
Hence \( g(x) = e^{\lambda x} \). Because \( g \) is monotone decreasing we note that \( \lambda < 0 \). Hence the only random variable with continuous distribution is an exponentially distributed random variable.
</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</body>
</html>

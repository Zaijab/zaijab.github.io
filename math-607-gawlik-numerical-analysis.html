<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-10-03 Thu 14:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MATH 607 Gawlik Numerical Analysis</title>
<meta name="author" content="Zain Jabbar" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>

          <link rel="stylesheet" href="static/css/site.css" type="text/css"/>
          <header><div class="menu"><ul>
          <li><a href="/">/</a></li>
          <li><a href="/about">/about</a></li>
          <li><a href="/posts">/posts</a></li></ul></div></header>
          <script src="static/js/nastaliq.js"></script>
          <script src="static/js/stacking.js"></script>
          <link href='https://unpkg.com/tippy.js@6.2.3/themes/light.css' rel='stylesheet'>
          <script src="https://unpkg.com/@popperjs/core@2"></script>
          <script src="https://unpkg.com/tippy.js@6"></script>
          <script>
          document.addEventListener('DOMContentLoaded', function() {
            let page = document.querySelector('.page');
            if (page) {
              initializePreviews(page);
            }
          });
          </script>
<script>MathJax = { loader: { load: ['[custom]/xypic.js'], paths: {custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/'} }, tex: { packages: {'[+]': ['xypic']}, macros: { R: "{\\bf R}" } } };</script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml-full.js"></script>
<div class="grid-container"><div class="ds-grid"><div class="page">
<script>MathJax = { loader: { load: ['[custom]/xypic.js'], paths: {custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/'} }, tex: { packages: {'[+]': ['xypic']}, macros: { R: "{\\bf R}" } } };</script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml-full.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">MATH 607 Gawlik Numerical Analysis</h1>
<p>
Class at <a href="university-of-hawaii-at-manoa.html#ID-2728f603-9489-4920-bdf6-e56ea4c5c6de">University of Hawaii at Manoa</a>.
</p>
<div id="outline-container-orgfe89141" class="outline-2">
<h2 id="orgfe89141"><span class="section-number-2">1.</span> <span class="done DONE">DONE</span> Homework 1</h2>
<div class="outline-text-2" id="text-1">
<p>
<b>Notation</b>
</p>

<p>
If we are given a matrix \( M \), then the \( ij \)-th entry of \( M \) is denoted by subscript \( M_{i,j} \). The comma attempts to avoid confusion by not conflating the index \( ij \) with its product. However this may introduce confusion if one normally uses \( ,j \) for the partial derivative with respect to \( j \). We use colons (\( \colon \)) in the index to denote the matrix which includes all of the valid indices for the given subscript. For example:
</p>

<p>
If \( A \in C^{n \times m} \) then
</p>

<ul class="org-ul">
<li>\( A_{1, \colon} \) is the first row of the matrix. It is of shape \( 1 \times m \).</li>
<li>\( A_{\colon, 1} \) is the first column of the matrix. It is of shape \( n \times 1 \).</li>
<li>\( A_{\colon,\colon} \) is just \( A \) itself</li>
</ul>
</div>
<div id="outline-container-org74aba42" class="outline-3">
<h3 id="org74aba42"><span class="section-number-3">1.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org3d0a5d7" class="outline-4">
<h4 id="org3d0a5d7"><span class="section-number-4">1.1.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Let \( A \in \mathbb{C}^{m \times n} \). Show that
</p>

<p>
\[ ||A||_{\infty} = \max_{1 \leq i \leq m} ||a_{i}^{\ast}||_{1} \]
Where \( a_{i}^{\ast} \) denotes the \( i^{th} \) row of \( A \) and \( ||a_{i}^{\ast}||_{1} = \sum_{k = 1}^{n} |(a_{i})_{k}| \)
</p>
</div>
</div>
<div id="outline-container-org08a5b3b" class="outline-4">
<h4 id="org08a5b3b"><span class="section-number-4">1.1.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
First, we show
</p>

<p>
\[ ||A||_{\infty} \leq \max_{1 \leq i \leq m} ||a_{i}^{\ast}||_{1} \]
</p>

\begin{align}
||A||_\infty
&= \sup_{||x||_\infty = 1} ||A x||_\infty \tag{Def. $\infty$-Norm} \\
&= \left| \left| \sum_{i = 1}^{n} A_{i, :} x_{i} \right| \right|_{\infty} \tag{Def. Matrix Mult} \\
&\leq \sum_{i = 1}^{n} \left| \left|  A_{i, :}  x_{i} \right| \right|_{\infty} \tag{Triangle Inequality} \\
&\leq \sum_{i = 1}^{n} \left| \left|  A_{i, :} \right| \right|_\infty \left| \left|  x_{i} \right| \right|_\infty \tag{Sub-Multiplicativity} \\
&\leq \sum_{i = 1}^{n} \left| \left|  A_{i, :} \right| \right|_\infty \tag{$||x||_{\infty} = 1 \implies ||x_{j}|| \leq 1$} \\
&\leq \sum_{i = 1}^{n} \max_{1 \leq j \leq m}  | A_{i, j} | \tag{Def. $\infty$-Norm} \\
&= \max_{1 \leq j \leq m}  \sum_{i = 1}^{n} | A_{i, j} | \tag{Independent Indicies} \\
&= \max_{1 \leq j \leq m}   \left| \left| A_{:, j} \right| \right|_{1} \tag{Def. $1$-Norm}
\end{align}

<p>
Next, we show
</p>

<p>
\[ ||A||_{\infty} \geq \max_{1 \leq i \leq m} ||a_{i}^{\ast}||_{1} \]
</p>

<p>
We may leverage the fact that the norm is defined by supremum. The goal is to devise a special unit vector which proves the claim. First, consider the collection of all row sums.
</p>

<p>
\[  \left\{ \sum_{k = 1}^{n} \left| A_{i, k} \right| \right\}_{1 \leq i \leq m} \]
</p>

<p>
There is a largest such row sum, call it row \( L \). Define \( x \in \mathbb{C}^{n} \) such that \( x_{k} = \frac{A_{L,k}^{\ast}}{|A_{L,k}|} \). Note that,
\[ \forall k \colon 1 \leq k \leq n : \left| x_k \right| = \left| \frac{A_{L,k}^{*}}{|A_{L,k}|} \right| = 1 \]
</p>

<p>
Hence \( ||x||_{\infty} = 1 \) 
</p>


\begin{align}
||A||_\infty
&= \sup_{||v||_\infty = 1} ||A v||_\infty \tag{Def. $\infty$-Norm} \\
&\geq || A x ||_{\infty} \tag{$|| x ||_{\infty} = 1$, Particular vector smaller than Supremum} \\
&= \left| \left| \sum_{k = 1}^{n} A_{:, k} x_k \right| \right|_{\infty} \tag{Def. Matrix Multiplication} \\
&= \max_{1 \leq i \leq m} \left| \sum_{k = 1}^{n} A_{i, k} x_k \right| \tag{Def. $\infty$-Norm} \\
&\geq \left| \sum_{k = 1}^{n} A_{L, k} x_k \right| \tag{Particular Entry Smaller than Max} \\
&= \left| \sum_{k = 1}^{n} A_{L, k} \frac{A_{L,k}^{\ast}}{|A_{L,k}|} \right| \tag{Def. $x$} \\
&= \left| \sum_{k = 1}^{n} \frac{A_{L, k} A_{L,k}^{\ast}}{|A_{L,k}|} \right| \tag{Simplify} \\
&= \left| \sum_{k = 1}^{n} \frac{|A_{L, k}|^{2}}{|A_{L,k}|} \right| \tag{Property of Conjugate} \\
&= \left| \sum_{k = 1}^{n} |A_{L, k}| \right| \tag{Simplify} \\
&= \sum_{k = 1}^{n} |A_{L, k}| \tag{Sum of Positive}
\end{align}
</div>
</div>
</div>
<div id="outline-container-org939e024" class="outline-3">
<h3 id="org939e024"><span class="section-number-3">1.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orgc359ae9" class="outline-4">
<h4 id="orgc359ae9"><span class="section-number-4">1.2.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Show that if \( D \in \mathbb{C}^{m \times m} \) is a diagonal matrix, then \( || D ||_{p} = \max_{1 \leq i \leq m} |D_{ii}| \) for any \( 1 \leq p \leq \infty \)   
</p>
</div>
</div>
<div id="outline-container-org1580f74" class="outline-4">
<h4 id="org1580f74"><span class="section-number-4">1.2.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
Let \( D \) be a diagonal matrix
</p>

\begin{align}
|| D ||_p
&= \sup_{||x||_p = 1} ||Dx||_p \tag{Def. $p$-Norm} \\
&= \sup_{||x||_p = 1} \left| \left|\sum_{k = 1}^{m} D_{:, k} x_{k} \right| \right|_p \tag{Def. Matrix Multiplication} \\
&= \sup_{||x||_p = 1} \left( \sum_{i = 1}^{m} \left | \sum_{k = 1}^{m} D_{i, k} x_{k} \right|^{p} \right)^{\frac{1}{p}} \tag{Def. $p$-Norm} \\
&= \sup_{||x||_p = 1} \left( \sum_{i = 1}^{m} \left | D_{i, i} x_{i} \right|^{p} \right)^{\frac{1}{p}} \tag{\( D \) Diagonal} \\
&\leq \sup_{||x||_p = 1} \left( \sum_{i = 1}^{m} \left | \left( \max_{1 \leq i \leq m}D_{i, i} \right) x_{i} \right|^{p} \right)^{\frac{1}{p}} \tag{Take Max Value} \\
&\leq \sup_{||x||_p = 1} \left| \max_{1 \leq i \leq m} D_{i, i} \right| \left( \sum_{i = 1}^{m} \left | x_{i} \right|^{p} \right)^{\frac{1}{p}} \tag{Max Value is Constant} \\
&\leq \left| \max_{1 \leq i \leq m} D_{i, i} \right| \sup_{||x||_p = 1}  \left( \sum_{i = 1}^{m} \left | x_{i} \right|^{p} \right)^{\frac{1}{p}} \tag{Max Value is independent of Sup} \\
&\leq \left| \max_{1 \leq i \leq m} D_{i, i} \right| \tag{Norm of Sup with Norm 1 is 1}
\end{align}

<p>
On the other hand, let \( j = \argmax_{1 \leq j \leq m} D_{j,j} \) and \( e_{j} \) be the unit basis vector in the \( j \)-th direction (that is, \( 1 \) in the \( j \)-th component and \( 0 \) else).
Then
</p>

\begin{align}
||D||_p
&= \sup_{||x||_p = 1} || Dx ||_p \tag{Def. $p$-Norm} \\
&\geq || D e_j ||_p \tag{Particular Vector Smaller than Sup} \\
&\geq || D_{:,j} ||_p \tag{Matrix Multiplication} \\
&= \left( \sum_{i = 1}^{m} \left| D_{i,j} \right|^p \right)^{1/p} \tag{Def. $p$-Norm} \\
&= \left( \left| D_{j,j} \right|^p \right)^{1/p} \tag{$x^{p}$ Monotone Increasing} \\
&\geq | D_{j,j} | \tag{Exponent Rules}
\end{align}
</div>
</div>
</div>
<div id="outline-container-orgf048f0b" class="outline-3">
<h3 id="orgf048f0b"><span class="section-number-3">1.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org0a59130" class="outline-4">
<h4 id="org0a59130"><span class="section-number-4">1.3.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Exercise 3.3. In (c) and (d), you may skip the part about finding an example where equality is achieved.
</p>

<p>
Vector and matrix \( p \)-norms are related by various inequalities, often involving the dimensions \( m \) or \( n \). For each    
</p>

<ul class="org-ul">
<li>(a) \( || x ||_{\infty} \leq || x ||_{2} \)</li>
<li>(b) \( || x ||_{2} \leq \sqrt{m}|| x ||_{\infty} \)</li>
<li>(c) \( || A ||_{\infty} \leq \sqrt{n} || A ||_{2} \)</li>
<li>(d) \( || A ||_{2} \leq \sqrt{m} || x ||_{\infty} \)</li>
</ul>
</div>
</div>
<div id="outline-container-org1712dc6" class="outline-4">
<h4 id="org1712dc6"><span class="section-number-4">1.3.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-3-2">
</div>
<ol class="org-ol">
<li><a id="org4bb19fc"></a>A<br />
<div class="outline-text-5" id="text-1-3-2-1">
<p>
Let
\[ M = \argmax_{1 \leq i \leq m} | x_i | \]
</p>


\begin{align}
\| x  \|_\infty
&= | x_M | \tag{Def. $\infty$-Norm} \\
&= ( x_M^{2} )^{1/2} \tag{Property of Absolute Value} \\
&\leq ( x_M^{2} + \sum_{i \neq M} x_{i}^{2} )^{1/2} \tag{$\sqrt{x}$ Monotone Increasing} \\
&= \| x \|_{2} \tag{Def. $2$-Norm}
\end{align}

<p>
Equality is achieved for unit basis vector,
</p>

<p>
\[ \| (1, 0, \ldots, 0) \|_{\infty} = 1 = \| (1, 0, \ldots, 0) \|_{2} \] 
</p>
</div>
</li>
<li><a id="org8491dae"></a>B<br />
<div class="outline-text-5" id="text-1-3-2-2">
\begin{align}
\| x \|_2
&= \left( \sum_{i = 1}^{m} x_{i}^{2} \right)^{1/2} \tag{Def $2$-Norm} \\
&\leq \left( \sum_{i = 1}^{m} \left( \max_{1 \leq j \leq m} x_{j} \right)^{2} \right)^{1/2} \tag{Property of Max} \\
&= \left( m \left( \max_{1 \leq j \leq m} x_{j} \right)^{2} \right)^{1/2} \tag{Max is Constant} \\
&= \sqrt{m} \| x \|_{\infty} \tag{Def. $\infty$-Norm}
\end{align}

<p>
Equality is achieved for vector of ones,
\[ \| (1, 1, \ldots, 1) \|_{2} = \sqrt{m} = \sqrt{m} \| (1, 1, \ldots, 1) \|_{\infty} \]
</p>
</div>
</li>
<li><a id="org1e8e800"></a>C<br />
<div class="outline-text-5" id="text-1-3-2-3">
\begin{align}
\| A \|_{\infty}
&= \sup_{ x \neq 0} \frac{\| Ax \|_{\infty}}{\| x \|_{\infty}} \tag{Def. $\infty$-Norm} \\
&\leq \sup_{ x \neq 0} \frac{\| Ax \|_{2}}{\| x \|_{\infty}} \tag{Part A} \\
&\leq \sup_{ x \neq 0} \frac{\| Ax \|_{2}}{\frac{1}{\sqrt{n}}\| x \|_{2}} \tag{Part B} \\
&= \sqrt{n} \sup_{ x \neq 0} \frac{\| Ax \|_{2}}{\| x \|_{2}} \tag{Simplify} \\
&= \sqrt{n} \| A \|_{2} \tag{Def. $2$-Norm}
\end{align}
</div>
</li>
<li><a id="orgb6d4e02"></a>D<br />
<div class="outline-text-5" id="text-1-3-2-4">
\begin{align}
\| A \|_{2}
&= \sup_{x \neq 0} \frac{\| Ax \|_{2}}{\| x \|_{2}} \tag{Def. \( 2 \)-Norm} \\
&= \sup_{x \neq 0} \frac{\sqrt{m} \| Ax \|_{\infty}}{\| x \|_{2}} \tag{Part B} \\
&= \sup_{x \neq 0} \frac{\sqrt{m} \| Ax \|_{\infty}}{\| x \|_{\infty}} \tag{Part A} \\
&= \sqrt{m} \| Ax \|_{\infty} \tag{Def. \( \infty \)-Norm}
\end{align}
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orge9ae07e" class="outline-3">
<h3 id="orge9ae07e"><span class="section-number-3">1.4.</span> Problem 4</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org7e3cbd8" class="outline-4">
<h4 id="org7e3cbd8"><span class="section-number-4">1.4.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Exercise 5.3 (a,b,c)
</p>

<p>
Consider the matrix
</p>

<p>
\[ A = \begin{bmatrix} -2 & 11 \\ -10 & 5 \end{bmatrix} \]
</p>

<ul class="org-ul">
<li>(a) Determine, on paper a real SVD of \( A \) in the form \( A = U \Sigma V^{T} \). The SVD is not unique, so find the one that has the minimal number of minus signs in \( U \) and \( V \).</li>

<li>(b) List the singular values, left singular vectors, and right singular vectors of \( A \). Draw a careful, labeled picture of the unit ball in \( \mathbb{R}^{2} \) and its image under \( A \), together with the singular vectors, with the coordinates of their vertices marked.</li>

<li>(c) What are the \( 1- \), \( 2- \), \( \infty- \), and Frobenius Norms of \( A \)?</li>
</ul>
</div>
</div>
<div id="outline-container-orgdc5598c" class="outline-4">
<h4 id="orgdc5598c"><span class="section-number-4">1.4.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Seems a big importance is placed on doing the drawing and calculations on paper. Parts A and B are to be turned in separately. Part C may be stated here.
</p>

<p>
The \( 1 \)-Norm is the max column sum hence: 
\[ \| A \|_{1} = 16 \]
</p>

<p>
The \( 2 \)-Norm is the largest singular value hence 
\[ \| A \|_{2} = \sigma_{1} = 10\sqrt{2} \]
</p>

<p>
The \( \infty \)-Norm is the max row sum hence: 
\[ \| A \|_{\infty} = 15 \]
</p>

<p>
The Frobenius norm is the sum of the squares of the singular values
\[ \| A \|_{F} = \sqrt{250} \]
</p>
</div>
</div>
</div>
<div id="outline-container-org1537b9a" class="outline-3">
<h3 id="org1537b9a"><span class="section-number-3">1.5.</span> Problem 5</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org36df261" class="outline-4">
<h4 id="org36df261"><span class="section-number-4">1.5.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Let \( A = \begin{bmatrix} 3 & 4 \\ 6 & 8 \\ 6 & 8 \end{bmatrix} \) 
</p>

<ul class="org-ul">
<li>(a) Write down an SVD of A in summation form: \( A = \sum_{j = 1}^{r} \sigma_{j} u_{j} v_{j}^{\ast} \)</li>

<li>(b) Write down a reduced SVD \( A = \hat{U} \hat{\Sigma} V^{\ast} \)</li>

<li>(c) Write down as full SVD \( A = U \Sigma V^{\ast} \)</li>
</ul>
</div>
</div>
<div id="outline-container-org6e78085" class="outline-4">
<h4 id="org6e78085"><span class="section-number-4">1.5.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
Having been told there should not be any lengthy calculations, we may search for more clever ways of calculation.
</p>

<p>
\[ v = \begin{bmatrix} 3 \\ 4 \end{bmatrix} A = \begin{bmatrix} v^{T} \\ 2v^{T} \\ 2v^{T} \end{bmatrix} \]
</p>


<p>
\[ A^{T} A = v v^{T} + 4 vv^{T} + 4 vv^{T} = 9 v v^{T} = 9 \begin{bmatrix} 9 & 12 \\ 12 & 16 \end{bmatrix}  \]
</p>

<p>
We note that this is an outer product. This gives us a lot of structure. Outer products are rank 1, hence not invertible hence has one eigenvalue \( 0 \). It's other eigenvalue is given by the trace, \( 9 \cdot (9 + 16) = 9 \cdot 25 = (3 \cdot 5)^{2} = 225 \). This gives us the singular values,
</p>

<p>
\[ \sigma_{1} = 15, \sigma_{2} = 0 \]
</p>


<p>
The eigenvectors are \( v \) (the non transposed vector in an outer product) and anything orthogonal to \( v \) (which would be \( \begin{bmatrix} -4 \\ 3 \end{bmatrix} \) the perpendicular slope rule in middle school).
</p>

<p>
\[ v_{1} = v = \begin{bmatrix} 3 \\ 4 \end{bmatrix}, v_{2} = v^{\perp} = \begin{bmatrix} -4 \\ 3 \end{bmatrix} \]
</p>

<p>
Next, we look for the vectors composing \( U \) 
</p>


<p>
\[ AA^{T} = \begin{bmatrix} v^{T} v & 2 v^{T} v & 2 v^{T} v \\ 2 v^{T} v & 4 v^{T} v & 4 v^{T} v \\  2 v^{T} v & 4 v^{T} v & 4 v^{T} v  \end{bmatrix} \]
</p>

<p>
The null vectors are found by inspection
</p>

<p>
\[ n_{1} = \begin{bmatrix} 2 \\ -1 \\0 \end{bmatrix} , n_{2} = \begin{bmatrix} 0 \\ 1 \\ -1 \end{bmatrix}  \]
</p>

<p>
These null vectors are not necessarily orthogonal, to find a relation making them orthogonal, we may find a vector in their span which is orthogonal.
</p>

<p>
\[ 0 = \left\langle n_{1}, an_{1} + bn_{2} \right\rangle = \left\langle  \begin{bmatrix} 2 \\ -1 \\0 \end{bmatrix},  \begin{bmatrix} 2a \\ -a \\0 \end{bmatrix} + \begin{bmatrix} 0 \\ b \\ -b \end{bmatrix} \right\rangle = 5a - b \]
</p>

<p>
So \( 5a = b \), setting \( a = 1 \) gives us two orthogonal vectors:
</p>

<p>
\[ u_{2} = \begin{bmatrix} 2 \\ -1 \\0 \end{bmatrix} , u_{3} = \begin{bmatrix} 2 \\ 4 \\ -5 \end{bmatrix}  \]
</p>


<p>
The last eigenvector would be the nullvector
</p>

\begin{align}
A A^{T} - 225 I
&= A A^{T} - 9 v^{T} v \\
&= \begin{bmatrix} - 8 v^{T} v & 2 v^{T} v & 2 v^{T} v \\ 2 v^{T} v & -5 v^{T} v & 4 v^{T} v \\  2 v^{T} v & 4 v^{T} v & -5 v^{T} v  \end{bmatrix}
\end{align}

<p>
Which has null vector
</p>

<p>
\[ u_{1} = \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix} \]
</p>

<p>
Now we may begin solving each of the parts. Note that we must normalize all vectors to be of unit length for the formulae to work.
</p>
</div>
<ol class="org-ol">
<li><a id="org1945adb"></a>A<br />
<div class="outline-text-5" id="text-1-5-2-1">
<p>
\[ A = \sigma_{1} u_{1} v_{1}^{T} = 15 \cdot \begin{bmatrix} 1/3 \\ 2/3 \\ 2/3 \end{bmatrix} \begin{bmatrix} 3/5 \\ 4/5 \end{bmatrix}^T \]
</p>
</div>
</li>
<li><a id="orga4a186c"></a>B<br />
<div class="outline-text-5" id="text-1-5-2-2">
<p>
\[ A = \hat{U} \hat{\Sigma} V^{T} = \begin{bmatrix} 1/3 & 2/\sqrt{5} \\ 2/3 & -1/\sqrt{5} \\ 2/3 & 0 \end{bmatrix} \begin{bmatrix} 15 & 0 \\ 0 & 0 \end{bmatrix} \begin{bmatrix} 3/5 & -4/5 \\ 4/5 & 3/5 \end{bmatrix}^T  \]
</p>
</div>
</li>
<li><a id="org129425e"></a>C<br />
<div class="outline-text-5" id="text-1-5-2-3">
<p>
\[ A = U \Sigma V^{T} = \begin{bmatrix} 1/3 & 2/\sqrt{5} & 2/\sqrt{45} \\ 2/3 & -1/\sqrt{5} & 4/\sqrt{45} \\ 2/3 & 0 & -5/\sqrt{45} \end{bmatrix} \begin{bmatrix} 15 & 0 \\ 0 & 0 \\ 0 & 0 \end{bmatrix} \begin{bmatrix} 3/5 & -4/5 \\ 4/5 & 3/5 \end{bmatrix}^T  \]
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org2522ca2" class="outline-3">
<h3 id="org2522ca2"><span class="section-number-3">1.6.</span> Problem 6</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-orgda0b949" class="outline-4">
<h4 id="orgda0b949"><span class="section-number-4">1.6.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
Use the singular value decomposition to show that any \( A \in \mathbb{C}^{m \times n}, m \geq n \) may be written in the form \( A = WH \) where \( H \in \mathbb{C}^{n \times n} \) is Hermitian Positive semidefinite and \( W \in \mathbb{C}^{m \times n} \) has orthonormal columns (\( W^{\ast}W = I \)).
</p>
</div>
</div>
<div id="outline-container-org211eb93" class="outline-4">
<h4 id="org211eb93"><span class="section-number-4">1.6.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
Let \( A \in \mathbb{C}^{m \times n} \).
</p>

\begin{align}
A
&= U \Sigma V^{\ast} \tag{SVD} \\
&= U (V^{\ast} V) \Sigma V^{\ast} \tag{$V^{\ast} V = I$} \\
&= (U V^{\ast}) (V \Sigma V^{\ast}) \tag{Associativity} \\
&= WH \tag{Name $W = U V^{\ast}, H = V \Sigma V^{\ast}$}
\end{align}

<p>
Claim: \( W \) has orthonormal columns, and \( H \) is Hermitian
</p>

\begin{align}
W^{\ast}W
&= (UV^{\ast})^{\ast} (UV^{\ast}) \tag{Def. $W$} \\
&= (VU^{\ast}) (UV^{\ast}) \tag{Calculate $\ast$} \\
&= VU^{\ast}UV^{\ast} \tag{Associativity} \\
&= VV^{\ast} \tag{$U^{\ast}U = I$} \\
&= I \tag{$VV^{\ast} = I$}
\end{align}

\begin{align}
H^{\ast}
&= (V\Sigma V^{\ast})^{\ast} \tag{Def. $H$} \\
&= V^{\ast \ast} \Sigma^{\ast} V^{\ast} \tag{Calculate $\ast$} \\
&= V \Sigma V^{\ast} \tag{$V^{\ast \ast} = V, \Sigma^{\ast} = \Sigma$} \\
&= H \tag{Def. $H$}
\end{align}

<p>
We note that \( H \) is in an eigendecomposition form. That is, there is an invertible matrix times a diagonal matrix times the inverse of the invertible matrix. The diagonal matrix \( \Sigma \) has non negative entries. Hence, \( H \) is positive semi-definite.   
</p>
</div>
</div>
</div>
<div id="outline-container-org3557342" class="outline-3">
<h3 id="org3557342"><span class="section-number-3">1.7.</span> Problem 7</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-orgce0f9be" class="outline-4">
<h4 id="orgce0f9be"><span class="section-number-4">1.7.1.</span> Statement</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
Type the commands
</p>

<div class="org-src-container">
<pre class="src src-octave">A <span style="color: #8f0075;">=</span> im2double<span style="color: #000000;">(</span>rgb2gray<span style="color: #dd22dd;">(</span>imread<span style="color: #008899;">(</span>&#8217;peppers.png&#8217;<span style="color: #008899;">)</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
imagesc<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> colormap gray
</pre>
</div>

<p>
into Matlab. (These commands load the image “peppers.png”, store its grayscale
values in the matrix A, and plot it.)
</p>

<p>
(a) Using Matlab’s svd command, calculate
</p>

<p>
\[ A_{\nu} = \sum_{j = 1}^{\nu} \sigma_{j} u_{j} v_{j}^{\ast} \]
</p>

<p>
for ν = 10, 20, 30, and plot the resulting images.
</p>

<p>
(b) Determine the smallest index \( \nu \in \mathbb{N} \) such that \( \| A − Aν \|_2 < 0.5 \). Plot the corresponding image \( A_\nu \)
</p>
</div>
</div>
<div id="outline-container-org61978a9" class="outline-4">
<h4 id="org61978a9"><span class="section-number-4">1.7.2.</span> Solution</h4>
<div class="outline-text-4" id="text-1-7-2">
</div>
<ol class="org-ol">
<li><a id="orgc424a49"></a>A<br />
<div class="outline-text-5" id="text-1-7-2-1">
<div class="org-src-container">
<pre class="src src-matlab">A = im2double(rgb2gray(imread('peppers.png')));

%imagesc(A); colormap gray


[U, S, V] = svd(A);

k = 10;
Ak = U(:,1:k)*S(1:k,1:k)*V(:,1:k)';
imagesc(Ak); colormap gray
title('Rank 10')

k = 20;
Ak = U(:,1:k)*S(1:k,1:k)*V(:,1:k)';
figure, imagesc(Ak); colormap gray
title('Rank 20')

k = 30;
Ak = U(:,1:k)*S(1:k,1:k)*V(:,1:k)';
figure, imagesc(Ak); colormap gray
title('Rank 30')
</pre>
</div>



<div id="orgd507d82" class="figure">
<p><img src="flashcard_media/rank10.png" alt="rank10.png" />
</p>
</div>


<div id="org33bcba8" class="figure">
<p><img src="flashcard_media/rank20.png" alt="rank20.png" />
</p>
</div>


<div id="orgea1c358" class="figure">
<p><img src="flashcard_media/rank30.png" alt="rank30.png" />
</p>
</div>
</div>
</li>
<li><a id="orgb75d872"></a>B<br />
<div class="outline-text-5" id="text-1-7-2-2">
<p>
The two norm is the maximum eigenvalue. When taking the difference
</p>

<p>
\[ \| A - A_{\nu} \| = \sigma_{\nu+1} \]
</p>

<p>
We have that \( \sigma_{1} \simeq 150 \) and \( \sigma_{384} \simeq 0.0156 \) so we need to find the \( \nu \) such that \( \sigma_{\nu - 1} \geq 0.5 > \sigma_{\nu} \).
</p>

<p>
This is accomplished by the code:
</p>

<div class="org-src-container">
<pre class="src src-matlab">for i=1:size(S);
    if S(i,i) &lt; 0.5;
        i
        break
    end
end
</pre>
</div>

<p>
Which tells us that \( \nu = 112 \). 
</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgd5a29b0" class="outline-2">
<h2 id="orgd5a29b0"><span class="section-number-2">2.</span> <span class="done DONE">DONE</span> Homework 2</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orga1d5a70" class="outline-3">
<h3 id="orga1d5a70"><span class="section-number-3">2.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-orgdad53a5" class="outline-4">
<h4 id="orgdad53a5"><span class="section-number-4">2.1.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
Exercise 6.3.
</p>

<p>
Given \( A \in \mathbb{C}^{m \times n}, m \geq n \), show that \( A^{\ast} A \) is nonsingular if and only if \( A \) has full rank.
</p>

<p>
Show also that
</p>

<p>
\[ \mathcal{N}(A^{\ast} A) = \mathcal{N}(A) \]
</p>
</div>
</div>
<div id="outline-container-orgb8eb730" class="outline-4">
<h4 id="orgb8eb730"><span class="section-number-4">2.1.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-1-2">
<div class="THEOREM" id="org8b6dbce">
<p>
\[ \mathcal{N}(A^{\ast} A) = \mathcal{N}(A) \]
</p>

</div>

<div class="proof" id="orgebf2336">
<p>
By containment, first, let us prove,
</p>

<p>
\[ \mathcal{N}(A^{\ast} A) \supseteq \mathcal{N}(A) \]
</p>

<p>
Suppose \( n \in \mathcal{N}(A) \) 
Then
</p>

<p>
\[ A^{\ast} A n = A^{\ast} (An) = A^{\ast} 0 = 0 \]
</p>

<p>
Now we show the reverse containment, 
\[ \mathcal{N}(A^{\ast} A) \subseteq \mathcal{N}(A) \]
</p>

<p>
Suppose \( n \in \mathcal{N}(A^{\ast} A) \) 
</p>

<p>
Consider the inner product
</p>

\begin{align}
0
&= \left\langle n , A^{\ast} A n \right\rangle \tag{Zero Orthogonal to All Vectors} \\
&= \left\langle A n , A n \right\rangle \tag{Property of Adjoint} \\
&= \| A n \|_{2} \tag{Def. Induced Norm from Inner Product}
\end{align}

<p>
Because the \( 2 \)-norm is positive definite we have that \( An = 0 \). Hence \( n \in \mathcal{N}(A) \).   
</p>

</div>



<p>
Claim: \( \rank(A^{\ast}A) = \rank(A) \)
</p>

<div class="PROOF" id="org69fee0c">
\begin{align}
\rank(A^{\ast}A)
&= n - \nullity(A^{\ast}A) \tag{Rank-Nullity Theorem} \\
&= n - \nullity(A) \tag{Given \( \mathcal{N}(A^{\ast} A) = \mathcal{N}(A) \)} \\
&= \rank(A) \tag{Rank-Nullity Theorem}
\end{align}

</div>

<p>
Now we prove the problem.
</p>

\begin{lflalign}
& A^{\ast}A  \text{ is nonsingular} \nonumber \\
\iff & \rank(A^{\ast}A) = n \tag{Many Equivalant Ways of Invertibility} \\
\iff & \rank(A) = n \tag{Lemma} \\
\iff & A \text{ has full rank} \tag{Def Full rank}
\end{lflalign}
</div>
</div>
</div>
<div id="outline-container-org1c9683f" class="outline-3">
<h3 id="org1c9683f"><span class="section-number-3">2.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-orgc49a0c8" class="outline-4">
<h4 id="orgc49a0c8"><span class="section-number-4">2.2.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Exercise 6.5
</p>

<p>
Let \( P \in \mathbb{C}^{m \times m} \) be a nonzero projector.
Show that \( \| P \|_{2} \geq 1 \) with equality if and only if \( P \) is an orthogonal projector.  
</p>
</div>
</div>
<div id="outline-container-orgd0436b8" class="outline-4">
<h4 id="orgd0436b8"><span class="section-number-4">2.2.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Let \( P \) be a nonzero projector. Because \( P \) is nonzero projector, there is some nonzero \( v \in \im(P) \). We may then consider \( \hat{v} = \frac{v}{\| v \|_{2}} \). Note, \( \hat{v} \in \im(P) \) because \( \im(P) \) is a vector space.
</p>


\begin{align}
\| P \|_{2}
&= \sup_{x \neq 0} \frac{\| Px \|_{2}}{\| x \|_{2}} \tag{Def. $2$-Norm} \\
&\geq \frac{\| P \hat{v} \|_{2}}{\| \hat{v} \|_{2}} \tag{Sup Greater than One Vector} \\
&= \| P \hat{v} \|_{2} \tag{$\hat{v}$ Unit Vector} \\
&= \| \hat{v} \|_{2} \tag{$\hat{v} \in \im(P)$, $P$ Identity on Image} \\
&= 1 \tag{$\hat{v}$ Unit Vector}
\end{align}

<p>
Now we may prove,
\[ P \text{ Orthogonal Project} \iff \| P \|_{2} = 1 \]
</p>

<p>
We proceed by implications, starting with the forward direction.
\[ P \text{ Orthogonal Project} \implies \| P \|_{2} = 1 \]
</p>

<p>
Suppose \( P \) is Orthogonal, note that this means that \( P \) is Hermitian. 
</p>

<p>
Consider the norm of an arbitrary vector \( v \). 
</p>
\begin{align}
\| Pv \|_{2}^{2}
&= \left\langle Pv , Pv \right\rangle \tag{Def. Norm} \\
&= \left\langle v , P^{\ast} Pv \right\rangle \tag{Adjoint} \\
&= \left\langle v , P Pv \right\rangle \tag{Hypothesis, $P^{\ast}=P$} \\
&= \left\langle v , Pv \right\rangle \tag{$P$ Projector} \\
&\leq \| v \|_{2} \| Pv \|_{2} \tag{Cauchy-Schwarz}
\end{align}

<p>
If \( Pv \neq 0 \) (which we may assume by hypothesis) then we may divide through by its norm,  
\[ \| Pv \|_{2} \leq \| v \|_{2} \]
</p>

<p>
Thus, for all nonzero \( v \) and \( Pv \) we have the relation  
\[ \frac{\| Pv \|_{2}}{\| v \|_{2}} \leq 1 \]
</p>

<p>
So, \( \| P \|_{2} \leq 1 \) 
Hence, \( \| P \|_{2} = 1 \)
</p>

<p>
Now we prove the backwards direction,
\[ \| P \|_{2} = 1 \implies P \text{ Orthogonal Projector} \]
</p>

<p>
We want to show that \( \im(P) \perp \mathcal{N}(P) \). 
</p>

<p>
Take some \( x \in \mathcal{N}(P)^{\perp} \). We will show that \( x \in \im(P) \). \( \mathcal{N}(P)^{\perp} \subseteq \im(P) \). 
</p>

<p>
Note that \( x \perp P(x) - x \) because \( P(Px - x) = PPx - Px = Px - Px = 0 \)  
</p>

<p>
Then
</p>

\begin{align}
\| x \|_{2}^{2}
&\leq \| x \|_{2}^{2} + \| Px - x \|_{2}^{2} \tag{Norm Non-negative} \\ 
&= \| x + Px - x \|_{2}^{2} \tag{$x \perp P(x) - x$} \\ 
&= \| Px \|_{2}^{2} \tag{Simplify} \\ 
&\leq \| x \|_{2}^{2} \tag{$\| P \|_{2} \leq 1$} 
\end{align}

<p>
Thus, all of the inequalities are in fact equalities. We may deduce, \( \|Px - x \| = 0 \). By positive definiteness of the norm this means \( Px - x = 0  \), hence \( Px = x \), thus \( x \in \im(P) \).
</p>

<p>
Now consider \( y \in \im(P) \). We may decompose \( y = u + v \) where \( u \in \mathcal{N}(P) \), \( v \in \mathcal{N}(P)^{\perp} \).
</p>

<p>
\[ y = Py = Pu + Pv = Pv \]
</p>

<p>
By previous work, \( v \in \im(P) \) hence \( y = p \), therefore, \( \im(P) \subseteq \mathcal{N}(P)^{\perp} \).
</p>

<p>
Thus, we have the following,
</p>

<p>
\[ \im(P) \subseteq \mathcal{N}(P)^{\perp} \subseteq \im(P) \]
</p>

<p>
Hence all of the subset relations are equalities.
</p>
</div>
</div>
</div>
<div id="outline-container-orgdf18e6c" class="outline-3">
<h3 id="orgdf18e6c"><span class="section-number-3">2.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org37d2df4" class="outline-4">
<h4 id="org37d2df4"><span class="section-number-4">2.3.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Exercise 7.3
</p>

<p>
Let \( A \) be an \( m \times m \) matrix, and like \( a_{j} \) be its \( j \)-th column.
Give an algebraic proof of <b>Hadamard's Inequality</b>:
</p>

<p>
\[ | \det(A) | \leq \prod_{j = 1}^{m} \| a_{j} \|_{2} \]
</p>

<p>
Also give a geometric interpretation of this result, making use of the fact that the determinant equals the volume of a parallelepiped.
</p>
</div>
</div>
<div id="outline-container-org73a400d" class="outline-4">
<h4 id="org73a400d"><span class="section-number-4">2.3.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Algebraic Solution:
Consider the \( QR \)-factorization: 
</p>

<p>
\[ A = QR \]
</p>

<p>
First, note that \( Q \) has orthonormal columns,
</p>

<p>
\[ Q^{\ast}Q = I \implies \det(Q^{\ast} Q) = 1 \implies \det(Q^{\ast}) \det(Q) = 1 \]
</p>


<p>
Hence,
</p>
\begin{align}
\left| \det(A) \right|
&= \left| \det(QR) \right| \tag{$QR$ Factorization} \\
&= \left| \det(Q) \right| \left| \det(R) \right| \tag{Multiplicativity of Determinant} \\
&= \left| \det(R) \right| \tag{$\det(Q) = \pm 1$} \\
&= \left| \prod_{j = 1}^{m} r_{jj} \right| \tag{$\det$ of Upper Triangular} \\
&= \prod_{j = 1}^{m} \left|r_{jj} \right| \tag{Multiplicativity of Absolute Value} \\
&\leq \prod_{j = 1}^{m} \| r_{j} \|_{\infty} \tag{$r_{jj} \leq \| r_{j} \|_{\infty}$} \\
&\leq \prod_{j = 1}^{m} \| r_{j} \|_{2} \tag{$\infty$-Norm Less Than $2$-Norm} \\
&= \prod_{j = 1}^{m} \| Q r_{j} \|_{2} \tag{$Q$ Invariance Under $2$-Norm} \\
&= \prod_{j = 1}^{m} \| a_{j} \|_{2} \tag{$QR$ Factorization}
\end{align}

<p>
Geometric Solution:
</p>

<p>
The absolute value of the determinant of \( A \)  is the volume of the parallelepiped spanned by the columns of \( A \). If we constrained the columns of \( A \) to be the same size, largest this parallelepiped could be is if the columns were orthogonal. This would result in the volume being (at most) the product of the lengths of the columns. In other words,
</p>

<p>
\[ \left| \det(A) \right| \leq \prod_{j = 1}^{m} \| a_{j} \|_{2} \]
</p>
</div>
</div>
</div>
<div id="outline-container-org41334ef" class="outline-3">
<h3 id="org41334ef"><span class="section-number-3">2.4.</span> Problem 4</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org26d4168" class="outline-4">
<h4 id="org26d4168"><span class="section-number-4">2.4.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
Exercise 10.1
</p>

<p>
Determine the (a) eigenvalues, (b) determinant, and (c) singular values of a Householder reflector. For the eigenvalues, give a geometric arguments as well as an algebraic proof.
</p>
</div>
</div>
<div id="outline-container-org3498d40" class="outline-4">
<h4 id="org3498d40"><span class="section-number-4">2.4.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
The householder reflector is given by:
</p>

<p>
\[ F = I - 2 \frac{vv^{\ast}}{v^{\ast}v} \]
</p>
</div>
<ol class="org-ol">
<li><a id="orgc5c29cc"></a>A<br />
<div class="outline-text-5" id="text-2-4-2-1">
<p>
Eigenvalues,
</p>

\begin{align}
Fv
&= \left( I - 2 \frac{v v^{\ast}}{v^{\ast}v} \right) v \\
&= Iv - 2 \frac{v v^{\ast} v}{v^{\ast}v} \\
&= v - 2 \frac{v (v^{\ast} v)}{v^{\ast}v} \\
&= v - 2 v \\
&= - v 
\end{align}

<p>
Let \( w \) be in the orthogonal complement to \( v \)
</p>

<p>
Then
</p>

\begin{align}
Fw
&= \left( I - 2 \frac{v v^{\ast}}{v^{\ast}v} \right) w \\
&= Iw - 2 \frac{v v^{\ast} w}{v^{\ast}v} \\
&= v - 2 \frac{v (0)}{v^{\ast}v} \\
&= w
\end{align}

<p>
There are \( n - 1 \) orthogonal vectors to \( v \) hence these are all of the (orthogonal) eigenvectors.  
They have eigenvalues \( -1 \) or \( 1 \).
</p>
</div>
</li>
<li><a id="org626017f"></a>B<br />
<div class="outline-text-5" id="text-2-4-2-2">
<p>
The determinant of a matrix is the product of the eigenvalues (accounting for multiplicity).
Hence,
</p>

<p>
\[ \det(F) = (-1)^{1} (1)^{n-1} = -1 \]
</p>
</div>
</li>
<li><a id="org5ecb8b3"></a>C<br />
<div class="outline-text-5" id="text-2-4-2-3">
<p>
The singular values are the square roots of the eigenvalues of \( F F^{\ast} \) or \( F^{\ast}F \)
</p>

<p>
We note that \( F \) is unitary. I do not see a full proof of this fact in the book. I will supply my own.
</p>

\begin{align}
F^{\ast}
&= \left( I - 2 \frac{v v^{\ast}}{v^{\ast}v} \right)^{\ast} \tag{Def $F$} \\
&= I^{\ast} - \left( 2 \frac{v v^{\ast}}{v^{\ast}v} \right)^{\ast} \tag{$\ast$-Conjugate Linear} \\
&= I - \frac{2}{\overline{v^{\ast} v}} ( v v^{\ast} )^{\ast} \tag{$\ast$-Conjugate Linear, $I$ Pos. Symmetric} \\
&= I - \frac{2}{v^{\ast} v} ( v v^{\ast} )^{\ast} \tag{$\left\langle v , v \right\rangle$ Real} \\
&= I - \frac{2}{v^{\ast} v} v^{\ast \ast} v^{\ast} \tag{$\ast$ Swaps order} \\
&= I - \frac{2}{v^{\ast} v} v v^{\ast} \tag{$\ast$ Involution} \\
&= I - 2\frac{v v^{\ast} }{v^{\ast} v} \tag{Associativity of Multiplication} \\
&= F \tag{Def. $F$}
\end{align}

<p>
This means that \( F F^{\ast} = I = F^{\ast} F \), which means that the singular values are \( 1 \).
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org1bbf4e6" class="outline-3">
<h3 id="org1bbf4e6"><span class="section-number-3">2.5.</span> Problem 5</h3>
<div class="outline-text-3" id="text-2-5">
</div>
<div id="outline-container-org57c4734" class="outline-4">
<h4 id="org57c4734"><span class="section-number-4">2.5.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
Exercise 10.2
</p>

<p>
You can start with the code presented in class and build upon it. In part (a), add R = triu(R) to the end of your code to ensure that the subdiagonal entries of R are exactly 0.
</p>
</div>
<ol class="org-ol">
<li><a id="org0e0b206"></a>A<br />
<div class="outline-text-5" id="text-2-5-1-1">
<p>
(a) Write a MATLAB function [W, R] = house(A) that computes an implicit representation of a full QR factorization \( A = QR \) of an \( m \times n \) matrix \( A \) with \( m > n \) using Householder reflections. The output variables are a lower-triangular matrix \( W \in \mathcal{C}^{m \times n} \) whose columns are the vectors \( v_{k} \) defining the successive Householder reflections, and a triangular matrix \( R \in \mathbb{C}^{n \times n} \).
</p>
</div>
</li>
<li><a id="orgea32ab8"></a>B<br />
<div class="outline-text-5" id="text-2-5-1-2">
<p>
(b) Write a MATLAB function Q = formQ(W) that takes the matrix \( W \) produced by house as input and generates a corresponding \( m \times m \) orthogonal matrix \( Q \).
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org6da0a5a" class="outline-4">
<h4 id="org6da0a5a"><span class="section-number-4">2.5.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-5-2">
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>W<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">house</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    W <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n
        x <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">if</span> <span style="color: #000000;">(</span>x<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">&gt;=</span> 0<span style="color: #000000;">)</span>
            sgn <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">else</span>
            sgn <span style="color: #8f0075;">=</span> <span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        v <span style="color: #8f0075;">=</span> sgn<span style="color: #8f0075;">*</span>norm<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>eye<span style="color: #000000;">(</span>m<span style="color: #8f0075;">-</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">+</span>x<span style="color: #8f0075;">;</span>
        v <span style="color: #8f0075;">=</span> v<span style="color: #8f0075;">/</span>norm<span style="color: #000000;">(</span>v<span style="color: #8f0075;">,</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span> 2<span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>v<span style="color: #8f0075;">*</span>v<span style="color: #8f0075;">'</span><span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        W<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> v<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    R <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>1<span style="color: #8f0075;">:</span>n<span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    R <span style="color: #8f0075;">=</span> triu<span style="color: #000000;">(</span>R<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> <span style="color: #595959;">% to spec</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-matlab">function Q = formQ(W)
    [m, ~] = size(W);
    Q = eye(m,m);
    for k = 1:m
        Q(:,k) = formQx(W,Q(:,k));
    end
end 

function y = formQx(W, x)
    [m, n] = size(W);
    for k = n:-1:1
        x(k:m) = x(k:m)-2*W(k:m,k)*(W(k:m,k)'*x(k:m));
    end
    y = x;
end
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org2bf7447" class="outline-3">
<h3 id="org2bf7447"><span class="section-number-3">2.6.</span> Problem 6</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-org0a2a958" class="outline-4">
<h4 id="org0a2a958"><span class="section-number-4">2.6.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-6-1">
<p>
Exercise 10.4.
Consider the \( 2 \times 2 \) orthogonal matrices:
</p>

<p>
\[ F = \begin{bmatrix} -c & s \\ s & c \end{bmatrix}, J = \begin{bmatrix} c & s \\ -s & c \end{bmatrix}  \]
Where \( s = \sin(\theta) \) and \( c = \cos(\theta) \) for some \( \theta \). 
</p>

<p>
The first matrix has \( \det(F) = -1 \) and is a reflector—the special case of a Householder reflector in dimension 2. The second has det J = 1 and effects a rotation instead of a reflection. Such a matrix is called a Givens rotation.
</p>

<p>
For part (b), draw a diagram like (10.1) on p. 70, and code your
algorithm in Matlab. Focus on triangularizing A and returning R (don’t worry about
forming Q).
</p>
</div>
<ol class="org-ol">
<li><a id="orgc49514c"></a>A<br />
<div class="outline-text-5" id="text-2-6-1-1">
<p>
Describe exactly what geometric effects left-multiplications by F and J have on the plane 1R2. (J rotates the plane by the angle \( \theta \), for example, but is the rotation clockwise or counterclockwise?)
</p>
</div>
</li>
<li><a id="org5890dbc"></a>B<br />
<div class="outline-text-5" id="text-2-6-1-2">
<p>
Describe an algorithm for QR factorization that is analogous to Algorithm 10.1 but based on Givens rotations instead of Householder reflections.
</p>
</div>
</li>
<li><a id="orgef20718"></a>C<br />
<div class="outline-text-5" id="text-2-6-1-3">
<p>
Show that your algorithm involves six flops per entry operated on rather than four, so that the asymptotic operation count is 50% greater than (10.9).
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org701e30a" class="outline-4">
<h4 id="org701e30a"><span class="section-number-4">2.6.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-6-2">
</div>
<ol class="org-ol">
<li><a id="org8d53615"></a>A<br />
<div class="outline-text-5" id="text-2-6-2-1">
<p>
We may note that 
\[ \begin{bmatrix} c & -s \\ s & c \end{bmatrix} \]
</p>

<p>
is a counter clockwise rotation. To justify this, write a vector, \( x = \begin{bmatrix} x_{1} \\ x_{2} \end{bmatrix} \) , in polar coordinates, \( \begin{bmatrix} r \cos(\omega) \\ r \sin(\omega) \end{bmatrix} \). The action on this vectors is,
</p>

\begin{align}
\begin{bmatrix} c & -s \\ s & c \end{bmatrix} \begin{bmatrix} r \cos(\omega) \\ r \sin(\omega) \end{bmatrix}
&= \begin{bmatrix} r \cos(\omega) \cos(\theta) - r \sin(\omega) \sin(\theta) \\ r \cos(\omega) \sin(\theta) + r \sin(\omega) \cos(\theta) \end{bmatrix} \tag{Def. Matrix Multiplication} \\
&= \begin{bmatrix} r \cos(\omega + \theta)\\ r \sin(\omega + \theta) \end{bmatrix} \tag{Angle Addition Identities}
\end{align}

<p>
This proves that the vector is rotated counter clockwise by an angle of &theta;.
</p>

<p>
To rotate clockwise by &theta;, we may rotate counter clockwise by \( -\theta \). This results in,
\[ \begin{bmatrix} \cos(-\theta) & -\sin(-\theta) \\ \sin(-\theta) & \cos(-\theta) \end{bmatrix} =\begin{bmatrix} \cos(\theta) & \sin(\theta) \\ -\sin(\theta) & \cos(\theta) \end{bmatrix} = J  \]
</p>

<p>
Using evenness and oddness of \( \cos(\theta) \) and \( \sin(\theta) \) respectively.   
</p>

<p>
Using our discussion of a standard rotation matrix above, we may describe \( F \) and \( J \).
</p>

<p>
We may factor \( F \) in polar form:
\[ F = \begin{bmatrix} -1 & 0 \\ 0 & 1 \end{bmatrix} \begin{bmatrix} c & -s \\ s & c \end{bmatrix}  \]
</p>

<p>
Where the matrix
</p>

<p>
\[ \begin{bmatrix} -1 & 0 \\ 0 & 1 \end{bmatrix} \]
</p>

<p>
Flips the \( i \)-th coordinate of a vector and
</p>

<p>
\[ \begin{bmatrix} c & -s \\ s & c \end{bmatrix} \]
</p>

<p>
is a counter-clockwise rotation matrix.
</p>

<p>
\[ J \]
</p>

<p>
is a clockwise rotation matrix.
</p>
</div>
</li>
<li><a id="org29346b0"></a>B<br />
<div class="outline-text-5" id="text-2-6-2-2">
<p>
(B)
Note that the matrix \( G_{ij}(\theta) \), \( i > j \) defined by picture as,
</p>

\begin{align*}
\begin{bmatrix}
1 & \cdots & 0 & \cdots & 0 & \cdots & 0 \\
\vdots & \ddots & \vdots &  & \vdots & &\vdots \\
0 & \cdots & \cos(\theta) & \cdots & - \sin(\theta) & \cdots & 0 \\ 
\vdots &  & \vdots & \ddots & \vdots & &\vdots \\
0 & \cdots & \sin(\theta) & \cdots & \cos(\theta) & \cdots & 0 \\ 
\vdots & & \vdots &  & \vdots & \ddots & \vdots \\
0 & \cdots & 0 & \cdots & 0 & \cdots & 1 \\ 
\end{bmatrix}
\end{align*}

<p>
with the first non identity column being column \( j \)
</p>

<p>
or piecewise as
</p>

\begin{align}
\left[ G_{ij}(\theta) \right]_{k \ell}
=
\begin{cases}
1 & k = \ell \land k \neq i \land k \neq j \\
\cos(\theta) & k = \ell \land (k = i \lor k = j) \\
-\sin(\theta) & k = j \land \ell = i \\
\sin(\theta) & k = i \land \ell = j \\
0 & \text{else}
\end{cases}
\end{align}

<p>
is a counter clockwise rotation matrix in the \( (i,j) \)-plane. We will then use this rotation to rotate one vectors last nonzero subdiagonal entry to zero. We may work this out by example in the \( 2 \times 2 \) case. 
</p>

<p>
Let \( A \in \mathbb{C}^{2 \times 2} \),
</p>

<p>
\[ A = \begin{bmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{bmatrix} \]
Then we would like to rotate the vector \( \begin{bmatrix} a_{11} \\ a_{21} \end{bmatrix} \) to \( \begin{bmatrix} \sqrt{a^{2}_{11} + a^{2}_{21}} \\ 0 \end{bmatrix} \). We note that the angle formed by \( \begin{bmatrix} a_{11} \\ a_{21} \end{bmatrix} \) has angle \( \theta = \arctan \left( \frac{a_{21}}{a_{11}} \right) \). Hence, we may rotate by \( - \theta \) forming the matrix
</p>

\begin{align*}
\xymatrix{
A \ar[r] & Q_{1} A \ar[r] & Q_{2} Q_{1} A \ar[r] & Q_{3} Q_{2} Q_{1} A \\
*{
\begin{bmatrix}
\times & \times & \times \\
\times & \times & \times \\
\times & \times & \times
\end{bmatrix}} \ar[r] &
*{\begin{bmatrix}
\times & \times & \times \\
\times & \times & \times \\
0 & \times & \times
\end{bmatrix}} \ar[r] &
*{\begin{bmatrix}
\times & \times & \times \\
0 & \times & \times \\
0 & \times & \times
\end{bmatrix}} \ar[r] &
*{\begin{bmatrix}
\times & \times & \times \\
0 & \times & \times \\
0 & 0 & \times
\end{bmatrix}}
}
\end{align*}

<p>
We may describe the algorithm and implement it too:
</p>

<div class="org-src-container">
<pre class="src src-octave"><span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">qrgivens</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
  <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span>n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
  Q <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
  R <span style="color: #8f0075;">=</span> A<span style="color: #8f0075;">;</span>

  <span style="color: #531ab6;">for</span> j <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span>n <span style="color: #595959;">% Starting from the right column</span>
    <span style="color: #531ab6;">for</span> i <span style="color: #8f0075;">=</span> m<span style="color: #8f0075;">:-</span>1<span style="color: #8f0075;">:</span><span style="color: #000000;">(</span>j<span style="color: #8f0075;">+</span>1<span style="color: #000000;">)</span> <span style="color: #595959;">% From the bottom up</span>
      G <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
      <span style="color: #000000;">[</span>c<span style="color: #8f0075;">,</span>s<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> givensrotation<span style="color: #000000;">(</span> R<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span>j<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span>R<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #dd22dd;">)</span> <span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> <span style="color: #595959;">% Calculate the proper Sin / Cos rotation matrix</span>
      G<span style="color: #000000;">(</span><span style="color: #dd22dd;">[</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> i<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">,</span><span style="color: #dd22dd;">[</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> i<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>c <span style="color: #8f0075;">-</span>s<span style="color: #8f0075;">;</span> s c<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
      R <span style="color: #8f0075;">=</span> G<span style="color: #8f0075;">'*</span>R <span style="color: #595959;">% Rotate</span>
      Q <span style="color: #8f0075;">=</span> Q<span style="color: #8f0075;">*</span>G<span style="color: #8f0075;">;</span> <span style="color: #595959;">% Append</span>
    <span style="color: #531ab6;">end</span>
  <span style="color: #531ab6;">end</span>
  R <span style="color: #8f0075;">=</span> triu<span style="color: #000000;">(</span>R<span style="color: #000000;">)</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>c<span style="color: #8f0075;">,</span>s<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">givensrotation</span><span style="color: #000000;">(</span>a<span style="color: #8f0075;">,</span>b<span style="color: #000000;">)</span>
  <span style="color: #531ab6;">if</span> b <span style="color: #8f0075;">==</span> 0
    c <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
    s <span style="color: #8f0075;">=</span> 0<span style="color: #8f0075;">;</span>
  <span style="color: #531ab6;">else</span>
    <span style="color: #531ab6;">if</span> abs<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span> <span style="color: #8f0075;">&gt;</span> abs<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span>
      r <span style="color: #8f0075;">=</span> a <span style="color: #8f0075;">/</span> b<span style="color: #8f0075;">;</span>
      s <span style="color: #8f0075;">=</span> 1 <span style="color: #8f0075;">/</span> sqrt<span style="color: #000000;">(</span>1 <span style="color: #8f0075;">+</span> r<span style="color: #8f0075;">^</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
      c <span style="color: #8f0075;">=</span> s<span style="color: #8f0075;">*</span>r<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">else</span>
      r <span style="color: #8f0075;">=</span> b <span style="color: #8f0075;">/</span> a<span style="color: #8f0075;">;</span>
      c <span style="color: #8f0075;">=</span> 1 <span style="color: #8f0075;">/</span> sqrt<span style="color: #000000;">(</span>1 <span style="color: #8f0075;">+</span> r<span style="color: #8f0075;">^</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
      s <span style="color: #8f0075;">=</span> c<span style="color: #8f0075;">*</span>r<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
  <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>
</div>
</li>
<li><a id="org71bd8a5"></a>C<br />
<div class="outline-text-5" id="text-2-6-2-3">
<p>
We note that the structure of the Givens rotation is similar to that of an identity matrix for all columns \( \neq i,j \). It then rotates one vector only. This means that the computation boils down to a \( 2 \times 2 \) matrix times a \( 2 \times 1 \) vector. This entails \( 6 \) Flops (\( 4 \) multiplications and \( 2 \) additions).
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org3d98a7c" class="outline-3">
<h3 id="org3d98a7c"><span class="section-number-3">2.7.</span> Problem 7</h3>
<div class="outline-text-3" id="text-2-7">
</div>
<div id="outline-container-org0b5cf65" class="outline-4">
<h4 id="org0b5cf65"><span class="section-number-4">2.7.1.</span> Statement</h4>
<div class="outline-text-4" id="text-2-7-1">
<p>
Let \( A \) be given by 
</p>

<div class="org-src-container">
<pre class="src src-matlab">U = qr(rand(30));
V = qr(rand(30));
S = diag(2.^(-1 : -1 : -30));
A = U*S*V’;
</pre>
</div>
</div>
<ol class="org-ol">
<li><a id="org5c260af"></a>A<br />
<div class="outline-text-5" id="text-2-7-1-1">
<p>
In Matlab, calculate the QR factorization of A in three different ways: (i) using
the classical Gram-Schmidt algorithm, (ii) using the modified Gram-Schmidt algorithm, and (iii) using Householder reflectors. For (i) and (ii), you may use the code presented in class. For (iii), use your code from Exercise 10.2.
</p>
</div>
</li>
<li><a id="orge54981d"></a>B<br />
<div class="outline-text-5" id="text-2-7-1-2">
<p>
For each algorithm, calculate \( \| Q^{\ast}Q − I \|_{2} \) and \( \| QR − A\|_{2} \), where \( Q \) and \( R \) are
the computed \( QR \) factors of \( A \). Comment on the results.
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org4773210" class="outline-4">
<h4 id="org4773210"><span class="section-number-4">2.7.2.</span> Solution</h4>
<div class="outline-text-4" id="text-2-7-2">
<p>
Calculate QR in three ways:
</p>

<div class="org-src-container">
<pre class="src src-octave">U <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>rand<span style="color: #dd22dd;">(</span>30<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
V <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>rand<span style="color: #dd22dd;">(</span>30<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
S <span style="color: #8f0075;">=</span> diag<span style="color: #000000;">(</span>2<span style="color: #8f0075;">.^</span><span style="color: #dd22dd;">(</span><span style="color: #8f0075;">-</span>1 <span style="color: #8f0075;">:</span> <span style="color: #8f0075;">-</span>1 <span style="color: #8f0075;">:</span> <span style="color: #8f0075;">-</span>30<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
A <span style="color: #8f0075;">=</span> U<span style="color: #8f0075;">*</span>S<span style="color: #8f0075;">*</span>V<span style="color: #8f0075;">';</span>

<span style="color: #595959;">% </span><span style="color: #595959;">QR factorization methods</span>
<span style="color: #595959;">% </span><span style="color: #595959;">- Classical Gram Schmidt - cgs(A)</span>
disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Classical Gram Schmidt'</span><span style="color: #000000;">)</span>
<span style="color: #000000;">[</span>Q_cgs<span style="color: #8f0075;">,</span> R_cgs<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> cgs<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
operator_errors<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> Q_cgs<span style="color: #8f0075;">,</span> R_cgs<span style="color: #000000;">)</span>


<span style="color: #595959;">% </span><span style="color: #595959;">- Modified Gram Schmidt - mgs(A)</span>
disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Modified Gram Schmidt'</span><span style="color: #000000;">)</span>
<span style="color: #000000;">[</span>Q_mgs<span style="color: #8f0075;">,</span> R_mgs<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> mgs<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
operator_errors<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> Q_mgs<span style="color: #8f0075;">,</span> R_mgs<span style="color: #000000;">)</span>


<span style="color: #595959;">% </span><span style="color: #595959;">- Householder - qrhouse(A)</span>
disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Householder'</span><span style="color: #000000;">)</span>
<span style="color: #000000;">[</span>Q_house<span style="color: #8f0075;">,</span> R_house<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qrhouse<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
operator_errors<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> Q_house<span style="color: #8f0075;">,</span> R_house<span style="color: #000000;">)</span>


<span style="color: #595959;">% </span><span style="color: #595959;">Gram-Schmidt</span>
<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">cgs</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Q <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span> n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    R <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n<span style="color: #8f0075;">,</span> n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    
    <span style="color: #531ab6;">for</span> j<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n
        v <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span> j<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>j<span style="color: #8f0075;">-</span>1
            R<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">=</span>Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span> i<span style="color: #000000;">)</span><span style="color: #8f0075;">'*</span>A<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            v<span style="color: #8f0075;">=</span>v<span style="color: #8f0075;">-</span>R<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>i<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        R<span style="color: #000000;">(</span>j<span style="color: #8f0075;">,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">=</span>norm<span style="color: #000000;">(</span>v<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span> j<span style="color: #000000;">)</span><span style="color: #8f0075;">=</span>v<span style="color: #8f0075;">/</span>R<span style="color: #000000;">(</span>j<span style="color: #8f0075;">,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">% </span><span style="color: #595959;">Modified Gram-Schmidt</span>
<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span>  <span style="color: #721045;">mgs</span><span style="color: #000000;">(</span>X<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span>n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>X<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Q <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    R <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span>n
        Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> X<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">for</span> i <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span>k<span style="color: #8f0075;">-</span>1
            R<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>i<span style="color: #000000;">)</span><span style="color: #8f0075;">'*</span>Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span> R<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>i<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        R<span style="color: #000000;">(</span>k<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>Q<span style="color: #dd22dd;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">';</span>
        Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">/</span>R<span style="color: #000000;">(</span>k<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">% </span><span style="color: #595959;">Householder</span>
<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">qrhouse</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>W<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> house<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Q <span style="color: #8f0075;">=</span> formQ<span style="color: #000000;">(</span>W<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>W<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">house</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    W <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n
        x <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">if</span> <span style="color: #000000;">(</span>x<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">&gt;=</span>0<span style="color: #000000;">)</span>
            sgn <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">else</span>
            sgn <span style="color: #8f0075;">=</span> <span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        v <span style="color: #8f0075;">=</span> sgn<span style="color: #8f0075;">*</span>norm<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>eye<span style="color: #000000;">(</span>m<span style="color: #8f0075;">-</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">+</span>x<span style="color: #8f0075;">;</span>
        v <span style="color: #8f0075;">=</span> v<span style="color: #8f0075;">/</span>norm<span style="color: #000000;">(</span>v<span style="color: #8f0075;">,</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span> 2<span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>v<span style="color: #8f0075;">*</span>v<span style="color: #8f0075;">'</span><span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        W<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> v<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    R <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>1<span style="color: #8f0075;">:</span>n<span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    R <span style="color: #8f0075;">=</span> triu<span style="color: #000000;">(</span>R<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> Q <span style="color: #8f0075;">=</span> <span style="color: #721045;">formQ</span><span style="color: #000000;">(</span>W<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>W<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Q <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span>m
        Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> formQx<span style="color: #000000;">(</span>W<span style="color: #8f0075;">,</span>Q<span style="color: #dd22dd;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span> 

<span style="color: #531ab6;">function</span> y <span style="color: #8f0075;">=</span> <span style="color: #721045;">formQx</span><span style="color: #000000;">(</span>W<span style="color: #8f0075;">,</span> x<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>W<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k <span style="color: #8f0075;">=</span> n<span style="color: #8f0075;">:-</span>1<span style="color: #8f0075;">:</span>1
        x<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> x<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">-</span>2<span style="color: #8f0075;">*</span>W<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>W<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">'*</span>x<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    y <span style="color: #8f0075;">=</span> x<span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">% </span><span style="color: #595959;">Print Error</span>
<span style="color: #531ab6;">function</span> <span style="color: #721045;">operator_errors</span><span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> Q<span style="color: #8f0075;">,</span> R<span style="color: #000000;">)</span>
    disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Deviation from Orthogonality'</span><span style="color: #000000;">)</span>
    norm<span style="color: #000000;">(</span>Q<span style="color: #8f0075;">'*</span>Q <span style="color: #8f0075;">-</span> eye<span style="color: #dd22dd;">(</span>size<span style="color: #008899;">(</span>Q<span style="color: #008899;">)</span><span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> 2<span style="color: #000000;">)</span>

    disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Deviation from A'</span><span style="color: #000000;">)</span>
    norm<span style="color: #000000;">(</span>Q<span style="color: #8f0075;">*</span>R <span style="color: #8f0075;">-</span> A<span style="color: #8f0075;">,</span> 2<span style="color: #000000;">)</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">Classical Gram Schmidt
Deviation from Orthogonality

ans <span style="color: #8f0075;">=</span>

   1.3955e<span style="color: #8f0075;">-</span>13

Deviation from A

ans <span style="color: #8f0075;">=</span>

   2.8006e<span style="color: #8f0075;">-</span>17

Modified Gram Schmidt
Deviation from Orthogonality

ans <span style="color: #8f0075;">=</span>

   8.0129e<span style="color: #8f0075;">-</span>15

Deviation from A

ans <span style="color: #8f0075;">=</span>

   3.0018e<span style="color: #8f0075;">-</span>17

Householder
Deviation from Orthogonality

ans <span style="color: #8f0075;">=</span>

   1.3418e<span style="color: #8f0075;">-</span>15

Deviation from A

ans <span style="color: #8f0075;">=</span>

   3.7101e<span style="color: #8f0075;">-</span>15
</pre>
</div>

<p>
We note that the two Gram-Schmidt methods have roughly the same \( QR \) representations of \( A \). They out perform Householder on the QR approximation to A. The correctness of orthogonality is: Classical Gram Schmidt is less orthogonal than Modified Gram Schmidt which is also less orthogonal than Householder.  
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org90d44b2" class="outline-2">
<h2 id="org90d44b2"><span class="section-number-2">3.</span> <span class="done DONE">DONE</span> Homework 3</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orga8a32bd" class="outline-3">
<h3 id="orga8a32bd"><span class="section-number-3">3.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org8d1f0cb" class="outline-4">
<h4 id="org8d1f0cb"><span class="section-number-4">3.1.1.</span> Statement</h4>
<div class="outline-text-4" id="text-3-1-1">
</div>
<ol class="org-ol">
<li><a id="org5179755"></a>A<br />
<div class="outline-text-5" id="text-3-1-1-1">
<p>
Calculate (by hand) the best linear approximation \( y(t) = \alpha_{0} + \alpha_{1}t \) (in the least squares sense) of the data:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">t</th>
<th scope="col" class="org-right">y</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">5</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><a id="orgdaedcb4"></a>B<br />
<div class="outline-text-5" id="text-3-1-1-2">
<p>
Calculate (in Matlab) the best degree-12 polynomial approximation \( y(t) = \alpha_{0} + a_{1}t + \cdots + \alpha_{12}t^{12} \) of the data \( \{ (k / 100, e^{k/100}) \vert k = 1, 2, \ldots, 100 \} \). Compute the answer in two different ways:
</p>

<ol class="org-ol">
<li>Via the normal equations</li>

<li>Via the QR factorization. (Use Matlab's <code>qr</code> function)</li>
</ol>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgd86712a" class="outline-4">
<h4 id="orgd86712a"><span class="section-number-4">3.1.2.</span> Solution</h4>
<div class="outline-text-4" id="text-3-1-2">
</div>
<ol class="org-ol">
<li><a id="org6432201"></a>A<br />
<div class="outline-text-5" id="text-3-1-2-1">
<p>
From the data, we may organize input matrix \( A \) and outputs \( b \), 
</p>

<p>
\[ A = \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{bmatrix}, b = \begin{bmatrix} 1 \\ 4 \\ 2 \\ 5 \end{bmatrix} \]
We may find \( \alpha_{0} \) and \( \alpha_{1} \) by matrix multiplication:
</p>

\begin{align}
\begin{bmatrix} \alpha_{0} \\ \alpha_{1} \end{bmatrix}
&= (A^T A)^{-1} A^T b \tag{Normal Equations} \\
&= \left(\begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{bmatrix}^T \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{bmatrix}\right)^{-1} \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{bmatrix}^T \begin{bmatrix} 1 \\ 4 \\ 2 \\ 5 \end{bmatrix} \tag{Substitution} \\
&= \left(\begin{bmatrix} 4 & 10 \\ 10 & 30 \end{bmatrix} \right)^{-1} \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{bmatrix}^T \begin{bmatrix} 1 \\ 4 \\ 2 \\ 5 \end{bmatrix} \tag{Multiplication} \\
&= \frac{1}{20} \begin{bmatrix} 30 & -10 \\ -10 & 4 \end{bmatrix} \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \\ 1 & 4 \end{bmatrix}^T \begin{bmatrix} 1 \\ 4 \\ 2 \\ 5 \end{bmatrix} \tag{Inverse} \\
&= \frac{1}{20} \begin{bmatrix} 30 & -10 \\ -10 & 4 \end{bmatrix} \begin{bmatrix} 12 \\ 35 \end{bmatrix} \tag{Multiply Data} \\
&= \frac{1}{20} \begin{bmatrix} 10 \\ 20 \end{bmatrix} \tag{Multiplication} \\
&= \begin{bmatrix} 0.5 \\ 1 \end{bmatrix} \tag{Multiplication}
\end{align}
</div>
</li>
<li><a id="org407bcf8"></a>B<br />
<div class="outline-text-5" id="text-3-1-2-2">
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #595959;">% </span><span style="color: #595959;">Construct Data</span>
X <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>100<span style="color: #8f0075;">,</span> 12<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
y <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>100<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

<span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>100
    <span style="color: #531ab6;">for</span> j<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>13
        X<span style="color: #000000;">(</span>k<span style="color: #8f0075;">,</span> j<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>k <span style="color: #8f0075;">/</span> 100<span style="color: #000000;">)</span><span style="color: #8f0075;">^</span><span style="color: #000000;">(</span>j<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    y<span style="color: #000000;">(</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> exp<span style="color: #000000;">(</span>k <span style="color: #8f0075;">/</span> 100<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">% </span><span style="color: #595959;">Normal Equations</span>

alpha_normal <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>X<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> X<span style="color: #000000;">)</span> <span style="color: #8f0075;">\</span> <span style="color: #000000;">(</span>X<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> y<span style="color: #000000;">)</span> <span style="color: #595959;">%(X' * y) \ (X' * X)</span>
display<span style="color: #000000;">(</span><span style="color: #3548cf;">'Mean Squared Error Using These Alpha'</span><span style="color: #000000;">)</span>
mse<span style="color: #000000;">(</span>X <span style="color: #8f0075;">*</span> alpha_normal <span style="color: #8f0075;">-</span> y<span style="color: #000000;">)</span>

<span style="color: #595959;">% </span><span style="color: #595959;">QR Factorization</span>

<span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>X<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
alpha_qr <span style="color: #8f0075;">=</span> R <span style="color: #8f0075;">\</span> <span style="color: #000000;">(</span>Q<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> y<span style="color: #000000;">)</span>
display<span style="color: #000000;">(</span><span style="color: #3548cf;">'Mean Squared Error Using These Alpha'</span><span style="color: #000000;">)</span>
mse<span style="color: #000000;">(</span>X <span style="color: #8f0075;">*</span> alpha_qr <span style="color: #8f0075;">-</span> y<span style="color: #000000;">)</span>

<span style="color: #595959;">% </span><span style="color: #595959;">Expected Result (Taylor Series of e^x)</span>
alpha_expected <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>13<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">for</span> j<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>13
    alpha_expected<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 1 <span style="color: #8f0075;">/</span> factorial<span style="color: #000000;">(</span>j<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

alpha_expected
display<span style="color: #000000;">(</span><span style="color: #3548cf;">'Mean Squared Error Using These Alpha'</span><span style="color: #000000;">)</span>
mse<span style="color: #000000;">(</span>X <span style="color: #8f0075;">*</span> alpha_expected <span style="color: #8f0075;">-</span> y<span style="color: #000000;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">Warning<span style="color: #8f0075;">:</span> Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND <span style="color: #8f0075;">=</span>
3.270421e<span style="color: #8f0075;">-</span>20. 

alpha_normal <span style="color: #8f0075;">=</span>

    1.0000
    0.9998
    0.5054
    0.0832
    0.7604
   <span style="color: #8f0075;">-</span>3.7823
   12.9609
  <span style="color: #8f0075;">-</span>29.5915
   45.5234
  <span style="color: #8f0075;">-</span>46.5836
   30.3865
  <span style="color: #8f0075;">-</span>11.4309
    1.8870

Mean Squared Error Using These Alpha

ans <span style="color: #8f0075;">=</span>

   1.8269e<span style="color: #8f0075;">-</span>14


alpha_qr <span style="color: #8f0075;">=</span>

    1.0000
    1.0000
    0.5000
    0.1667
    0.0417
    0.0083
    0.0014
    0.0002
    0.0000
    0.0000
    0.0000
    0.0000
    0.0000

Mean Squared Error Using These Alpha

ans <span style="color: #8f0075;">=</span>

   5.4826e<span style="color: #8f0075;">-</span>31


alpha_expected <span style="color: #8f0075;">=</span>

    1.0000
    1.0000
    0.5000
    0.1667
    0.0417
    0.0083
    0.0014
    0.0002
    0.0000
    0.0000
    0.0000
    0.0000
    0.0000

Mean Squared Error Using These Alpha

ans <span style="color: #8f0075;">=</span>

   1.2569e<span style="color: #8f0075;">-</span>21
</pre>
</div>

<p>
We see that the QR factorization performs the best on this dataset. This is expected, the QR factorization is intended to minimize the squared error. QR performs better than the Taylor coefficients in terms of MSE. Perhaps as one shrinks the domain the Taylor coefficients get better and better. Both methods performed better than solving the normal equations. That was to be expected as the condition number of the normal equations is on the order of the square of the condition number of the input matrix. 
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org5989bad" class="outline-3">
<h3 id="org5989bad"><span class="section-number-3">3.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org1cf6095" class="outline-4">
<h4 id="org1cf6095"><span class="section-number-4">3.2.1.</span> Statement</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Let \( A \in \mathbb{C}^{m \times m} \) be invertible. Let \( x,b \in \mathbb{C}^{m} \) satisfy \( Ax = b \).
Find a matrix, \( \delta A \in \mathbb{C}^{m \times m} \) (depending on \( A \) and \( x \)) with the property that,
</p>

<p>
\[ \frac{\| \delta x \|_{2} / \| x \|_{2}}{\| \delta A \|_{2} / \| A \|_{2}} = \kappa_{2}(A) = \| A \|_{2} \| A^{-1} \|_{2} \]
</p>

<p>
Where \( \delta x \in \mathbb{C}^{m} \) satisfies \( (A + \delta A)(x + \delta x) = b \) to leading order (i.e. \( Ax + (\delta A) x + A (\delta x) = b \)). You may use the fact that \( \| u v^{\ast} \|_{2} = \| u \|_{2} \| v \|_{2} \) for every \( u,v \in \mathbb{C}^{m} \).  
</p>
</div>
</div>
<div id="outline-container-org301d16f" class="outline-4">
<h4 id="org301d16f"><span class="section-number-4">3.2.2.</span> Problem</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
Let \( A \in \mathbb{C}^{m \times m} \) be an invertible matrix with \( x,b \) satisfying \( Ax = b \).   
</p>

<p>
We may manipulate the leading order solution:
</p>

\begin{align}
&&Ax + (\delta A) x + A (\delta x) &= b \tag{$\delta x$ Satisfies Leading Order} \\
&\implies &(\delta A) x + A (\delta x) &= 0 \tag{$A x = b$} \\
&\implies &A^{-1} (\delta A) x + (\delta x) &= 0 \tag{$A$ Invertible} \\
&\implies &- A^{-1} (\delta A) x &= \delta x \tag{Move $\delta x$}
\end{align}

<p>
Let \( \delta A = u_{m} x^{\ast} \) where \( u_{m} \) is the left singular value of \( A \) corresponding to the smallest singular value.   
</p>


\begin{align}
\frac{\| \delta x \|_{2} / \| x \|_{2}}{\| \delta A \|_{2} / \| A \|_{2}}
&= \frac{\|- A^{-1} u_{m} x^{\ast} x \|_{2} / \| x \|_{2}}{\| u_{m} x^{\ast} \|_{2} / \| A \|_{2}} \tag{Previous} \\
&= | x^{\ast} x| \frac{\| A^{-1} u_{m}  \|_{2} / \| x \|_{2}}{\| u_{m} \|_{2} \| x \|_{2} / \| A \|_{2}} \tag{Homogeneity and Hint} \\
&= | x^{\ast} x| \frac{\| \sigma_{m}^{-1} v_{m}  \|_{2} / \| x \|_{2}}{\| u_{m} \|_{2} \| x \|_{2} / \| A \|_{2}} \tag{Property of SVD} \\
&= | x^{\ast} x| \frac{ | \sigma_{m}^{-1} | / \| x \|_{2}}{ \| x \|_{2} / \| A \|_{2}} \tag{$u_{i}, v_{i}$ Unit Vector} \\
&=  \frac{ | \sigma_{m}^{-1} | }{1 / \| A \|_{2}} \tag{Simplify Norms $\left\langle x,x \right\rangle = \| x\|^{2}$} \\
&=  \frac{\sigma_{1}}{\sigma_{m}} \tag{Formula for $2$-Norm} \\
&=  \kappa_{2}(A) \tag{Condition Number in $2$-Norm}
\end{align}

<p>
This choice of \( \delta A \) could use more motivation. In the following I will justify how one may arrive at such an \( \delta A \).  
</p>

<p>
We may apply the norm to \( \delta x \),
</p>

\begin{align}
\| \delta x \|
&= \| - A^{-1} (\delta A) x \| \tag{Above} \\
&= \| A^{-1} (\delta A) x \| \tag{Homogenaity} \\
&\leq \| A^{-1} \| \| (\delta A) x \| \tag{Submultiplicativity} \\
&\leq \| A^{-1} \| \| (\delta A) \| \| x \| \tag{Submultiplicativity}
\end{align}

<p>
Note that the inequalities are introduced using submultiplicativity. We will return to these steps.
</p>

<p>
From here we may symbol push,
</p>

\begin{align}
&& \| \delta x \| &\leq \| A^{-1} \| \| \delta A \| \| x \| \tag{Above} \\
&\implies & \frac{\| \delta x \|}{\| x \|} &\leq \| A^{-1} \| \| \delta A \| \tag{Divide by $\| x \|$} \\
&\implies & \frac{1}{\| \delta A \|} \frac{\| \delta x \|}{\| x \|} &\leq \| A^{-1} \| \tag{Divide by $\| \delta A \|$} \\
&\implies & \frac{\| A \|}{\| \delta A \|} \frac{\| \delta x \|}{\| x \|} &\leq \| A \| \| A^{-1} \| \tag{Multiply by $\| A \|$} \\
&\implies &\frac{\| \delta x \|_{2} / \| x \|_{2}}{\| \delta A \|_{2} / \| A \|_{2}} &\leq \kappa_{2}(A) = \| A \|_{2} \| A^{-1} \|_{2} \tag{Def. $\kappa$}
\end{align}

<p>
We may note that this is one direction of the inequality of the problem statement. While this has not constructed a \( \delta A \), it helps give motivation. We return to the steps in which the inequalities were introduced. If we construct \( \delta A \) such that both applications of submultiplicativity are equalities then we are done. Hence we want,
</p>

<p>
\[ \| A^{-1} \delta A x \| = \| A^{-1} \| \| \delta A x \| \]
</p>

<p>
This holds (because we are in the \( 2 \)-Norm) when \( \delta A x \) is a right singular vector of \( A^{-1} = V \Sigma^{-1} U^{\ast} \). Hence, \( \delta A x = u_{i} \) for some \( i \) (we will pick this later).
</p>

<p>
We also want,
</p>

<p>
\[ \| \delta A x \| = \| \delta A \| \| x \| \]
</p>

<p>
This happens (again) when \( x \) is a right singular vector of \( \delta A \). Hence we may consider the outer product,
</p>

<p>
\[ \delta A = u_{i} x^{\ast} \]
</p>

<p>
Now, let us plug in our candidate:
</p>

\begin{align}
\frac{\| \delta x \|_{2} / \| x \|_{2}}{\| \delta A \|_{2} / \| A \|_{2}}
&= \frac{\| A^{-1} u_{i} x^{\ast} x \|_{2} / \| x \|_{2}}{\| u_{i} x^{\ast} \|_{2} / \| A \|_{2}} \tag{Previous} \\
&= | x^{\ast} x| \frac{\| A^{-1} u_{i}  \|_{2} / \| x \|_{2}}{\| u_{i} \|_{2} \| x \|_{2} / \| A \|_{2}} \tag{Homogeneity and Hint} \\
&= | x^{\ast} x| \frac{\| \sigma_{i}^{-1} v_{i}  \|_{2} / \| x \|_{2}}{\| u_{i} \|_{2} \| x \|_{2} / \| A \|_{2}} \tag{Property of SVD} \\
&= | x^{\ast} x| \frac{ | \sigma_{i}^{-1} | / \| x \|_{2}}{ \| x \|_{2} / \| A \|_{2}} \tag{$u_{i}, v_{i}$ Unit Vector} \\
&=  \frac{ | \sigma_{i}^{-1} | }{1 / \| A \|_{2}} \tag{Simplify Norms $\left\langle x,x \right\rangle = \| x\|^{2}$} \\
&=  \frac{\sigma_{1}}{\sigma_{i}} \tag{Formula for $2$-Norm}
\end{align}

<p>
From here it is now clear that \( i \) should be the index of the smallest singular value. Because \( A \) is invertible this means \( i = m \).   
</p>
</div>
</div>
</div>
<div id="outline-container-orgb69cba1" class="outline-3">
<h3 id="orgb69cba1"><span class="section-number-3">3.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-3-3">
</div>
<div id="outline-container-org77cdc33" class="outline-4">
<h4 id="org77cdc33"><span class="section-number-4">3.3.1.</span> Statement</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
Let &mu; be a small positive number, and let
</p>

<p>
\[ A = \begin{bmatrix} 1 & 1 & 1 \\ \mu & 0 & 0 \\ 0 & \mu & 0 \\ 0 & 0 & \mu \end{bmatrix} \]
</p>

<p>
Carry out the following calculations by hand, but always round \( 1 + \mu^{2} \) to \( 1 \) in your calculations.  
</p>
</div>
<ol class="org-ol">
<li><a id="org5ff2040"></a>A<br />
<div class="outline-text-5" id="text-3-3-1-1">
<p>
Calculate an (almost) orthonormal basis \( \{ q_{1}, q_{2}, q_{3} \} \) for \( \mathcal{R}(A) \) using classical Gram-Schmidt orthogonalization.  
</p>
</div>
</li>
<li><a id="orgc3f9dcd"></a>B<br />
<div class="outline-text-5" id="text-3-3-1-2">
<p>
Calculate an (almost) orthonormal basis \( \{ q_{1}, q_{2}, q_{3} \} \) for \( \mathcal{R}(A) \) using modified Gram-Schmidt orthogonalization.
</p>

<p>
In each item above, calculate \( q_{1}^{\ast}q_{2}, q_{1}^{\ast}q_{3} \), and \( q_{2}^{\ast}q_{3} \).  
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org070049e" class="outline-4">
<h4 id="org070049e"><span class="section-number-4">3.3.2.</span> Problem</h4>
<div class="outline-text-4" id="text-3-3-2">
</div>
<ol class="org-ol">
<li><a id="orgcc628d3"></a>A<br />
<div class="outline-text-5" id="text-3-3-2-1">
<p>
I will call the vector output from GS prior to normalization \( q_{i} \). Then I will normalize it by denoting \( \hat{q}_{i} \) as the unit vector in the same direction.
</p>


\begin{align}
q_{1}
&= \frac{\begin{bmatrix} 1 \\ \mu \\ 0 \\ 0 \end{bmatrix}}{\sqrt{1 + \mu^2}} \tag{GS} \\
&= \frac{\begin{bmatrix} 1 \\ \mu \\ 0 \\ 0 \end{bmatrix}}{\sqrt{1}} \tag{Rounding} \\
&= \begin{bmatrix} 1 \\ \mu \\ 0 \\ 0 \end{bmatrix} \tag{Simplify}
\end{align}

<p>
Then,
</p>
\begin{align}
q_{2}
&= \frac{\begin{bmatrix} 1 \\ 0 \\ \mu \\ 0 \end{bmatrix} - \begin{bmatrix} 1 \\ \mu \\ 0 \\ 0 \end{bmatrix}}{\sqrt{2 \mu^2}} \tag{GS} \\
&= \frac{\begin{bmatrix} 0 \\ \mu \\ -\mu \\ 0 \end{bmatrix}}{\sqrt{2} \mu} \tag{Simplify} \\
&= \begin{bmatrix} 0 \\ \frac{\sqrt{2}}{2} \\ -\frac{\sqrt{2}}{2} \\ 0 \end{bmatrix} \tag{Simplify}
\end{align}

\begin{align}
q_{3}
&= \frac{\begin{bmatrix} 1 \\ 0 \\ 0 \\ \mu \end{bmatrix} - \frac{1}{1 + \mu^2} \begin{bmatrix} 1 \\ \mu \\ 0 \\ 0 \end{bmatrix} - \frac{1}{1 + \mu^2} \begin{bmatrix} 1 \\ 0 \\ \mu \\ 0 \end{bmatrix}}{\sqrt{1 + \mu^2}} \tag{GS} \\
&= \frac{\begin{bmatrix} 1 \\ 0 \\ 0 \\ \mu \end{bmatrix} - \begin{bmatrix} 1 \\ \mu \\ 0 \\ 0 \end{bmatrix} - \begin{bmatrix} 1 \\ 0 \\ \mu \\ 0 \end{bmatrix}}{\sqrt{1 + \mu^2 + \mu^2 + \mu^2}} \tag{Rounding} \\
&= \frac{\begin{bmatrix} 1 \\ - \mu \\ -\mu \\ \mu \end{bmatrix}}{\sqrt{1}} \tag{Rounding} \\
&= \begin{bmatrix} 1 \\ -\mu \\ -\mu \\ \mu \end{bmatrix} \tag{Simplify}
\end{align}

<p>
The inner products:
</p>

<p>
\[ q_{1}^{\ast}q_{2} = \mu \frac{\sqrt{2}}{2} \]
</p>

<p>
\[ q_{1}^{\ast}q_{3} = 1 - \mu^{2}  \]
</p>

<p>
\[ q_{2}^{\ast}q_{3} = 0 \]
</p>
</div>
</li>
<li><a id="orgf420fa6"></a>B<br />
<div class="outline-text-5" id="text-3-3-2-2">
<p>
Modified Gram Schmidt:
</p>

<p>
First for loop, \( i = 1..n \) 
</p>

<p>
\[ v_{1} = a_{1}, v_{2} = a_{2}, v_{3} = a_{3} \]
</p>

<p>
Next for loop, \( i = 1 \):
</p>

<p>
\[ r_{11} = \| v_{1} \| = \sqrt{1 + \mu^{2}} = 1 \]
</p>

<p>
\[ q_{1} = v_{1} / 1 = v_{1} \]
</p>

<p>
Inner loop \( j = 2 \):
</p>

<p>
\[ r_{12} = q_{1}^{\ast} v_{2} = 1 \]
</p>

<p>
\[ v_{2} = v_{2} - r_{12} q_{1} = a_{2} - q_{1} = \begin{bmatrix} 0 \\ -\mu \\ \mu \\ 0 \end{bmatrix} \]
Inner loop \( j = 3 \)
</p>

<p>
\[ r_{13} = q_{1}^{\ast} v_{3} = 1 \]
</p>

<p>
\[ v_{3} = v_{3} - r_{13}q_{1} = a_{3} - q_{1} = \begin{bmatrix} 0 \\ -\mu \\ 0 \\ \mu \end{bmatrix}  \]
</p>

<p>
Outer loop \( i = 2 \)
</p>

<p>
\[ r_{22} = \| v_{2} \| = \sqrt{2 \mu^{2}} = \mu \sqrt{2} \]
</p>

<p>
\[ q_{2} = v_{2} / r_{22} = \begin{bmatrix} 0 \\ - \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2} \\ 0 \end{bmatrix} \]
</p>

<p>
Inner loop \( j = 3 \)
</p>

<p>
\[ r_{23} = q_{2}^{\ast} v_{3} = \frac{\mu \sqrt{2}}{2} \]
</p>

<p>
\[ v_{3} = v_{3} - r_{23} q_{2} = \begin{bmatrix} 0 \\ - \frac{1}{2} \mu \\ - \frac{1}{2} \mu \\ \mu \end{bmatrix} \]
</p>

<p>
Outer loop \( i = 3 \)
</p>

<p>
\[ r_{33} = \sqrt{ \frac{3}{2} \mu^{2}} = \mu\sqrt{\frac{3}{2}} \]
</p>

<p>
\[ q_{3} = v_{3} / r_{33} = \begin{bmatrix} 0 \\ - \frac{1}{2} \sqrt{\frac{2}{3}} \\ - \frac{1}{2} \sqrt{\frac{2}{3}} \\ \sqrt{\frac{2}{3}} \end{bmatrix} \]
The inner products:
</p>

<p>
\[ q_{1}^{\ast}q_{2} = -\mu \frac{\sqrt{2}}{2} \]
</p>

<p>
\[ q_{1}^{\ast}q_{3} = -\mu \frac{1}{2} \sqrt{\frac{2}{3}}  \]
</p>

<p>
\[ q_{2}^{\ast}q_{3} = 0 \]
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgf1d3a4f" class="outline-3">
<h3 id="orgf1d3a4f"><span class="section-number-3">3.4.</span> Problem 4</h3>
<div class="outline-text-3" id="text-3-4">
</div>
<div id="outline-container-org808896c" class="outline-4">
<h4 id="org808896c"><span class="section-number-4">3.4.1.</span> Statement</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
Exercise 15.1 (a,b,c,d).
Note that in the problem statements, \( x \oplus x, x \otimes x \), etc. should really be \( \fl(x) \oplus \fl(x), \fl(x) \otimes \fl(x) \), etc.
</p>
</div>
<ol class="org-ol">
<li><a id="org47bf88b"></a>A<br />
<div class="outline-text-5" id="text-3-4-1-1">
\begin{align}
f &\colon x \mapsto 2x \tag{Problem} \\
\tilde{f} &\colon x \mapsto \fl(x) \oplus \fl(x) \tag{Algorithm}
\end{align}
</div>
</li>
<li><a id="org5c46128"></a>B<br />
<div class="outline-text-5" id="text-3-4-1-2">
\begin{align}
f &\colon x \mapsto x^{2} \tag{Problem} \\
\tilde{f} &\colon x \mapsto \fl(x) \otimes \fl(x) \tag{Algorithm}
\end{align}
</div>
</li>
<li><a id="org5217fbf"></a>C<br />
<div class="outline-text-5" id="text-3-4-1-3">
\begin{align}
f &\colon x \mapsto 1 \tag{Problem} \\
\tilde{f} &\colon x \mapsto \fl(x) \odiv \fl(x) \tag{Algorithm}
\end{align}
</div>
</li>
<li><a id="org5b91c01"></a>D<br />
<div class="outline-text-5" id="text-3-4-1-4">
\begin{align}
f &\colon x \mapsto 0 \tag{Problem} \\
\tilde{f} &\colon x \mapsto \fl(x) \ominus \fl(x) \tag{Algorithm}
\end{align}
</div>
</li>
</ol>
</div>
<div id="outline-container-org794ae68" class="outline-4">
<h4 id="org794ae68"><span class="section-number-4">3.4.2.</span> Problem</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
Two useful lemmas:
</p>

<div class="LEMMA" id="orgfd8e3b7">
<p>
\[(1 + O(\varepsilon_{\text{machine}}))^{2} = (1 + O(\varepsilon_{\text{machine}}))\]
</p>

</div>

<p>
If \( f \in (1 + O(\varepsilon_{\text{machine}}))^{2} \), then
</p>

\begin{align}
\| f(\varepsilon_{\text{machine}}) \|
&\leq (1 + C_{1} \varepsilon_{\text{machine}}) (1 + C_{2} \varepsilon_{\text{machine}}) \tag{Def. Big O} \\
&= 1 + C_{1} \varepsilon_{\text{machine}} + C_{2} \varepsilon_{\text{machine}} + C_{1} C_{2} \varepsilon_{\text{machine}}^{2} \tag{Distribute} \\
&< 1 + C_{1} \varepsilon_{\text{machine}} + C_{2} \varepsilon_{\text{machine}} + C_{1} C_{2} \varepsilon_{\text{machine}} \tag{$\varepsilon_{\text{machine}} < 1 \implies \varepsilon_{\text{machine}}^{2} < \varepsilon_{\text{machine}}$} \\
&= 1 + (C_{1} + C_{2} + C_{1}C_{2}) \varepsilon_{\text{machine}} \tag{Factor} \\
&= 1 + O(\varepsilon_{\text{machine}}) \tag{Def. Big O}
\end{align}

<div class="LEMMA" id="org1490168">
<p>
\[\sqrt{1 + O(\varepsilon_{\text{machine}})} = (1 + O(\varepsilon_{\text{machine}}))\]
</p>

</div>

\begin{align}
\| f(\varepsilon_{\text{machine}}) \|
&\leq \sqrt{1 + C \varepsilon_{\text{machine}}} \tag{Def. Big O} \\
&\leq \sqrt{1 + 2 C \varepsilon_{\text{machine}} + C^{2} \varepsilon_{\text{machine}}^{2}} \tag{$C, \varepsilon > 0$} \\
&= \sqrt{(1 + C \varepsilon_{\text{machine}} )^{2}} \tag{Factor} \\
&= 1 + C \varepsilon_{\text{machine}} \tag{Positive Value Under Square Root}
\end{align}
</div>
<ol class="org-ol">
<li><a id="org43d00fc"></a>A<br />
<div class="outline-text-5" id="text-3-4-2-1">
\begin{align}
\tilde{f}(x)
&= \fl(x) \oplus \fl(x) \tag{Algorithm} \\
&= (\fl(x) + \fl(x)) (1 + \varepsilon_{2}) \tag{Fundamental Axiom $\oplus$} \\
&= (x(1 + \varepsilon_{1}) + x(1 + \varepsilon_{1})) (1 + \varepsilon_{2}) \tag{Floating Point Projection} \\
&= (x + x) (1 + \varepsilon_{1})(1 + \varepsilon_{2}) \tag{Factor Error} \\
&= (2x) (1 + \varepsilon_{1})(1 + \varepsilon_{2}) \tag{Simplify} \\
&= (2x) (1 + \varepsilon_{3}) \tag{Lemma} \\
&= 2 (x (1 + \varepsilon_{3})) \tag{Associativity} \\
&= f(\tilde{x}) \tag{Perturbation}
\end{align}

<p>
Hence addition of a number by itself is backwards stable.
</p>
</div>
</li>
<li><a id="org7c9bf82"></a>B<br />
<div class="outline-text-5" id="text-3-4-2-2">
\begin{align}
\tilde{f}(x)
&= \fl(x) \otimes \fl(x) \tag{Algorithm} \\
&= (\fl(x) \cdot \fl(x))(1 + \varepsilon_{1}) \tag{Fundamental Axiom $\otimes$} \\
&= (x(1 + \varepsilon_{2}) \cdot x(1 + \varepsilon_{2}))(1 + \varepsilon_{1}) \tag{Floating Point Projection} \\
&= (x \cdot x)(1 + \varepsilon_{2})^{2}(1 + \varepsilon_{1}) \tag{Commutativity} \\
&= (x \cdot x)(1 + \varepsilon_{3}) \tag{Lemma} \\
&= (x \cdot x)(1 + \varepsilon_{4})(1 + \varepsilon_{4}) \tag{Lemma} \\
&= (x(1 + \varepsilon_{4}) \cdot x(1 + \varepsilon_{4})) \tag{Commutativity} \\
&= f(\tilde{x}) \tag{Problem}
\end{align}
<p>
Hence, squaring a number is backwards stable.
</p>
</div>
</li>
<li><a id="org5bb0444"></a>C<br />
<div class="outline-text-5" id="text-3-4-2-3">
\begin{align}
\tilde{f}(x)
&= \fl(x) \odiv \fl(x) \tag{Algorithm} \\
&= \frac{\fl(x)}{\fl(x)} (1 + \varepsilon_{1}) \tag{Fundamental Axiom $\odiv$} \\
&= \frac{x(1 + \varepsilon_{2})}{x(1 + \varepsilon_{2})} (1 + \varepsilon_{1}) \tag{Floating Point Projection} \\
&= (1 + \varepsilon_{1}) \tag{Simplify}
\end{align}

<p>
However, this is not \( f(y) \) for any \( y \) (nearby or otherwise). Hence, this shows that the algorithm is not backwards stable.
</p>

<p>
We may show stability:
</p>

\begin{align}
\frac{\| \tilde{f}(x) - f(\tilde{x}) \|}{\| f(\tilde{x}) \|}
&= \frac{\| 1 + \varepsilon_{1} - 1 \|}{\| 1 \|} \tag{Def. $f,\tilde{f}$} \\
&= \| \varepsilon_{1}  \| \tag{Simplify}
\end{align}

<p>
Hence, \( \tilde{f} \) is stable but not backwards stable.
</p>
</div>
</li>
<li><a id="org153dff8"></a>D<br />
<div class="outline-text-5" id="text-3-4-2-4">
\begin{align}
\tilde{f}(x)
&= \fl(x) \ominus \fl(x) \tag{Algorithm} \\
&= (\fl(x) - \fl(x))(1 + \varepsilon_{1}) \tag{Fundamental Axiom $\ominus$} \\
&= 0 \tag{Simplify} \\
&= f(\tilde{x}) \tag{Problem}
\end{align}

<p>
Hence subtraction is backwards stable.
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org82a1534" class="outline-3">
<h3 id="org82a1534"><span class="section-number-3">3.5.</span> Problem 5</h3>
<div class="outline-text-3" id="text-3-5">
</div>
<div id="outline-container-org67130e5" class="outline-4">
<h4 id="org67130e5"><span class="section-number-4">3.5.1.</span> Statement</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
Exercise 16.1(a).
</p>

<p>
Let \( Q \in \mathbb{C}^{m \times m} \) be a unitary matrix, \( A \in \mathbb{C}^{m \times n} \). Show that computing
</p>

<p>
\[ B = QA \]
</p>

<p>
is backwards stable.
</p>

<p>
Do only the case \( k = 1 \).
You may use the fact that in floating point arithmetic, the inner product \( c = x \cdot y \) of two vectors x and y is computed in a backward stable way:
The computed inner product \( \tilde{c} \)  satisfies
</p>

<p>
\[ \tilde{c} = x^{\ast}(y + \delta y), \frac{\| \delta y \|}{\| y \|} = O(\varepsilon_{\text{machine}}) \]
</p>
</div>
</div>
<div id="outline-container-org3414bea" class="outline-4">
<h4 id="org3414bea"><span class="section-number-4">3.5.2.</span> Problem</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
We want to show that the following problem and algorithm, is backwards stable. That is, \( \tilde{f}(x) = f(\tilde{x}) \).
</p>

\begin{align}
f &\colon A \mapsto QA \tag{Problem} \\
\tilde{f} &\colon \fl(A) \mapsto Q \otimes \fl(A) \tag{Algorithm}
\end{align}

<p>
Do note the lack of \( \fl(Q) \) in the algorithm. I am assuming we have some perfect representation of \( Q \) due to the quote "\( Q_{j} \) are fixed and not to be perturbed".
</p>

<p>
We begin with manipulating the definition of backwards stability, and show an error estimate of an easier matrix multiplication.
</p>

<p>
Firstly, we want to show backwards stability, which means we want,
</p>

<p>
\[ \tilde{f}(A) = Q \otimes \fl(A) = Q \cdot \tilde{A} = f(\tilde{A}) \]
</p>

<p>
Where
</p>

<p>
\[ \frac{\| \tilde{A} - A \|}{\| A \|} = O(\varepsilon_{\text{machine}}) \]
</p>

<p>
We may focus on the deviation of the nearby input \( \tilde{A} - A = \delta A \), and restate the problem according to \( \delta A \).
</p>

<p>
The backwards stability condition becomes
</p>

<p>
\[ Q \otimes \fl(A) = Q \cdot (A + \delta A) \]
</p>

<p>
The relative error statement becomes,   
</p>

<p>
\[ \frac{\| \delta A \|}{\| A \|} = O(\varepsilon_{\text{machine}}) \implies \| \delta A \| = \| A \| O(\varepsilon_{\text{machine}}) \]
</p>

<p>
By the invariance of norm, we may use the Frobenius norm for all of the following. 
</p>

<p>
Solving for \( \delta A \) yields,
</p>

\begin{align}
Q \otimes \fl(A) &= Q \cdot (A + \delta A) \tag{Backwards Stability} \\
Q \otimes \fl(A) - Q \cdot A &= Q \cdot \delta A \tag{Multiply and Subtract} \\
Q^{\ast} \cdot Q \otimes \fl(A) - Q^{\ast} \cdot Q \cdot A &= \delta A \tag{$Q$ Unitary} \\
Q^{\ast} \cdot Q \otimes \fl(A) - A &= \delta A \tag{$Q$ Unitary}
\end{align}

<p>
Hence,
</p>

\begin{align}
\| \delta A \|
&= \| Q^{\ast} \cdot Q \otimes \fl(A) - A \| \tag{Above} \\
&= \| Q \cdot (Q^{\ast} \cdot Q \otimes \fl(A) - A) \| \tag{Unitary Matrix Invariance of F-Norm} \\
&= \| Q \cdot Q^{\ast} \cdot Q \otimes \fl(A) - Q \cdot A \| \tag{Multiply} \\
&= \| Q \otimes \fl(A) - Q \cdot A \| \tag{$Q$ Unitary}
\end{align}

<p>
It remains to show that,
</p>

<p>
\[ \| Q \otimes \fl(A) - Q \cdot A \| = \| A \| O(\varepsilon_{\text{machine}}) \]
</p>

<p>
We note that, \( [QA]_{ij} \) is an inner product \( Q_{i,:} A_{:,j} \) which we have proven to be backwards stable. Hence
</p>

<p>
\[ \| \left[ Q \otimes \fl(A) \right]_{ij} - \left[ Q \cdot A \right]_{ij} \| = \| Q \cdot A \| O(\kappa \varepsilon_{\text{machine}}) \]
</p>

<p>
Where \( \kappa \) is the condition number of taking an inner product. We note (12.9) that we have a formula
</p>

<p>
\[ \kappa = \frac{\| Q_{i,\colon} \| \| A_{\colon,j} \|}{\| Q_{i, \colon} A_{\colon, j} \| } \]
</p>

<p>
In the case of the Frobenius norm, this makes \( \kappa = | \cos(\theta) | \) where \( \theta \) is the angle between the two vectors. We note that this is always less than \( 1 \). By using unitary invariance of norm and the condition number, we may simplify,
</p>

<p>
\[ \| \left[ Q \otimes \fl(A) \right]_{ij} - \left[ Q \cdot A \right]_{ij} \| = \| A \| O( \varepsilon_{\text{machine}}) \]
</p>

<p>
Now that we have a bound on the error of each term we may get a bound on the error the two matrices,
</p>

\begin{align}
\| Q \otimes \fl(A) - Q \cdot A \|
&= \sqrt{\sum_{i,j} \left( \left[ Q \otimes \fl(A) \right]_{ij} - \left[ Q \cdot A \right]_{ij} \right)^{2}}  \tag{Def. F-Norm} \\
&\leq \sqrt{\sum_{i,j} \left( C_{ij} \|A \| \varepsilon_{\text{machine}} \right)^{2}}  \tag{Accuracy Calculation} \\
&\leq \sqrt{\sum_{i,j} \left( (\max_{ij} C_{ij}) \|A \| \varepsilon_{\text{machine}} \right)^{2}}  \tag{Take Max Constant} \\
&= \sqrt{m^{2} \left( (\max_{ij} C_{ij}) \|A \| \varepsilon_{\text{machine}} \right)^{2}}  \tag{Sum over Constants} \\
&= m (\max_{ij} C_{ij}) \|A \| \varepsilon_{\text{machine}}  \tag{Simplify} \\
&= \| A \| O(\varepsilon_{\text{machine}}) \tag{Def. Big O}
\end{align}

<p>
This proves the problem. 
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org4b6b382" class="outline-2">
<h2 id="org4b6b382"><span class="section-number-2">4.</span> <span class="done DONE">DONE</span> Homework 4</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org57108c7" class="outline-3">
<h3 id="org57108c7"><span class="section-number-3">4.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org6f97a91" class="outline-4">
<h4 id="org6f97a91"><span class="section-number-4">4.1.1.</span> Statement</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
Exercise 20.4
</p>

<p>
Like most of the algorithms in this book, Gaussian elimination involves a triply nested loop. In Algorithm 20.1, there are two explicit <code>for</code> loops, and the third loop is implicit in the vectors \( u_{j,k:m} \) and \( u_{k,k:m} \). Rewrite this algorithm with just one explicit <code>for</code> loop indexed by \( k \). Inside this loop, \( U \) will be updated at each step by a certain rank-one outer product. This outer product form of Gaussian elimination may be a better starting point than Algorithm 20.1 if one wants to optimize computer performance.
</p>
</div>
</div>
<div id="outline-container-orgff16578" class="outline-4">
<h4 id="orgff16578"><span class="section-number-4">4.1.2.</span> Solution</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
Assuming familiarity with MATLAB, describing the algorithm and its implementation are one and the same. We test our algorithm on the example given in the book.
</p>

<div class="org-src-container">
<pre class="src src-octave">A <span style="color: #8f0075;">=</span> randi<span style="color: #000000;">(</span><span style="color: #dd22dd;">[</span>1 10<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">,</span> <span style="color: #dd22dd;">[</span>4 6<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

A <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span><span style="color: #dd22dd;">[</span>2<span style="color: #8f0075;">,</span>1<span style="color: #8f0075;">,</span>1<span style="color: #8f0075;">,</span>0<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">;</span>
     <span style="color: #dd22dd;">[</span>4<span style="color: #8f0075;">,</span>3<span style="color: #8f0075;">,</span>3<span style="color: #8f0075;">,</span>1<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">;</span>
     <span style="color: #dd22dd;">[</span>8<span style="color: #8f0075;">,</span>7<span style="color: #8f0075;">,</span>9<span style="color: #8f0075;">,</span>5<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">;</span>
     <span style="color: #dd22dd;">[</span>6<span style="color: #8f0075;">,</span>7<span style="color: #8f0075;">,</span>9<span style="color: #8f0075;">,</span>8<span style="color: #dd22dd;">]</span><span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>

<span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

<span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">-</span>1
    A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">*</span> <span style="color: #000000;">(</span>A<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">:</span>n<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">/</span> A<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">,</span>k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> 
<span style="color: #531ab6;">end</span>

A
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">A <span style="color: #8f0075;">=</span>

     2     1     1     0
     0     1     1     1
     0     0     2     2
     0     0     0     2
</pre>
</div>

<p>
Recall that an outer product can be viewed in two ways,
</p>

<p>
\[ \begin{bmatrix} v_{1}^{\ast} u & \cdots & v_{n}^{\ast} u \end{bmatrix} = u v^\ast = \begin{bmatrix} u_{1} v^{\ast} \\ \vdots \\ u_{m} v^{\ast} \end{bmatrix} \]
</p>

<p>
In Gaussian elimination we use row \( k \) to eliminate rows \( k+1 \) to \( m \). This makes the most relevant formulation of inner product is to multiply row \( k \) by a sequence of the "right" multipliers \( \mu \).
</p>

<p>
\[ \mu A_{k, k:n} \]
</p>

<p>
We normalize the row to have \( 1 \) on the diagonal entry, then multiply by the lower rows entry and subtract to get zero. This (naively) assumes nonzero entries on the diagonal. Hence,
</p>

<p>
\[ \mu = A_{k+1:m, k} / A_{kk} \]
</p>
</div>
</div>
</div>
<div id="outline-container-org146d414" class="outline-3">
<h3 id="org146d414"><span class="section-number-3">4.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org03bdeea" class="outline-4">
<h4 id="org03bdeea"><span class="section-number-4">4.2.1.</span> Statement</h4>
<div class="outline-text-4" id="text-4-2-1">
</div>
<ol class="org-ol">
<li><a id="org9973fe8"></a>A<br />
<div class="outline-text-5" id="text-4-2-1-1">
<p>
Determine, to leading order in \( m \), the number of floating point operations needed to solve a linear system \( Rx = b \) with \( R \in \mathbb{C}^{m \times m} \) upper triangular and nonsingular. What is the cost if there exists \( k \) such that \( b_{i} = 0 \) for every \( i = k + 1, k+2, \ldots, m \)?      
</p>
</div>
</li>
<li><a id="org4b97306"></a>B<br />
<div class="outline-text-5" id="text-4-2-1-2">
<p>
Exercise 21.4(a)
</p>
</div>
</li>
<li><a id="org8fe3f59"></a>C<br />
<div class="outline-text-5" id="text-4-2-1-3">
<p>
Exercise 21.4(b)
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org60beec7" class="outline-4">
<h4 id="org60beec7"><span class="section-number-4">4.2.2.</span> Solution</h4>
<div class="outline-text-4" id="text-4-2-2">
</div>
<ol class="org-ol">
<li><a id="org0b31e6b"></a>A<br />
<div class="outline-text-5" id="text-4-2-2-1">
<p>
To solve an upper triangular system We may perform back substitution,
</p>

<p>
\[ x_{m} = \frac{b_{m}}{r_{mm}}, x_{i} = \frac{b_{i} - \sum_{j = i + 1}^{m} r_{ij} x_{j}}{r_{ii}} \]
</p>

<p>
Per \( x_{i} \) we need to do:
</p>

<ul class="org-ul">
<li>\( m - i \) Subtractions</li>
<li>\( m - i \) Multiplications</li>
<li>\( 1 \) Division</li>
</ul>

<p>
In total this amounts to:
</p>

<p>
\[ \sum_{i = 1}^{m} 2m - 2i + 1 = 2m^{2} - 2\left( \sum_{i = 1}^{m} i \right) + m = 2m^{2} - (m^{2} + m) + m = m^{2} \]
</p>

<p>
To leading order this is \( m^{2} \). If there is a \( k \) such that \( \forall i > k \colon b_{i} = 0 \) we can effectively "start" the algorithm at \( k \) leading to \( k^{2} \) flops. Formally, we may partition the system,
</p>

\begin{align}
Rx &= b \\
\begin{bmatrix} U & N_{1} \\ 0 & N_{2} \end{bmatrix} \begin{bmatrix} x_{1:k} \\ x_{k+1:m} \end{bmatrix} &= \begin{bmatrix} b_{1:k} \\ 0 \end{bmatrix}
\end{align}

<p>
Which tells us that,
\[ N_{2} x_{k+1:m} = 0 \]
</p>

<p>
Hence \( x_{k+1:m} = 0 \) using nonsingularity. Hence the top partition tells us,
</p>

<p>
\[ U x_{1:k} + N_{1} x_{k+1:m} = b_{1:k} \iff U x_{1:k} = b_{1:k} \]
</p>

<p>
Which is an upper triangular system with \( k \) rows. Thus \( k^{2} \) flops.  
</p>
</div>
</li>
<li><a id="org293d5bf"></a>B<br />
<div class="outline-text-5" id="text-4-2-2-2">
<p>
To describe a matrix entails describing its action on each basis vector, that is,
</p>

\begin{align}
A A^{-1} &= I \\
\begin{bmatrix} A A^{-1} e_{1} & \cdots & A A^{-1} e_{n} \end{bmatrix} &= \begin{bmatrix} e_{1} & \cdots & e_{n} \end{bmatrix} \\
A \begin{bmatrix} A^{-1} e_{1} & \cdots & A^{-1} e_{n} \end{bmatrix} &= \begin{bmatrix} e_{1} & \cdots & e_{n} \end{bmatrix}
\end{align}


<p>
Hence, solving, \( Ax_{i} = e_{i} \) gives the \( i \)-th column of \( A^{-1} \). We may solve this system via \( LU \) decomposition. This is not solving \( A x_{i} = e_{i} \) \( m \) times via \( LU \) (\( \frac{4}{3} m^{4} \) flops). We reduce the operation count by only calculating \( LU \) once for \( A \).       
</p>

<ol class="org-ol">
<li>Calculate \( A = LU \) which takes \( \frac{2}{3} m^{3} \) flops</li>

<li>Solve the lower triangular system \( Ly = e_{i} \) (\( m^{2} \) flops) and the upper triangular system \( U x = y \) (\( m^{2} \) flops). This means for every \( i \) there is \( 2m^{2} \) operations. Hence \( 2m^{3} \) for the solution steps.</li>
</ol>

<p>
In total this is \( \frac{2}{3} m^{3} + 2m^{3} = \frac{8}{3} m^{3} \) flops.            
</p>
</div>
</li>
<li><a id="orge061278"></a>C<br />
<div class="outline-text-5" id="text-4-2-2-3">
<p>
In the algorithm for part \( B \) we may leverage the fact that the flop count for solving \( Ly = e_{i} \) is \( i^{2} \) flops instead of \( m^{2} \). Hence the total flop count is
</p>

<p>
\[ \frac{2}{3} m^{3} + \sum_{i = 1}^{m} (i^{2} + m^{2}) = \frac{5}{3} m^{3} + \frac{(n)(n+1)(2n + 1)}{6} \simeq \frac{5}{3} m^{3} + \frac{1}{3} m^{3} = 2 m^{3} \]
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orga9190b8" class="outline-3">
<h3 id="orga9190b8"><span class="section-number-3">4.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-4-3">
</div>
<div id="outline-container-org900f318" class="outline-4">
<h4 id="org900f318"><span class="section-number-4">4.3.1.</span> Statement</h4>
<div class="outline-text-4" id="text-4-3-1">
</div>
<ol class="org-ol">
<li><a id="org95f181d"></a>A<br />
<div class="outline-text-5" id="text-4-3-1-1">
<p>
Show that if \( A,B \in \mathbb{C}^{m \times m} \) are upper triangular, then so are \( AB \) and \( A^{-1} \) (assuming \( A^{-1} \) exists).    
</p>
</div>
</li>
<li><a id="org39150d1"></a>B<br />
<div class="outline-text-5" id="text-4-3-1-2">
<p>
Show that if \( A,B \in \mathbb{C}^{m \times m} \) are unit lower triangular, then so are \( AB \) and \( A^{-1} \) (assuming \( A^{-1} \) exists).    
</p>
</div>
</li>
<li><a id="org07275a3"></a>C<br />
<div class="outline-text-5" id="text-4-3-1-3">
<p>
Use parts (a) and (b) to show that if \( A \in C^{m \times m} \) is nonsingular and has an \( LU \) factorization \( A = LU \) then this factorization is unique.   
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org2b09538" class="outline-4">
<h4 id="org2b09538"><span class="section-number-4">4.3.2.</span> Solution</h4>
<div class="outline-text-4" id="text-4-3-2">
</div>
<ol class="org-ol">
<li><a id="org465fc4a"></a>A<br />
<div class="outline-text-5" id="text-4-3-2-1">
<p>
If \( A \) is upper triangular then \( Ae_{i} = \sum_{j = 1}^{i} A_{ij}e_{j} \), hence,
</p>

<p>
\[ \im(\spn(\{e_{i}\}_{j = 1}^{i})) \subseteq \spn(\{e_{i}\}_{j = 1}^{i}) \]
</p>

<p>
Hence the composition of two operators whose image is a subset of \( \spn(\{e_{i}\}_{j = 1}^{i}) \) will also be a subset of \( \spn(\{e_{i}\}_{j = 1}^{i}) \). In other words the product of upper triangular matrices are upper triangular. It is convenient now to figure out the diagonal entry of the product,
</p>

<p>
\[ ABe_{i} = A \sum_{j= 1}^{i} B_{ij}e_{j} = \sum_{j= 1}^{i} B_{ij} A e_{j} = \sum_{j=1}^{i} B_{ij} \sum_{k = 1}^{j} A_{jk}e_{k} = \sum_{j=1}^{i} \sum_{k=1}^{j} A_{jk}B_{ij} e_{k} \] 
</p>

<p>
Note, there is only one term with \( e_{i} \). It is when \( j = i \) and the coefficient is \( A_{ii}B_{ii} \).
</p>

<p>
If \( A \) is invertible, then it does not include zero as an eigenvector. This means that its characteristic polynomial includes a nonzero constant term.
</p>

<p>
By Cayley Hamilton,
</p>

<p>
\[ 0 = p(A) = \sum_{i = 0}^{m} a_{i} A^{i} = a_{0} I + a_{1} A + \cdots + a_{n} A^{n} \] 
</p>

<p>
Hence,
</p>

<p>
\[ I = A \cdot \left(\frac{-1}{a_{0}}  \sum_{i = 1}^{n} a_{i} A^{i - 1} \right) \]
</p>

<p>
In other words, the inverse of \( A \) is represented by a polynomial of \( A \). For upper triangular matrices which are closed under sums (apparent) and powers (just proven), this polynomial of \( A \) is also upper triangular. Hence the inverse of an upper triangular matrix is also upper triangular. 
</p>

<p>
For little tangible benefit, I would like to outline another proof method. Upper triangular matrices can be expressed as \( U = D + N \) where you may separate the diagonal part and the other upper triangular part with zeros along the diagonal. Because \( U \) is assumed to be invertible, the diagonal part contains no zeros and we may factor \( U = D(I + D^{-1}N) \). We note that \( N \) is upper triangular with zeros along the diagonal hence its characteristic polynomial is \( x^{m} \) and by Cayley Hamilton we have \( N^{m} = 0 \). There is a nice formula for the inverse of the identity plus a nilpotent matrix with nilpotent index \( k \), 
</p>

<p>
\[ (I + \overline{N})^{-1} = \sum_{i = 0}^{k} (-\overline{N})^{i} \]
</p>

<p>
Some extra properties can be gleaned from this decomposition (called the Jordan–Chevalley decomposition) like commutativity of \( D \) and \( N \) as well as uniqueness.
</p>
</div>
</li>
<li><a id="orgcf32f69"></a>B<br />
<div class="outline-text-5" id="text-4-3-2-2">
<p>
Suppose that \( A \) and \( B \) are lower triangular matrices. Then
</p>

\begin{align}
AB
&= (AB)^{\ast \ast} \tag{Property of Conjugate Transpose} \\
&= (B^{\ast} A^{\ast})^{\ast} \tag{Property of Conjugate Transpose}
\end{align}

<p>
Where the rightmost product \( B^{\ast}A^{\ast} \) is the product of two upper triangular matrices. We know this to be upper triangular by part \( A \). Hence \( (B^{\ast}A^{\ast})^{\ast} \) is lower triangular. The diagonal entry will be the product of the two diagonal entries of the corresponding matrices by part \( A \) as well. Because \( A \) and \( B \) are unit triangular we see that the diagonal is also unit.   
</p>
</div>
</li>
<li><a id="orgfa9aef1"></a>C<br />
<div class="outline-text-5" id="text-4-3-2-3">
<p>
Suppose a matrix \( A \) is invertible consider two \( LU \) factorizations, \( A = LU = L' U' \).
</p>


<p>
By multiplicativity of determinants we see that all these factors are invertible because \( A \) is invertible. 
</p>

<p>
\[ 0 \neq \det(A) = \det(L) \det(U) = \det(L') \det(U') \]
</p>


\begin{align}
&&LU &= L' U' \tag{Two Factorizations} \\
&\implies & U U'^{-1} &= L^{-1} L' \tag{$L, U'$ Invertible}
\end{align}

<p>
We note then that by part A, the LHS is upper triangular and by part B the RHS is unit lower triangular. Hence, it is diagonal with ones along the diagonal. Thus both sides are equal to the identity. Hence,
</p>

<p>
\[ U U'^{-1} = I \iff U = U' \]
</p>

<p>
\[ L^{-1} L' = I \iff L = L' \]
</p>

<p>
Hence the factorization is unique.
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgcf56185" class="outline-3">
<h3 id="orgcf56185"><span class="section-number-3">4.4.</span> Problem 4</h3>
<div class="outline-text-3" id="text-4-4">
</div>
<div id="outline-container-org4e049f1" class="outline-4">
<h4 id="org4e049f1"><span class="section-number-4">4.4.1.</span> Statement</h4>
<div class="outline-text-4" id="text-4-4-1">
<p>
Exercise 23.2
</p>

<p>
Using the proof of 16.2 as a guide, derive Theorem 23.3 (solving positive definite \(Ax = b\) is backward stable) from Theorems 23.2 (Cholesky Factorization is backward stable) and 17.1 (Solving triangular systems are backward stable).
</p>
</div>
</div>
<div id="outline-container-org5248673" class="outline-4">
<h4 id="org5248673"><span class="section-number-4">4.4.2.</span> Solution</h4>
<div class="outline-text-4" id="text-4-4-2">
<p>
To solve the system,
</p>

<p>
\[ Ax = R^{\ast}R x = b \]
</p>

<p>
We may instead solve
</p>

\begin{align}
\begin{cases}
R^{\ast} y = b \\
R x = y \\
\end{cases}
\end{align}

<p>
These are two triangular systems of which we know the computation for the solution is backward stable. We also know that the calculation of Cholesky factorization is backward stable. We may leverage these two facts to arrive at the solution. For the proof, I will use \( \varepsilon_{\text{machine}} = \varepsilon_{\text{m}} \). I needed to shorten some of the expressions.
</p>

<p>
From theorem \( 23.2 \) we have an approximate Cholesky factorization,
</p>

<p>
\[ \tilde{R}^{\ast}\tilde{R} = A + \delta A, \frac{\| \delta A \| }{\| A \|} = O(\emac) \]
From theorem \( 17.1 \) we have approximate \( \tilde{x}, \tilde{y} \) solutions to the nearby upper triangular problem \( R + \delta R \),  
</p>

\begin{align}
(R^{\ast} + \delta R^{\ast}) \tilde{y} &= b \\
(R + \delta R)\tilde{x} &= \tilde{y}
\end{align}


\begin{align}
b 
&= (R^{\ast} + \delta R^{\ast})(R + \delta R)\tilde{x} \tag{Substitution} \\
&= (R^{\ast}R + R^{\ast} \delta R + \delta R^{\ast} R + \delta R^{\ast} \delta R)\tilde{x} \tag{Multiplication} \\
&= (A + \delta A + R^{\ast} \delta R + \delta R^{\ast} R + \delta R^{\ast} \delta R)\tilde{x} \tag{Theorem 23.2}
\end{align}

<p>
Let \( \Delta A = \delta A + R^{\ast} \delta R + \delta R^{\ast} R + \delta R^{\ast} \delta R \) 
</p>


\begin{align}
\| \Delta A \| 
&= \| \delta A + R^{\ast} \delta R + \delta R^{\ast} R + \delta R^{\ast} \delta R \| \tag{Def. $\Delta A$} \\
&\leq \| \delta A \| + \| R^{\ast} \delta R \| + \| \delta R^{\ast} R \| + \| \delta R^{\ast} \delta R \| \tag{Triangle Inequality} \\
&\leq \| \delta A \| + \| R^{\ast} \| \| \delta R \| + \| \delta R^{\ast} \| \| R \| + \| \delta R^{\ast}\| \| \delta R \| \tag{Submultaplicativity} \\
&\leq C_{1} \emac \| A \| + \| R^{\ast} \| \| \delta R \| + \| \delta R^{\ast} \| \| R \| + \| \delta R^{\ast}\| \| \delta R \| \tag{Theorem 23.2} \\
&\leq C_{1} \emac \| A \| + C_{2} \emac \| R^{\ast} \| \| R \| + C_{3} \emac \| R^{\ast} \| \| R \| + C_{4} C_{5} \emac^{2} \| R^{\ast}\| \| R \| \tag{Theorem 17.1} \\
&\leq C_{1} \emac \| A \| + C_{2} \emac \| R^{\ast} \| \| R \| + C_{3} \emac \| R^{\ast} \| \| R \| + C_{4} C_{5} \emac^{2} \| R^{\ast}\| \| R \| \tag{Theorem 17.1} \\
&\leq C_{1} \emac \| A \| + C_{2} \emac \| R^{\ast} \| \| R \| + C_{3} \emac \| R^{\ast} \| \| R \| + C_{4} C_{5} \emac \| R^{\ast}\| \| R \| \tag{$\emac < 1$} \\
&\leq C_{1} \emac \| R^{\ast} \| \| R \| + C_{2} \emac \| R^{\ast} \| \| R \| + C_{3} \emac \| R^{\ast} \| \| R \| + C_{4} C_{5} \emac \| R^{\ast}\| \| R \| \tag{Submultiplicativity} \\
&\leq (C_{1} + C_{2} + C_{3} + C_{4} + C_{4}C_{5}) \emac \| R^{\ast} \| \| R \| \tag{Factor}
\end{align}
<p>
Hence,
</p>

\begin{align}
\Delta A
&\leq C \emac \| \tilde{R}^{\ast} \| \| \tilde{R} \| \\
&\leq C \emac \| \tilde{R} \|^{2}
\end{align}


<p>
If the SVD of \( A = U \Sigma U^{\ast} \) (recall \( A \) is positive definite) then \( R = U \sqrt{\Sigma} U^{\ast} \). Hence, in the two norm,
</p>

<p>
\[ \Delta A \leq C \emac \| \tilde{R} \|^{2} = C \emac \| A \|  \]
</p>
</div>
</div>
</div>
<div id="outline-container-org13e7adf" class="outline-3">
<h3 id="org13e7adf"><span class="section-number-3">4.5.</span> Problem 5</h3>
<div class="outline-text-3" id="text-4-5">
</div>
<div id="outline-container-org0429b69" class="outline-4">
<h4 id="org0429b69"><span class="section-number-4">4.5.1.</span> Statement</h4>
<div class="outline-text-4" id="text-4-5-1">
</div>
<ol class="org-ol">
<li><a id="org0c1aa8b"></a>A<br />
<div class="outline-text-5" id="text-4-5-1-1">
<p>
Show that if \( A \in \mathbb{C}^{m \times m} \) is Hermitian positive definite and tridiagonal, then the upper triangular matrix \( R \) in its Cholesky factorization satisfies \( R_{ij} = 0 \) for \( |i - j| > 1 \) (which I will call tridiagonal).    
</p>
</div>
</li>
<li><a id="org6711100"></a>B<br />
<div class="outline-text-5" id="text-4-5-1-2">
<p>
Write a Matlab function that computes the Cholesky factor
</p>

\begin{align}
R =
\begin{bmatrix}
y_{1} & z_{1} &&& \\
& y_{2} & z_{2} && \\
&& \ddots & \ddots & \\
&&& y_{m-1} & z_{m-1} \\
&&&& y_{m}
\end{bmatrix}
\end{align}

\begin{align}
A =
\begin{bmatrix}
v_{1} & w_{1} &&& \\
w_{1} & v_{2} & w_{2} && \\
& \ddots & \ddots & \ddots & \\
&& w_{m-2} & v_{m-1} & w_{m-1} \\
&&& w_{m-1} & v_{m}
\end{bmatrix}
\end{align}

<p>
Write your function in such a way that it takes as inputs \( v \in \mathbb{C}^{m} \) and \( w \in \mathbb{C}^{m-1} \), and outputs \( y \in \mathbb{C}^{m} \) and \( z \in \mathbb{C}^{m-1} \), without explicitly forming \( A \) or \( R \).  
</p>
</div>
</li>
<li><a id="org4d5d23a"></a>C<br />
<div class="outline-text-5" id="text-4-5-1-3">
<p>
Apply your function to the vectors
</p>

<div class="org-src-container">
<pre class="src src-octave">v <span style="color: #8f0075;">=</span> 2<span style="color: #8f0075;">*</span>ones<span style="color: #000000;">(</span>10<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span>
w <span style="color: #8f0075;">=</span> <span style="color: #8f0075;">-</span>ones<span style="color: #000000;">(</span>9<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span>
</pre>
</div>

<p>
and report the vectors \( y \) and \( z \) you obtain.
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org8afd44c" class="outline-4">
<h4 id="org8afd44c"><span class="section-number-4">4.5.2.</span> Solution</h4>
<div class="outline-text-4" id="text-4-5-2">
</div>
<ol class="org-ol">
<li><a id="orgf3d9ff8"></a>A<br />
<div class="outline-text-5" id="text-4-5-2-1">
<p>
Let \( A \) be Hermitian positive definite and tridiagonal. Because \( A \) is Hermitian positive definite, we may reuse a lot of the results in the original proof. For example, we will take as known,
</p>

\begin{align}
A
&= \begin{bmatrix} a_{11} & b^{\ast} \\ b & B \end{bmatrix} \tag{Partition into Blocks} \\
&=
\begin{bmatrix} \sqrt{a_{11}} & 0 \\ \frac{b}{\sqrt{a_{11}}} & I \end{bmatrix}
\begin{bmatrix} 1 & 0 \\ 0 & B - \frac{bb^{\ast}}{a_{11}} \end{bmatrix}
\begin{bmatrix} \sqrt{a_{11}} & \frac{b^{\ast}}{\sqrt{a_{11}}} \\ 0 & I \end{bmatrix} \tag{Factorize}
\end{align}

<p>
That \( B - \frac{bb^{\ast}}{a_{11}} \) is Hermitian positive definite.
</p>

<p>
We may proceed by induction.
</p>

<p>
Base Case: \( m = 1 \).
</p>

<p>
Then \( A \in \mathbb{C}^{1 \times 1} \simeq \mathbb{C} \) which has a Cholesky factorization (a square root) which is tridiagonal (vacuously true).
</p>

<p>
Inductive Step: Suppose any tridiagonal Hermitian Positive Definite \( M \in \mathbb{C}^{(m - 1) \times (m - 1)} \) has a tridiagonal Cholesky factorization.
</p>

\begin{align}
A
&= \begin{bmatrix} a_{11} & b^{\ast} \\ b & B \end{bmatrix} \tag{Partition into Blocks} \\
&=
\begin{bmatrix} \sqrt{a_{11}} & 0 \\ \frac{b}{\sqrt{a_{11}}} & I \end{bmatrix}
\begin{bmatrix} 1 & 0 \\ 0 & B - \frac{bb^{\ast}}{a_{11}} \end{bmatrix}
\begin{bmatrix} \sqrt{a_{11}} & \frac{b^{\ast}}{\sqrt{a_{11}}} \\ 0 & I \end{bmatrix} \tag{Factorize}
\end{align}
<p>
Because \( A \) is tridiagonal, we know the form of vector \( b \),  
</p>

<p>
\[ b = \begin{bmatrix} b_{1} \\ 0 \\ \vdots \\ 0 \end{bmatrix} \in \spn(e_1) \]
</p>

<p>
This means that \( bb^{\ast} \) only has one possibly nonzero element in the upper left corner. This makes \( B - \frac{bb^{\ast}}{a_{11}} \) a tridiagonal matrix. By inductive hypothesis, \( B - \frac{bb^{\ast}}{a_{11}} \) has a tridiagonal Cholesky factorization.
</p>

\begin{align}
A
&=
\begin{bmatrix} \sqrt{a_{11}} & 0 \\ \frac{b}{\sqrt{a_{11}}} & I \end{bmatrix}
\begin{bmatrix} 1 & 0 \\ 0 & B - \frac{bb^{\ast}}{a_{11}} \end{bmatrix}
\begin{bmatrix} \sqrt{a_{11}} & \frac{b^{\ast}}{\sqrt{a_{11}}} \\ 0 & I \end{bmatrix} \tag{Factorization} \\
&=
\begin{bmatrix} \sqrt{a_{11}} & 0 \\ \frac{b}{\sqrt{a_{11}}} & I \end{bmatrix}
\begin{bmatrix} 1 & 0 \\ 0 & S^{\ast}S \end{bmatrix}
\begin{bmatrix} \sqrt{a_{11}} & \frac{b^{\ast}}{\sqrt{a_{11}}} \\ 0 & I \end{bmatrix} \tag{Inductive Hypothesis} \\
&=
\begin{bmatrix} \sqrt{a_{11}} & 0 \\ \frac{b}{\sqrt{a_{11}}} & S^{\ast} \end{bmatrix}
\begin{bmatrix} \sqrt{a_{11}} & \frac{b^{\ast}}{\sqrt{a_{11}}} \\ 0 & S \end{bmatrix} \tag{Factor}
\end{align}

<p>
Hence, we see that the Cholesky factor is tridiagonal in the first row and column, and it is tridiagonal in the lower right principal minor matrix.
</p>

<p>
By a previous problem this factorization is unique (assuming nonsingularity, which we have by positive definite assumption as eigenvalues are strictly positive). Hence the original Cholesky factor is tridiagonal too.
</p>
</div>
</li>
<li><a id="org3d61e31"></a>B &amp; C<br />
<div class="outline-text-5" id="text-4-5-2-2">
<div class="org-src-container">
<pre class="src src-octave">v <span style="color: #8f0075;">=</span> 2 <span style="color: #8f0075;">*</span> ones<span style="color: #000000;">(</span>10<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
w <span style="color: #8f0075;">=</span> <span style="color: #8f0075;">-</span> ones<span style="color: #000000;">(</span>9<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

<span style="color: #595959;">% </span><span style="color: #595959;">Double check</span>
A <span style="color: #8f0075;">=</span> diag<span style="color: #000000;">(</span>v<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> diag<span style="color: #000000;">(</span>w<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> diag<span style="color: #000000;">(</span>w<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
chol<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>

<span style="color: #000000;">[</span>y<span style="color: #8f0075;">,</span> z<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> tridiag_cholesky<span style="color: #000000;">(</span>v<span style="color: #8f0075;">,</span> w<span style="color: #000000;">)</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>y<span style="color: #8f0075;">,</span> z<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">tridiag_cholesky</span><span style="color: #000000;">(</span>v<span style="color: #8f0075;">,</span> w<span style="color: #000000;">)</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>v<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    y <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>v<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    z <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>w<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    y<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> sqrt<span style="color: #000000;">(</span>v<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>2<span style="color: #8f0075;">:</span>m
        z<span style="color: #000000;">(</span>i<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> w<span style="color: #000000;">(</span>i<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> y<span style="color: #000000;">(</span>i <span style="color: #8f0075;">-</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        y<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> sqrt<span style="color: #000000;">(</span>v<span style="color: #dd22dd;">(</span>i<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> z<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">-</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">^</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">y <span style="color: #8f0075;">=</span>

    1.4142
    1.2247
    1.1547
    1.1180
    1.0954
    1.0801
    1.0690
    1.0607
    1.0541
    1.0488


z <span style="color: #8f0075;">=</span>

   <span style="color: #8f0075;">-</span>0.7071
   <span style="color: #8f0075;">-</span>0.8165
   <span style="color: #8f0075;">-</span>0.8660
   <span style="color: #8f0075;">-</span>0.8944
   <span style="color: #8f0075;">-</span>0.9129
   <span style="color: #8f0075;">-</span>0.9258
   <span style="color: #8f0075;">-</span>0.9354
   <span style="color: #8f0075;">-</span>0.9428
   <span style="color: #8f0075;">-</span>0.9487
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org5324164" class="outline-3">
<h3 id="org5324164"><span class="section-number-3">4.6.</span> Problem Redo</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Here is the Givens Rotation redo
</p>

<div class="org-src-container">
<pre class="src src-octave">A <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>1<span style="color: #8f0075;">,</span> 2<span style="color: #8f0075;">,</span> 4<span style="color: #8f0075;">,</span> 8<span style="color: #8f0075;">;</span> 
     1<span style="color: #8f0075;">,</span> 3<span style="color: #8f0075;">,</span> 9<span style="color: #8f0075;">,</span> 27<span style="color: #8f0075;">;</span> 
     1<span style="color: #8f0075;">,</span> 4<span style="color: #8f0075;">,</span> 16<span style="color: #8f0075;">,</span> 64<span style="color: #8f0075;">;</span> 
     1<span style="color: #8f0075;">,</span> 5<span style="color: #8f0075;">,</span> 25<span style="color: #8f0075;">,</span> 125<span style="color: #000000;">]</span>
<span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qrgivens<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
Q<span style="color: #8f0075;">*</span>R

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">qrgivens</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
  <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span>n<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
  Q <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
  R <span style="color: #8f0075;">=</span> A<span style="color: #8f0075;">;</span>

  <span style="color: #531ab6;">for</span> j <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span>n
    <span style="color: #531ab6;">for</span> i <span style="color: #8f0075;">=</span> m<span style="color: #8f0075;">:-</span>1<span style="color: #8f0075;">:</span><span style="color: #000000;">(</span>j<span style="color: #8f0075;">+</span>1<span style="color: #000000;">)</span>
      G <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
      c <span style="color: #8f0075;">=</span> cos<span style="color: #000000;">(</span>atan<span style="color: #dd22dd;">(</span>R<span style="color: #008899;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #008899;">)</span> <span style="color: #8f0075;">/</span> R<span style="color: #008899;">(</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span>j<span style="color: #008899;">)</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
      s <span style="color: #8f0075;">=</span> sin<span style="color: #000000;">(</span>atan<span style="color: #dd22dd;">(</span>R<span style="color: #008899;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #008899;">)</span> <span style="color: #8f0075;">/</span> R<span style="color: #008899;">(</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span>j<span style="color: #008899;">)</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
      G<span style="color: #000000;">(</span><span style="color: #dd22dd;">[</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> i<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">,</span><span style="color: #dd22dd;">[</span>i<span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> i<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>c <span style="color: #8f0075;">-</span>s<span style="color: #8f0075;">;</span> s c<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
      R <span style="color: #8f0075;">=</span> G<span style="color: #8f0075;">'*</span>R<span style="color: #8f0075;">;</span>
      Q <span style="color: #8f0075;">=</span> Q<span style="color: #8f0075;">*</span>G<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
  <span style="color: #531ab6;">end</span>
  R <span style="color: #8f0075;">=</span> triu<span style="color: #000000;">(</span>R<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge026920" class="outline-2">
<h2 id="orge026920"><span class="section-number-2">5.</span> <span class="done DONE">DONE</span> Homework 5</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgcb85e58" class="outline-3">
<h3 id="orgcb85e58"><span class="section-number-3">5.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-5-1">
</div>
<div id="outline-container-org162236b" class="outline-4">
<h4 id="org162236b"><span class="section-number-4">5.1.1.</span> Solution</h4>
<div class="outline-text-4" id="text-5-1-1">
</div>
<ol class="org-ol">
<li><a id="orgeac7a1e"></a>A<br />
<div class="outline-text-5" id="text-5-1-1-1">
<p>
Suppose that \( z \) is an eigenvalue of \( A + \delta A \) for some \( \| \delta A \| \leq \varepsilon \) and \( x \) be the corresponding unit eigenvector.
</p>

\begin{align}
&&(A + \delta A) x &= z x \tag{Def. Eigenvector} \\
&\implies&Ax + \delta A x &= zx \tag{Distribute} \\
&\implies&\delta A x &= z x - A x = (z I - A) x \tag{Factor}
\end{align}

<p>
Thus,
</p>

<p>
\[ x = (zI - A)^{-1} \delta A x \]
</p>

<p>
Then,
</p>

\begin{align}
1
&= \| x \| \tag{$x$ Unit vector} \\
&= \| (zI - A)^{-1} \delta A x \| \tag{Above} \\
&\leq \| (zI - A)^{-1} \| \| \delta A \| \| x \| \tag{Submultiplicativity} \\
&= \| (zI - A)^{-1} \| \| \delta A \| \tag{$x$ Unit Vector} \\
&\leq \| (zI - A)^{-1} \| \varepsilon \tag{Hypothesis}
\end{align}

<p>
Thus,
</p>

<p>
\[ \varepsilon^{-1} \leq \| (zI - A)^{-1} \| \]
</p>
</div>
</li>
<li><a id="org884983a"></a>B<br />
<div class="outline-text-5" id="text-5-1-1-2">
<p>
Suppose
</p>

<p>
\[ \| (zI - A)^{-1} \|_{2} \geq \varepsilon^{-1} \]
</p>

<p>
From the SVD, we have a vector \( v \) which maximizes the operator norm. It turns out to be the right singular vector corresponding the least nonzero singular value. This \( v \) satisfies,    
</p>

<p>
\[ \| (z I - A)^{-1} \|_{2} = \frac{\| (zI - A)^{-1} v \|}{\| v \|} \]
</p>

<p>
Call \( (zI - A)^{-1} v = w \). Then \( v = (zI - A)w \).  
</p>

<p>
Inspired by a Goddess, we may multiply by \( 1 \), \( v \frac{w^{\ast} w}{w^{\ast}w} = (zI - A)w \).
</p>

\begin{align}
&&v \frac{w^{\ast} w}{w^{\ast}w} &= (zI - A)w \\
&\iff &0 &= (zI - A)w - v \frac{w^{\ast} w}{w^{\ast}w} \\
&\iff &0 &= \left(zI - A - \frac{vw^{\ast}}{w^{\ast}w}\right) w
\end{align}

<p>
This tells us that \( w \) is an eigenvector of \( A + \frac{vw^{\ast}}{w^{\ast}w} \) with eigenvalue \( z \). Now we may argue that \( \left\| \frac{vw^{\ast}}{w^{\ast}w} \right\| \leq \varepsilon \) 
</p>

\begin{align}
\varepsilon^{-1}
&\leq \| (zI - A)^{-1} \|_{2} \tag{Hypothesis} \\
&= \frac{\| (zI - A)^{-1} v \|_{2}}{\| v \|_{2}} \tag{Def. $v$} \\
&= \frac{\| w \|_{2}}{\| v \|_{2}} \tag{Def. $w$}
\end{align}

<p>
Hence,
</p>

<p>
\[ \frac{\|v \|_{2}}{\| w \|_{2}} \leq \varepsilon \]
</p>

<p>
To conclude,
</p>

\begin{align}
\left\| \frac{vw^{\ast}}{w^{\ast}w} \right\|_{2}
&= \frac{\| v \|_{2} \| w \|_{2}}{\| w \|_{2}^{2}} \tag{Outer Product Norm Theorem} \\
&= \frac{\| v \|_{2}}{\| w \|_{2}} \tag{Simplify} \\
&\leq \varepsilon \tag{Just Proven}
\end{align}
</div>
</li>
<li><a id="org3515c91"></a>C<br />
<div class="outline-text-5" id="text-5-1-1-3">
<p>
Suppose \( A \in \mathbb{C}^{m \times m} \) is diagonalizable, \( A = V \Lambda V^{-1} \), and \( \delta A \in \mathbb{C}^{m \times m} \) be arbitrary.
</p>

<p>
Consider any eigenvalue of \( A + \delta A \), call it \( \tilde{\lambda} \). If \( \tilde{\lambda} \) is an eigenvalue of \( A \) then we are done. If it is not, then \( \tilde{\lambda} I - A \) is invertible. By part A, we have that
</p>



\begin{align} 
\frac{1}{\| \delta A \|_{2}}
&\leq \| (\tilde{\lambda} I - A)^{-1} \|_{2} \tag{Part A} \\
&= \| (\tilde{\lambda} V V^{-1} - V \Lambda V^{-1})^{-1} \|_{2} \tag{$A$ Diagonalizable} \\
&= \| (V (\tilde{\lambda} I  - \Lambda) V^{-1})^{-1} \|_{2} \tag{Matrix Factoring} \\
&= \| (V (\tilde{\lambda} I  - \Lambda)^{-1} V^{-1}) \|_{2} \tag{Inverse of Product} \\
&\leq \| V \|_{2}  \| (\tilde{\lambda} I  - \Lambda)^{-1} \|_{2} \| V^{-1} \|_{2} \tag{Submultiplicativity} \\
&= \kappa(V) \| (\tilde{\lambda} I  - \Lambda)^{-1} \|_{2} \tag{Def. Condition Number}
\end{align}

<p>
We note that \( (\tilde{\lambda}I - \Lambda)^{-1} \) is diagonal hence (by previous homework), \( \| (\tilde{\lambda} I - \Lambda)^{-1} \| = \max_{i} \frac{1}{|\tilde{\lambda} - \lambda_{i} |} \). Thus,
</p>

\begin{align}
\frac{1}{\| \delta A \|_{2}} \leq k(V) \| (\tilde{\lambda} I  - \Lambda)^{-1} \|_{2}
&\iff \frac{1}{\| \delta A \|_{2}} \leq k(V) \max_{i} \frac{1}{|\tilde{\lambda} - \lambda_{i} |} \\
&\iff \max_{i} |\tilde{\lambda} - \lambda_{i} | \leq \kappa(V) \| \delta A \|_{2}
\end{align}

<p>
If \( A \) is normal, \( V \) is unitary, hence \( \kappa(V) = 1 \). By substituting into the previous formula,
</p>

<p>
\[ \max_{i} |\tilde{\lambda} - \lambda_{i} | \leq \kappa(V) \| \delta A \|_{2} \iff \max_{i} |\tilde{\lambda} - \lambda_{i} | \leq \| \delta A \|_{2} \]
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgc28b5ee" class="outline-3">
<h3 id="orgc28b5ee"><span class="section-number-3">5.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-org7fc8e66" class="outline-4">
<h4 id="org7fc8e66"><span class="section-number-4">5.2.1.</span> Solution</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
The Rayleigh quotient
</p>

\begin{align}
\frac{ \partial r}{ \partial x_{i}}
&= \frac{ \partial }{ \partial x_{i}} \frac{x^{\ast}Ax}{x^{\ast}x} \tag{Def. Rayleigh Quotient} \\
&=  \frac{\left[\frac{ \partial }{ \partial x_{i}}(x^{\ast}Ax) \right] (x^{\ast}x) - (x^{\ast}A x) \left[ \frac{ \partial }{ \partial x_{i}} (x^{\ast}x) \right]}{(x^{\ast}x)^{2}} \tag{Quotient Rule} \\
&=  \frac{\left[ \left[ \frac{ \partial }{ \partial x_{i}} x^{\ast} \right] Ax + x^{\ast} \left[ \frac{ \partial }{ \partial x_{i}} Ax \right] \right] (x^{\ast}x) - (x^{\ast}A x) \left[ \left[ \frac{ \partial }{ \partial x_{i}} x^{\ast} \right] x + x^{\ast} \left[ \frac{ \partial }{ \partial x_{i}} x \right] \right]}{(x^{\ast}x)^{2}} \tag{Dot Product Rule} \\
&=  \frac{\left[ \left[ \frac{ \partial }{ \partial x_{i}} x^{\ast} \right] Ax + x^{\ast} A \left[ \frac{ \partial }{ \partial x_{i}} x \right] \right] (x^{\ast}x) - (x^{\ast}A x) \left[ \left[ \frac{ \partial }{ \partial x_{i}} x^{\ast} \right] x + x^{\ast} \left[ \frac{ \partial }{ \partial x_{i}} x \right] \right]}{(x^{\ast}x)^{2}} \tag{$A$ is constant} \\
&=  \frac{\left[  e_{i}^{\ast} Ax + x^{\ast} A e_{i} \right] (x^{\ast}x) - (x^{\ast}A x) \left[ e_{i}^{\ast} x + x^{\ast} e_{i} \right]}{(x^{\ast}x)^{2}} \tag{Evaluate Derivatives} \\
&=  \frac{\left[ (Ax)_{i} + (A^{\ast}x)_{i} \right] (x^{\ast}x) - (x^{\ast}A x) \left[ 2x_{i} \right]}{(x^{\ast}x)^{2}} \tag{Matrix Multiplication}
\end{align}
<p>
Hence if we evaluate the partial derivative at a unit eigenvector \( q_{j} \) we get:
</p>

\begin{align}
\frac{ \partial r}{ \partial x_{i}}(q_{j})
&= \frac{\left[ (A q_{j})_{i} + (A^{\ast} q_{j})_{i} \right] (q_{j}^{\ast}q_{j}) - (q_{j}^{\ast}A q_{j}) \left[ 2(q_{j})_{i} \right]}{(q_{j}^{\ast}q_{j})^{2}} \tag{Substitution} \\
&= \left[ (\lambda_{j} q_{j})_{i} + (A^{\ast} q_{j})_{i} \right] - (q_{j}^{\ast} \lambda_{j} q_{j}) \left[ 2(q_{j})_{i} \right] \tag{Unit Eigenvector} \\
&= \left[ (\lambda_{j} q_{j})_{i} + (A^{\ast} q_{j})_{i} \right] - \lambda_{j } \left[ 2(q_{j})_{i} \right] \tag{Unit Eigenvector} \\
&= (A^{\ast} q_{j})_{i} - \lambda_{j} (q_{j})_{i} \tag{Simplify}
\end{align}

<p>
This says that the partial derivative is zero if and only if
</p>

<p>
\[ (A^{\ast} q_{j})_{i} = \lambda_{j} (q_{j})_{i} \]
</p>

<p>
Hence the gradient is zero if and only if this holds for all components \( i \). 
</p>

<p>
However, for a non-hermitian matrix in general, this equality does not hold. Thus the gradient is not always zero at an eigenvector, and the convergence rate is linear. This entails that Rayleigh quotient iteration is quadratic.
</p>
</div>
</div>
</div>
<div id="outline-container-org3b36460" class="outline-3">
<h3 id="org3b36460"><span class="section-number-3">5.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-orgbe005d1" class="outline-4">
<h4 id="orgbe005d1"><span class="section-number-4">5.3.1.</span> Solution</h4>
<div class="outline-text-4" id="text-5-3-1">
</div>
<ol class="org-ol">
<li><a id="org4359c68"></a>A<br />
<div class="outline-text-5" id="text-5-3-1-1">
<p>
By construction, \( Q_{:,i} \in \spn(A_{:, 1:i}) \). Because \( A \) is tridiagonal, all vectors are zero below the first subdiagonal. Hence \( Q_{:,i} \) is also zero below the first subdiagonal. 
</p>

<p>
By the Gram Schmidt process, we have a characterization of the entries of \( R \).
</p>

<p>
\[ R_{i,j} = \begin{cases} \left\langle q_{i} , a_{j} \right\rangle & i \leq j \\ 0 & else \end{cases}  \]
</p>

<p>
However, we note that column \( i \) is orthogonal to column \( j > i + 2 \) because \( A \) is tridiagonal (the columns overlap in zeros). Hence, \( R \) is zero above the second super diagonal.  
</p>
</div>
</li>
<li><a id="orgc8253f4"></a>B<br />
<div class="outline-text-5" id="text-5-3-1-2">
<p>
\[ RQ = Q^{T}Q R Q = Q^{T} (QR) Q = Q^{T} A Q \]
</p>

<p>
Hence, \( RQ \) is symmetric.
</p>

<p>
We may prove that \( RQ \) is upper Hessenberg. Consider \( i > j + 1 \),  
</p>

\begin{align}
[RQ]_{i,j}
&= \sum_{k = 1}^{m} R_{i,k} Q_{k,j} \tag{Matrix Multiplication} \\
&= \sum_{k = 1}^{i} R_{i,k} Q_{k,j} + \sum_{k = i + 1}^{m} R_{i,k} Q_{k,j} \tag{Split Index} \\
&= \sum_{k = i + 1}^{m} R_{i,k} Q_{k,j} \tag{\( R \) upper triangular} \\
&= 0 \tag{\( Q \) upper Hessenberg, \( i > j + 1 \)}
\end{align}

<p>
Hence, because \( RQ \) is symmetric upper Hessenberg, we conclude that \( RQ \) is symmetric tridiagonal.  
</p>
</div>
</li>
<li><a id="orgd27a896"></a>C<br />
<div class="outline-text-5" id="text-5-3-1-3">
<p>
A Givens rotation matrix is constructed in constant time (because we place 4 elements no matter the size). Left multiplication by a Givens rotation matrix affects two rows. Because \( A \) is tridiagonal, these two rows will consist of 5 nonzero entries. Hence, the amount of work per zero is constant. Then there are \( m \) entries to zero out because \( A \) is tridiagonal. Hence, the work to \( QR \) factorize \( A \) is \( O(m) \) (linear instead of cubic).
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org5d6adf6" class="outline-3">
<h3 id="org5d6adf6"><span class="section-number-3">5.4.</span> Problem 4</h3>
<div class="outline-text-3" id="text-5-4">
</div>
<div id="outline-container-org5c0d7a1" class="outline-4">
<h4 id="org5c0d7a1"><span class="section-number-4">5.4.1.</span> Solution</h4>
<div class="outline-text-4" id="text-5-4-1">
<p>
I couldn't get the script to output the full matrix for part E. The code should (in theory) work for that case if you have a powerful enough computer. For some reason the Online MATLAB platform does not want to work for sizes &gt;9.
</p>

<p>
Part E: By taking a few successive ratios, QR without shifts appears to be linear convergence and QR with shifts appears to be cubic convergence. However, the amount of iterations per eigenvalue seem highly varied for the QR algorithm without shifts. More information is likely needed to make a further discussion on convergence rate (Perhaps eigenvalue separation or condition number).
</p>


<div class="org-src-container">
<pre class="src src-octave">disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Part A'</span><span style="color: #000000;">)</span>
A <span style="color: #8f0075;">=</span> hilb<span style="color: #000000;">(</span>4<span style="color: #000000;">)</span>
T <span style="color: #8f0075;">=</span> tridiag<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>

disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Part B'</span><span style="color: #000000;">)</span>
Tnew <span style="color: #8f0075;">=</span> qralg<span style="color: #000000;">(</span>T<span style="color: #000000;">)</span>

disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Part C'</span><span style="color: #000000;">)</span>
figure<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span>
qralg_with_logging_without_shift_driver<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
title<span style="color: #000000;">(</span><span style="color: #3548cf;">'QR Algorithm Without Shift Hilb(4)'</span><span style="color: #000000;">)</span>
xlabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'No. Iterations'</span><span style="color: #000000;">)</span>
ylabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'A(m,m-1)'</span><span style="color: #000000;">)</span>

disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Part D'</span><span style="color: #000000;">)</span>
figure<span style="color: #000000;">(</span>2<span style="color: #000000;">)</span>
qralg_with_logging_with_shift_driver<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
title<span style="color: #000000;">(</span><span style="color: #3548cf;">'QR Algorithm With Shift Hilb(4)'</span><span style="color: #000000;">)</span>
xlabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'No. Iterations'</span><span style="color: #000000;">)</span>
ylabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'A(m,m-1)'</span><span style="color: #000000;">)</span>


disp<span style="color: #000000;">(</span><span style="color: #3548cf;">'Part E'</span><span style="color: #000000;">)</span>
n <span style="color: #8f0075;">=</span> 10<span style="color: #8f0075;">;</span>
A <span style="color: #8f0075;">=</span> diag<span style="color: #000000;">(</span>n<span style="color: #8f0075;">:-</span>1<span style="color: #8f0075;">:</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> ones<span style="color: #000000;">(</span>n<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span> <span style="color: #595959;">%diag(15:-1:1) + ones(15,15)</span>
figure<span style="color: #000000;">(</span>3<span style="color: #000000;">)</span>
qralg_with_logging_without_shift_driver<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
title<span style="color: #000000;">(</span><span style="color: #3548cf;">'QR Algorithm Without Shift Large Ones'</span><span style="color: #000000;">)</span>
xlabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'No. Iterations'</span><span style="color: #000000;">)</span>
ylabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'A(m,m-1)'</span><span style="color: #000000;">)</span>

figure<span style="color: #000000;">(</span>4<span style="color: #000000;">)</span>
qralg_with_logging_with_shift_driver<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
title<span style="color: #000000;">(</span><span style="color: #3548cf;">'QR Algorithm With Shift Large Ones'</span><span style="color: #000000;">)</span>
xlabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'No. Iterations'</span><span style="color: #000000;">)</span>
ylabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'A(m,m-1)'</span><span style="color: #000000;">)</span>


<span style="color: #595959;">%% </span><span style="color: #595959;">Part A</span>
<span style="color: #531ab6;">function</span> T <span style="color: #8f0075;">=</span> <span style="color: #721045;">enforce_tridiag</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    T <span style="color: #8f0075;">=</span> full<span style="color: #000000;">(</span>spdiags<span style="color: #dd22dd;">(</span>spdiags<span style="color: #008899;">(</span>A<span style="color: #8f0075;">,-</span>1<span style="color: #8f0075;">:</span>1<span style="color: #008899;">)</span><span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">:</span>1<span style="color: #8f0075;">,</span> zeros<span style="color: #008899;">(</span>size<span style="color: #972500;">(</span>A<span style="color: #972500;">)</span><span style="color: #008899;">)</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> T <span style="color: #8f0075;">=</span> <span style="color: #721045;">tridiag</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 26.1 In Book with Symmetry Assumption</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">-</span>2
        basis <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>m <span style="color: #8f0075;">-</span> k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        x <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        v <span style="color: #8f0075;">=</span> sign<span style="color: #000000;">(</span>x<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>norm<span style="color: #000000;">(</span>x<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>basis<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span> 1<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> x<span style="color: #8f0075;">;</span>
        v <span style="color: #8f0075;">=</span> v <span style="color: #8f0075;">/</span> norm<span style="color: #000000;">(</span>v<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

        A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>m<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>m<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span> 2 <span style="color: #8f0075;">*</span> v <span style="color: #8f0075;">*</span> <span style="color: #000000;">(</span>v<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> A<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>m<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>k<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">';</span>
    <span style="color: #531ab6;">end</span>
    T <span style="color: #8f0075;">=</span> enforce_tridiag<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Part B</span>
<span style="color: #531ab6;">function</span> Tnew <span style="color: #8f0075;">=</span> <span style="color: #721045;">qralg</span><span style="color: #000000;">(</span>T<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 28.1 In Book</span>
    Tnew <span style="color: #8f0075;">=</span> T<span style="color: #8f0075;">;</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">if</span> m <span style="color: #8f0075;">&gt;</span> 1    
        <span style="color: #531ab6;">while</span> abs<span style="color: #000000;">(</span>Tnew<span style="color: #dd22dd;">(</span>m<span style="color: #8f0075;">,</span> m<span style="color: #8f0075;">-</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&gt;</span> 10<span style="color: #8f0075;">^</span><span style="color: #000000;">(</span><span style="color: #8f0075;">-</span>12<span style="color: #000000;">)</span>
            <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            Tnew <span style="color: #8f0075;">=</span> R <span style="color: #8f0075;">*</span> Q<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Part C</span>
<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Tnew<span style="color: #8f0075;">,</span> log<span style="color: #8f0075;">,</span> eigenvalue<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">qralg_with_logging_without_shift</span><span style="color: #000000;">(</span>T<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 28.1 In Book</span>
    Tnew <span style="color: #8f0075;">=</span> T<span style="color: #8f0075;">;</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    log <span style="color: #8f0075;">=</span> <span style="color: #000000;">[]</span><span style="color: #8f0075;">;</span>
    count <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
    eigenvalue <span style="color: #8f0075;">=</span> Tnew<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">if</span> m <span style="color: #8f0075;">&gt;</span> 1
        <span style="color: #531ab6;">while</span> abs<span style="color: #000000;">(</span>Tnew<span style="color: #dd22dd;">(</span>m<span style="color: #8f0075;">,</span> m<span style="color: #8f0075;">-</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&gt;</span> 10<span style="color: #8f0075;">^</span><span style="color: #000000;">(</span><span style="color: #8f0075;">-</span>12<span style="color: #000000;">)</span>
            log<span style="color: #000000;">(</span>count<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> abs<span style="color: #000000;">(</span>Tnew<span style="color: #dd22dd;">(</span>m<span style="color: #8f0075;">,</span> m<span style="color: #8f0075;">-</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> <span style="color: #595959;">% So gross... I should really make this a linked list</span>
            count <span style="color: #8f0075;">=</span> count <span style="color: #8f0075;">+</span> 1<span style="color: #8f0075;">;</span>
            <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            Tnew <span style="color: #8f0075;">=</span> R <span style="color: #8f0075;">*</span> Q<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        eigenvalue <span style="color: #8f0075;">=</span> Tnew<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> eigenvalues <span style="color: #8f0075;">=</span> <span style="color: #721045;">qralg_with_logging_without_shift_driver</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    T <span style="color: #8f0075;">=</span> tridiag<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Tnew <span style="color: #8f0075;">=</span> T<span style="color: #8f0075;">;</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    log_total <span style="color: #8f0075;">=</span> <span style="color: #000000;">[]</span><span style="color: #8f0075;">;</span>
    eigenvalues <span style="color: #8f0075;">=</span> <span style="color: #000000;">[]</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>m
        <span style="color: #000000;">[</span>Tnew<span style="color: #8f0075;">,</span> log_new<span style="color: #8f0075;">,</span> eigenvalue<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qralg_with_logging_without_shift<span style="color: #000000;">(</span>T<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>m<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        log_total <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>log_total<span style="color: #8f0075;">,</span> log_new<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
        eigenvalues <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>eigenvalues<span style="color: #8f0075;">,</span> eigenvalue<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    semilogy<span style="color: #000000;">(</span>log_total<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Part D</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Tnew<span style="color: #8f0075;">,</span> log<span style="color: #8f0075;">,</span> eigenvalue<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">qralg_with_logging_with_shift</span><span style="color: #000000;">(</span>T<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 28.1 In Book</span>
    Tnew <span style="color: #8f0075;">=</span> T<span style="color: #8f0075;">;</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    log <span style="color: #8f0075;">=</span> <span style="color: #000000;">[]</span><span style="color: #8f0075;">;</span>
    count <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
    eigenvalue <span style="color: #8f0075;">=</span> Tnew<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">if</span> m <span style="color: #8f0075;">&gt;</span> 1
        <span style="color: #531ab6;">while</span> abs<span style="color: #000000;">(</span>Tnew<span style="color: #dd22dd;">(</span>m<span style="color: #8f0075;">,</span> m<span style="color: #8f0075;">-</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&gt;</span> 10<span style="color: #8f0075;">^</span><span style="color: #000000;">(</span><span style="color: #8f0075;">-</span>12<span style="color: #000000;">)</span>
            log<span style="color: #000000;">(</span>count<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> abs<span style="color: #000000;">(</span>Tnew<span style="color: #dd22dd;">(</span>m<span style="color: #8f0075;">,</span> m<span style="color: #8f0075;">-</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            count <span style="color: #8f0075;">=</span> count <span style="color: #8f0075;">+</span> 1<span style="color: #8f0075;">;</span>
            <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span>R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>Tnew <span style="color: #8f0075;">-</span> Tnew<span style="color: #dd22dd;">(</span>m<span style="color: #8f0075;">,</span>m<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">*</span> eye<span style="color: #dd22dd;">(</span>m<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            Tnew <span style="color: #8f0075;">=</span> R <span style="color: #8f0075;">*</span> Q<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        eigenvalue <span style="color: #8f0075;">=</span> Tnew<span style="color: #000000;">(</span>m<span style="color: #8f0075;">,</span>m<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> eigenvalues <span style="color: #8f0075;">=</span> <span style="color: #721045;">qralg_with_logging_with_shift_driver</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
    T <span style="color: #8f0075;">=</span> tridiag<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Tnew <span style="color: #8f0075;">=</span> T<span style="color: #8f0075;">;</span>
    <span style="color: #000000;">[</span>m<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">~</span><span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>Tnew<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    log_total <span style="color: #8f0075;">=</span> <span style="color: #000000;">[]</span><span style="color: #8f0075;">;</span>
    eigenvalues <span style="color: #8f0075;">=</span> <span style="color: #000000;">[]</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>m
        <span style="color: #000000;">[</span>Tnew<span style="color: #8f0075;">,</span> log_new<span style="color: #8f0075;">,</span> eigenvalue<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qralg_with_logging_with_shift<span style="color: #000000;">(</span>T<span style="color: #dd22dd;">(</span>k<span style="color: #8f0075;">:</span>m<span style="color: #8f0075;">,</span> k<span style="color: #8f0075;">:</span>m<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        log_total <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>log_total<span style="color: #8f0075;">,</span> log_new<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
        eigenvalues <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>eigenvalues<span style="color: #8f0075;">,</span> eigenvalue<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    semilogy<span style="color: #000000;">(</span>log_total<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">Part A

A <span style="color: #8f0075;">=</span>

    1.0000    0.5000    0.3333    0.2500
    0.5000    0.3333    0.2500    0.2000
    0.3333    0.2500    0.2000    0.1667
    0.2500    0.2000    0.1667    0.1429


T <span style="color: #8f0075;">=</span>

    1.0000   <span style="color: #8f0075;">-</span>0.6509         0         0
   <span style="color: #8f0075;">-</span>0.6509   <span style="color: #8f0075;">-</span>0.4609    0.4636         0
         0    0.4636   <span style="color: #8f0075;">-</span>0.0333    0.0032
         0         0   <span style="color: #8f0075;">-</span>0.0492    0.0057

Part B

Tnew <span style="color: #8f0075;">=</span>

    1.2691   <span style="color: #8f0075;">-</span>0.0531    0.0019   <span style="color: #8f0075;">-</span>0.0074
   <span style="color: #8f0075;">-</span>0.0534   <span style="color: #8f0075;">-</span>0.9215    0.0074   <span style="color: #8f0075;">-</span>0.0218
         0    0.0000    0.1573    0.0465
         0         0   <span style="color: #8f0075;">-</span>0.0000    0.0064

Part C

ans <span style="color: #8f0075;">=</span>

    0.0064    0.0060    0.0011    0.0057

Part D

ans <span style="color: #8f0075;">=</span>

    0.0000    0.0000   <span style="color: #8f0075;">-</span>0.0000    0.0057

Part E

A <span style="color: #8f0075;">=</span>

    10     1     1     1     1     1     1     1     1
     1     9     1     1     1     1     1     1     1
     1     1     8     1     1     1     1     1     1
     1     1     1     7     1     1     1     1     1
     1     1     1     1     6     1     1     1     1
     1     1     1     1     1     5     1     1     1
     1     1     1     1     1     1     4     1     1
     1     1     1     1     1     1     1     3     1
     1     1     1     1     1     1     1     1     2


ans <span style="color: #8f0075;">=</span>

   <span style="color: #8f0075;">-</span>0.9504   <span style="color: #8f0075;">-</span>0.9474   <span style="color: #8f0075;">-</span>0.1668   <span style="color: #8f0075;">-</span>0.9269    1.0251    1.0027   <span style="color: #8f0075;">-</span>0.4712    1.0401    0.8269


ans <span style="color: #8f0075;">=</span>

   <span style="color: #8f0075;">-</span>0.0000   <span style="color: #8f0075;">-</span>0.0000   <span style="color: #8f0075;">-</span>0.0000   <span style="color: #8f0075;">-</span>0.0000   <span style="color: #8f0075;">-</span>0.0000    0.0000   <span style="color: #8f0075;">-</span>0.0000   <span style="color: #8f0075;">-</span>0.0000    0.8269
</pre>
</div>


<div id="org711dcb7" class="figure">
<p><img src="file:///home/zjabbar/Downloads/Homework 5/qr_hilb_without_shift.png" alt="qr_hilb_without_shift.png" />
</p>
</div>


<div id="org308f0ce" class="figure">
<p><img src="file:///home/zjabbar/Downloads/Homework 5/qr_hilb_with_shift.png" alt="qr_hilb_with_shift.png" />
</p>
</div>


<div id="orga6ec141" class="figure">
<p><img src="file:///home/zjabbar/Downloads/Homework 5/qr_large_without_shift.png" alt="qr_large_without_shift.png" />
</p>
</div>


<div id="org41f29b4" class="figure">
<p><img src="file:///home/zjabbar/Downloads/Homework 5/qr_large_with_shift.png" alt="qr_large_with_shift.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb621d16" class="outline-2">
<h2 id="orgb621d16"><span class="section-number-2">6.</span> <span class="done DONE">DONE</span> Homework 6</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org5592ce3" class="outline-3">
<h3 id="org5592ce3"><span class="section-number-3">6.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-6-1">
</div>
<div id="outline-container-orgd7eee48" class="outline-4">
<h4 id="orgd7eee48"><span class="section-number-4">6.1.1.</span> Solution</h4>
<div class="outline-text-4" id="text-6-1-1">
<p>
Let \( A \in \mathbb{C}^{m \times m} \) be a nonsingular normal matrix with orthonormal eigenvectors \( v_{j} \) and corresponding eigenvalues \( \lambda_{j} \). We note that \( A \) nonsingular implies \( \lambda_{j} \neq 0 \). Hence, we may define the following polynomial.
\[ p(x) = \prod_{j = 1}^{k} \left(1 - \frac{x}{\lambda_{j}}\right) \]
</p>

<p>
Apply the \( k \) degree polynomial \( p(A) \) to \( b \):   
</p>

\begin{align*}
p(A)b
&= \prod_{i = 1}^{k} \left( 1 - \frac{1}{\lambda_{i}} A \right) \sum_{j = 1}^{k} c_{j} v_{j}
&\quad &\text{Def. $p$} \\
&= \sum_{j = 1}^{k} c_{j} \prod_{i = 1}^{k} \left( 1 - \frac{1}{\lambda_{i}} A \right) v_{j}
&\quad &\text{Mat. Mult Linear} \\
&= \sum_{j = 1}^{k} c_{j} \left[ \prod_{\substack{i = 1 \\ i \neq j}}^{k} \left( 1 - \frac{1}{\lambda_{i}} A \right) \right] \left(1 - \frac{1}{\lambda_{j}} A \right) v_{j}
&\quad &\text{Matrix Polynomial Factors Commutative} \\
&= \sum_{j = 1}^{k} c_{j} \left[ \prod_{\substack{i = 1 \\ i \neq j}}^{k} \left( 1 - \frac{1}{\lambda_{i}} A \right) \right] 0
&\quad &\text{$v_{j}$ Vanishes on Factor} \\
&= 0
&\quad &\text{Sum of Zeros}
\end{align*}

<p>
Because GMRES solves the polynomial minimization problem with constant term \( 1 \), and we have displayed a polynomial with constant term \( 1 \) annihilating \( b \) we have that GMRES must converge at step \( k \).
</p>
</div>
</div>
</div>
<div id="outline-container-org4a572ca" class="outline-3">
<h3 id="org4a572ca"><span class="section-number-3">6.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-6-2">
</div>
<div id="outline-container-orgf8415e6" class="outline-4">
<h4 id="orgf8415e6"><span class="section-number-4">6.2.1.</span> Solution</h4>
<div class="outline-text-4" id="text-6-2-1">
</div>
<ol class="org-ol">
<li><a id="org0a42d16"></a>A<br />
<div class="outline-text-5" id="text-6-2-1-1">
<p>
By Equation \( 33.4 \) we have the \( (n+1) \)-term recurrence
</p>

<p>
\[ A q_{n} = h_{1,n}q_{1} + \cdots + h_{n,n}q_{n} + h_{n+1,n} q_{n+1} \]
</p>

<p>
If \( h_{n+1,n} = 0 \) then,
</p>

<p>
\[ A q_{n} = h_{1,n}q_{1} + \cdots + h_{n,n}q_{n} \]
</p>

<p>
Hence,
</p>

<p>
\[ A Q_{n} = Q_{n} H_{n} \]
</p>
</div>
</li>
<li><a id="org6b2b0ca"></a>B<br />
<div class="outline-text-5" id="text-6-2-1-2">
<p>
From the relation,
</p>

<p>
\[ A Q_{n} = Q_{n} H_{n} \]
</p>

<p>
Inspecting the \( i \)-th column, we see
</p>

<p>
\[ \text{LHS $i$-th Column} = A Q_{:, i} = \sum_{j = 1}^{n} Q_{:, j} H_{j,i} = \text{RHS $i$-th Column} \]
</p>

<p>
We see that \( AQ_{:, i} \) is a linear combination of columns of \( Q_{n} \). In other words,
</p>

<p>
\[ A \mathcal{K}_{n} = \spn( \left\{ A Q_{:, i} \right\}) \subseteq \spn( \left\{ Q_{:, i} \right\}) = \mathcal{K}_{n} \]
</p>
</div>
</li>
<li><a id="orga9b4238"></a>C<br />
<div class="outline-text-5" id="text-6-2-1-3">
<p>
From the definition of the Krylov subspace,
\[ \mathcal{K}_{n+1} = \left\langle b \right\rangle \oplus A \left\langle b, \ldots, A^{n-1}b \right\rangle = \left\langle b \right\rangle + A \mathcal{K}_{n} \]
</p>

<p>
From Part B we have,
\[ \mathcal{K}_{n+1} = \left\langle b \right\rangle + \mathcal{K}_{n} \]
</p>

<p>
But because \( b \in \mathcal{K}_{n} \) this simplifies to 
\[ \mathcal{K}_{n+1} = \mathcal{K}_{n} \]
</p>
</div>
</li>
<li><a id="org2c60abf"></a>D<br />
<div class="outline-text-5" id="text-6-2-1-4">
<p>
We know that GMRES converges at step \( m \) (Cayley-Hamilton) hence \( x \in \mathcal{K}_{m} \) , but from part C we have:
</p>

<p>
\[ x \in \mathcal{K}_{m} = \mathcal{K}_{n} \]
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orga1628b2" class="outline-3">
<h3 id="orga1628b2"><span class="section-number-3">6.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-6-3">
</div>
<div id="outline-container-org4285152" class="outline-4">
<h4 id="org4285152"><span class="section-number-4">6.3.1.</span> Solution</h4>
<div class="outline-text-4" id="text-6-3-1">
</div>
<ol class="org-ol">
<li><a id="org19da110"></a>A<br />
<div class="outline-text-5" id="text-6-3-1-1">
<p>
For Cholesky Factorization (23.4),
</p>

<p>
\[ n \simeq \frac{1}{3} m^{3} = \frac{1}{3} 1000^{3} \simeq 333,333,334 \]
</p>
</div>
</li>
<li><a id="org428aaf3"></a>C<br />
<div class="outline-text-5" id="text-6-3-1-2">
<p>
For CG (In class),
</p>

<p>
\[ n \simeq \frac{\sqrt{k}}{2} \log \left( \frac{2}{\varepsilon} \right) = \frac{\sqrt{100}}{2} \log \left( \frac{2}{10^{-10}} \right) \simeq 52 \]
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgbafbcf9" class="outline-3">
<h3 id="orgbafbcf9"><span class="section-number-3">6.4.</span> Problem 4</h3>
<div class="outline-text-3" id="text-6-4">
</div>
<div id="outline-container-org422bf4c" class="outline-4">
<h4 id="org422bf4c"><span class="section-number-4">6.4.1.</span> Solution</h4>
<div class="outline-text-4" id="text-6-4-1">
</div>
<ol class="org-ol">
<li><a id="orgf626c8a"></a>A.A<br />
<div class="outline-text-5" id="text-6-4-1-1">
<p>
We may calculate the \( i \)-th partial derivative.  
</p>

\begin{align*}
\frac{ \partial \varphi}{ \partial x_{i}}
&= \frac{ \partial }{ \partial x_{i}} \frac{1}{2} x^{T} A x - x^{T} b \\
&= \frac{1}{2} e_{i}^{T} A x + \frac{1}{2} x^{T} A e_{i} - e_{i} b \\
&= (A^{T} x)_{i} - b_{i} \\
&= (A x)_{i} - b_{i}
\end{align*}

<p>
Hence,
</p>

<p>
\[ \nabla \varphi = Ax - b = -r \]
</p>
</div>
</li>
<li><a id="org5482172"></a>A.B<br />
<div class="outline-text-5" id="text-6-4-1-2">
<p>
To find the optimal \( \alpha_{n} \), we take the derivative of \( \varphi \) with respect to \( \alpha_{n} \), set the value equal to zero, and solve.   
</p>

\begin{align*}
0
& = \frac{ d \varphi}{ d \alpha_{n}}
&\quad &\text{Maximum} \\
&= \frac{ d \varphi}{ d x_{n}} \frac{ d x_{n}}{ d \alpha_{n}}
&\quad &\text{Chain Rule} \\
&= (A(x_{n-1} + \alpha_{n} p_{n-1}) - b)^{T} p_{n-1}
&\quad &\text{Part A} \\
&= (x_{n-1}^{T}A^{T} + \alpha_{n} p_{n-1}^{T}A^{T} - b^{T}) p_{n-1}
&\quad &\text{Apply Transpose} \\
&= x_{n-1}^{T}A^{T} p_{n-1} + \alpha_{n} p_{n-1}^{T}A^{T} p_{n-1} - b^{T} p_{n-1}
&\quad &\text{Matrix Multiplication}
\end{align*}

<p>
We may now solve for \( \alpha_{n} \). 
</p>

\begin{align*}
\alpha_{n}
&= \frac{b^{T} p_{n-1} - x_{n-1}^{T}A^{T} p_{n-1}}{p_{n-1}^{T}A^{T} p_{n-1}}
&\quad &\text{Solve for $\alpha_{n}$} \\
&= \frac{(b^{T} - x_{n-1}^{T}A^{T}) p_{n-1}}{p_{n-1}^{T}A^{T} p_{n-1}}
&\quad &\text{Factor $p_{n-1}$} \\
&= \frac{r_{n-1}^{T} p_{n-1}}{p_{n-1}^{T}A^{T} p_{n-1}}
&\quad &\text{Def. $r$} \\
&= \frac{r_{n-1}^{T} p_{n-1}}{p_{n-1}^{T}A p_{n-1}}
&\quad &\text{Apply Transpose}
\end{align*}

<p>
In the case of steepest descent, \( p_{n} = r_{n} \), hence:
</p>

<p>
\[ \alpha_{n} = \frac{r_{n-1}^{T} r_{n-1}}{r_{n-1}^{T} A r_{n-1}} \]
</p>
</div>
</li>
<li><a id="org4ad8514"></a>A.C Implementation<br />
<div class="outline-text-5" id="text-6-4-1-3">
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #531ab6;">function</span> x <span style="color: #8f0075;">=</span> <span style="color: #721045;">steepest_descent</span><span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span>
    x <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>b<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    <span style="color: #531ab6;">while</span> norm<span style="color: #000000;">(</span>A<span style="color: #8f0075;">*</span>x <span style="color: #8f0075;">-</span> b<span style="color: #000000;">)</span> <span style="color: #8f0075;">&gt;</span> eps
        r <span style="color: #8f0075;">=</span> b <span style="color: #8f0075;">-</span> A <span style="color: #8f0075;">*</span> x<span style="color: #8f0075;">;</span>
        alpha <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> r<span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> <span style="color: #000000;">(</span>r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> A <span style="color: #8f0075;">*</span> r<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        x <span style="color: #8f0075;">=</span> x <span style="color: #8f0075;">+</span> alpha <span style="color: #8f0075;">*</span> r<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>
</div>
</li>
<li><a id="orgfa51ddf"></a>B<br />
<div class="outline-text-5" id="text-6-4-1-4">
<p>
First, a lemma, \( r_{n-1} \perp  p_{n-2} \).
Because the definitions are given by recursion, we may proceed by induction.
</p>

<p>
Base Case: \( n = 1 \)
</p>
\begin{align*}
r_{1}^{T} p_{0}
&= (r_{0} - \alpha_{1} A p_{0})^{T} p_{0}
&\quad &\text{Def. $r$} \\
&= \left(r_{0} - \frac{r_{0}^{T}r_{0}}{p_{0}^{T}A p_{0}} A p_{0}\right)^{T} p_{0}
&\quad &\text{Def. $\alpha$} \\
&= \left(r_{0}^{T} - \frac{r_{0}^{T}r_{0}}{p_{0}^{T}A p_{0}} p_{0} A^{T} \right) p_{0}
&\quad &\text{Apply Transpose} \\
&= \left(r_{0}^{T} - \frac{r_{0}^{T}r_{0}}{p_{0}^{T}A p_{0}} p_{0} A \right) p_{0}
&\quad &\text{$A$ Symmetric} \\
&= \left(b^{T} - \frac{b^{T}b}{b^{T}A b} b^{T} A \right) b
&\quad &\text{Initial Conditions} \\
&= b^{T} b - \frac{b^{T}b}{b^{T}A b} b^{T} A b
&\quad &\text{Multiply} \\
&= 0
&\quad &\text{Simplify}
\end{align*}

<p>
Now suppose that \( r_{n-1}^{T}p_{n-2} = 0 \), consider \( r_{n}^{T} p_{n-1} \):
</p>

\begin{align*}
r_{n}^{T} p_{n-1}
&= (r_{n-1} - \alpha_{n} A p_{n-1})^{T} (r_{n-1} + \beta_{n-1} p_{n-2})
&\quad &\text{Def. $r,p$} \\
&= (r_{n-1}^{T} - \alpha_{n} p_{n-1}^{T} A) (r_{n-1} + \beta_{n-1} p_{n-2})
&\quad &\text{Apply Transpose} \\
&= r_{n-1}^{T}r_{n-1} + \beta_{n-1} r_{n-1}^{T} p_{n-2} - \alpha_{n} p_{n-1}^{T} A r_{n-1} - \alpha_{n} \beta_{n-1} p_{n-1}^{T} A p_{n-2}
&\quad &\text{Multiply} \\
&= r_{n-1}^{T}r_{n-1}  - \alpha_{n} p_{n-1}^{T} A r_{n-1} - \alpha_{n} \beta_{n-1} p_{n-1}^{T} A p_{n-2}
&\quad &\text{Induction Hypothesis} \\
&= r_{n-1}^{T}r_{n-1}  - \alpha_{n} p_{n-1}^{T} A r_{n-1}
&\quad &\text{$p$ $A$-conjugate} \\
&= r_{n-1}^{T}r_{n-1}  - \frac{r_{n-1}^{T} r_{n-1}}{p_{n-1}^{T} A r_{n-1}} p_{n-1}^{T} A r_{n-1}
&\quad &\text{Eqn in Thm 38.1} \\
&= 0
&\quad &\text{Simplify}
\end{align*}

<p>
Hence, we have,
</p>
\begin{align*}
\alpha_{n}
&= \frac{r_{n-1}^{T} p_{n-1}}{p_{n-1}^{T}A p_{n-1}}
&\quad &\text{Previous} \\
&= \frac{r_{n-1}^{T} (r_{n-1} + \beta_{n-1} p_{n-2})}{p_{n-1}^{T}A p_{n-1}}
&\quad &\text{CG Iteration} \\
&= \frac{r_{n-1}^{T} r_{n-1} + \beta_{n-1} r_{n-1}^{T} p_{n-2}}{p_{n-1}^{T}A p_{n-1}}
&\quad &\text{CG Iteration} \\
&= \frac{r_{n-1}^{T} r_{n-1}}{p_{n-1}^{T}A p_{n-1}}
&\quad &\text{Lemma}
\end{align*}
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org6d924af" class="outline-3">
<h3 id="org6d924af"><span class="section-number-3">6.5.</span> Problem 5</h3>
<div class="outline-text-3" id="text-6-5">
</div>
<div id="outline-container-org90ddceb" class="outline-4">
<h4 id="org90ddceb"><span class="section-number-4">6.5.1.</span> Solution</h4>
<div class="outline-text-4" id="text-6-5-1">
<div class="org-src-container">
<pre class="src src-octave">close all<span style="color: #8f0075;">;</span> clear<span style="color: #8f0075;">;</span> clc<span style="color: #8f0075;">;</span>

n <span style="color: #8f0075;">=</span> 100<span style="color: #8f0075;">;</span>
A <span style="color: #8f0075;">=</span> full<span style="color: #000000;">(</span>spdiags<span style="color: #dd22dd;">(</span><span style="color: #008899;">[</span>ones<span style="color: #972500;">(</span>n<span style="color: #8f0075;">,</span>1<span style="color: #972500;">)</span> <span style="color: #972500;">(</span>1<span style="color: #8f0075;">:</span>n<span style="color: #972500;">)</span><span style="color: #8f0075;">'</span> ones<span style="color: #972500;">(</span>n<span style="color: #8f0075;">,</span>1<span style="color: #972500;">)</span><span style="color: #008899;">]</span><span style="color: #8f0075;">,-</span>1<span style="color: #8f0075;">:</span>1<span style="color: #8f0075;">,</span>n<span style="color: #8f0075;">,</span>n<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
b <span style="color: #8f0075;">=</span> ones<span style="color: #000000;">(</span>n<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

<span style="color: #000000;">[</span>x_cg<span style="color: #8f0075;">,</span> r_n_log_cg<span style="color: #8f0075;">,</span> b_minus_Ax_n_log_cg<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> zain_conjugate_gradient<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>x_sd<span style="color: #8f0075;">,</span> r_n_log_sd<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> zain_steepest_descent<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>x_gmres<span style="color: #8f0075;">,</span> b_minus_Ax_n_log_gmres<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> zain_gmres<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

kappa <span style="color: #8f0075;">=</span> cond<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
kappa_estimate_convergence <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>101<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
kappa_estimate_convergence<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>100
    kappa_estimate_convergence<span style="color: #000000;">(</span>i<span style="color: #8f0075;">+</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 2 <span style="color: #8f0075;">*</span> <span style="color: #000000;">(</span>sqrt<span style="color: #dd22dd;">(</span>kappa<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">^</span>i <span style="color: #8f0075;">/</span> <span style="color: #000000;">(</span>sqrt<span style="color: #dd22dd;">(</span>kappa<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">+</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">^</span>i<span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">end</span>

x <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span>101<span style="color: #8f0075;">;</span>
semilogy<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> r_n_log_cg<span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'DisplayName'</span><span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'Computed Residual CG'</span><span style="color: #000000;">)</span>
hold on
semilogy<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> b_minus_Ax_n_log_cg<span style="color: #8f0075;">,</span><span style="color: #3548cf;">'DisplayName'</span><span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'Actual Residual CG'</span><span style="color: #000000;">)</span>
hold on
semilogy<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> r_n_log_sd<span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'DisplayName'</span><span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'Residual SD'</span><span style="color: #000000;">)</span>
hold on
semilogy<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> kappa_estimate_convergence<span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'DisplayName'</span><span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'Convergence Estimate'</span><span style="color: #000000;">)</span>
hold on
semilogy<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> b_minus_Ax_n_log_gmres<span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'DisplayName'</span><span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'Residual GMRES'</span><span style="color: #000000;">)</span>
legend<span style="color: #000000;">(</span><span style="color: #3548cf;">'Location'</span><span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'northeastoutside'</span><span style="color: #000000;">)</span>
title<span style="color: #000000;">(</span><span style="color: #3548cf;">'Residual Plots'</span><span style="color: #000000;">)</span>
xlabel<span style="color: #000000;">(</span><span style="color: #3548cf;">'Num Iterations'</span><span style="color: #000000;">)</span>


<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>x<span style="color: #8f0075;">,</span> r_n_log<span style="color: #8f0075;">,</span> b_minus_Ax_n_log<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">zain_conjugate_gradient</span><span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 38.1</span>
    x <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>b<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    r <span style="color: #8f0075;">=</span> b<span style="color: #8f0075;">;</span>
    p <span style="color: #8f0075;">=</span> r<span style="color: #8f0075;">;</span>

    r_n_log <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>101<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    r_n_log<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>r<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    b_minus_Ax_n_log <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>101<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    b_minus_Ax_n_log<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>b <span style="color: #8f0075;">-</span> A<span style="color: #8f0075;">*</span>x<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>100
        alpha <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> r<span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> <span style="color: #000000;">(</span>p<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> A <span style="color: #8f0075;">*</span> p<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        x <span style="color: #8f0075;">=</span> x <span style="color: #8f0075;">+</span> alpha <span style="color: #8f0075;">*</span> p<span style="color: #8f0075;">;</span>
        beta_denom <span style="color: #8f0075;">=</span> r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> r<span style="color: #8f0075;">;</span>
        r <span style="color: #8f0075;">=</span> r <span style="color: #8f0075;">-</span> alpha <span style="color: #8f0075;">*</span> A <span style="color: #8f0075;">*</span> p<span style="color: #8f0075;">;</span>

        beta <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> r<span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> <span style="color: #000000;">(</span>beta_denom<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        p <span style="color: #8f0075;">=</span> r <span style="color: #8f0075;">+</span> beta <span style="color: #8f0075;">*</span> p<span style="color: #8f0075;">;</span>
        
        r_n_log<span style="color: #000000;">(</span>i<span style="color: #8f0075;">+</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>r<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        b_minus_Ax_n_log<span style="color: #000000;">(</span>i<span style="color: #8f0075;">+</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>b <span style="color: #8f0075;">-</span> A<span style="color: #8f0075;">*</span>x<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>x<span style="color: #8f0075;">,</span> r_n_log<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">zain_steepest_descent</span><span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span> <span style="color: #595959;">% Problem 4</span>
    x <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>b<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    r_n_log <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>101<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    r_n_log<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>b <span style="color: #8f0075;">-</span> A <span style="color: #8f0075;">*</span> x<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>100
        r <span style="color: #8f0075;">=</span> b <span style="color: #8f0075;">-</span> A <span style="color: #8f0075;">*</span> x<span style="color: #8f0075;">;</span>
        alpha <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> r<span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> <span style="color: #000000;">(</span>r<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> A <span style="color: #8f0075;">*</span> r<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        x <span style="color: #8f0075;">=</span> x <span style="color: #8f0075;">+</span> alpha <span style="color: #8f0075;">*</span> r<span style="color: #8f0075;">;</span>

        r_n_log<span style="color: #000000;">(</span>i<span style="color: #8f0075;">+</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>r<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>x<span style="color: #8f0075;">,</span> b_minus_Ax_n_log<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">zain_gmres</span><span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 35.1</span>
    b_minus_Ax_n_log <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>101<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    b_minus_Ax_n_log<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    x <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>A<span style="color: #8f0075;">,</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    <span style="color: #531ab6;">for</span> n<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>101
        <span style="color: #000000;">[</span>Q_A<span style="color: #8f0075;">,</span> H<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> zain_arnoldi<span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span>b<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> 
        <span style="color: #000000;">[</span>Q_H<span style="color: #8f0075;">,</span> R<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> qr<span style="color: #000000;">(</span>H<span style="color: #8f0075;">,</span> <span style="color: #3548cf;">'econ'</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        e_1 <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n<span style="color: #8f0075;">+</span>1<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        e_1<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        y <span style="color: #8f0075;">=</span> R <span style="color: #8f0075;">\</span> Q_H<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> e_1<span style="color: #8f0075;">;</span>
        x <span style="color: #8f0075;">=</span> Q_A<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span> 1<span style="color: #8f0075;">:</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">*</span> y<span style="color: #8f0075;">;</span>
        b_minus_Ax_n_log<span style="color: #000000;">(</span>n<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>b <span style="color: #8f0075;">-</span> A<span style="color: #8f0075;">*</span>x<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>Q<span style="color: #8f0075;">,</span> H<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">zain_arnoldi</span><span style="color: #000000;">(</span>A<span style="color: #8f0075;">,</span>b<span style="color: #8f0075;">,</span>n<span style="color: #000000;">)</span> <span style="color: #595959;">% Algorithm 33.1</span>
    Q <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>size<span style="color: #dd22dd;">(</span>A<span style="color: #8f0075;">,</span> 1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span> 1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> b <span style="color: #8f0075;">/</span> norm<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    H <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n <span style="color: #8f0075;">+</span> 1<span style="color: #8f0075;">,</span> n<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    <span style="color: #531ab6;">for</span> k <span style="color: #8f0075;">=</span> 2<span style="color: #8f0075;">:</span>n<span style="color: #8f0075;">+</span>1
        Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A <span style="color: #8f0075;">*</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">for</span> j <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">:</span><span style="color: #000000;">(</span>k<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span>
            H<span style="color: #000000;">(</span>j<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span> H<span style="color: #000000;">(</span>j<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">*</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>j<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
        H<span style="color: #000000;">(</span>k<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> norm<span style="color: #000000;">(</span>Q<span style="color: #dd22dd;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> Q<span style="color: #000000;">(</span><span style="color: #8f0075;">:,</span>k<span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> H<span style="color: #000000;">(</span>k<span style="color: #8f0075;">,</span>k<span style="color: #8f0075;">-</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>


<div id="orge6b03ab" class="figure">
<p><img src="flashcard_media/problem_5_plot.png" alt="problem_5_plot.png" />
</p>
</div>

<p>
We see that all the solvers are roughly equal for the first 20 iterations. Steepest descent is the worst performing linear solver over time. The best one is conjugate gradient. GMRES is quite close but second to CG. This makes sense as CG is an algorithm which leverages the positive definiteness of the matrix. All algorithms should eventually plateau as the calculations get closer to machine epsilon.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org578f405" class="outline-2">
<h2 id="org578f405"><span class="section-number-2">7.</span> <span class="done DONE">DONE</span> Homework 7</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org03702c5" class="outline-3">
<h3 id="org03702c5"><span class="section-number-3">7.1.</span> Problem 1</h3>
<div class="outline-text-3" id="text-7-1">
</div>
<div id="outline-container-org796f305" class="outline-4">
<h4 id="org796f305"><span class="section-number-4">7.1.1.</span> Solution</h4>
<div class="outline-text-4" id="text-7-1-1">
</div>
<ol class="org-ol">
<li><a id="org3cb5730"></a>A<br />
<div class="outline-text-5" id="text-7-1-1-1">
\begin{align}
\left| \ell(v) \right|
&= \left| 2 v(0) \right|
&\quad &\text{Def $\ell$}\\
&= \left| (v(0) - v(-1)) - (v(1) - v(0)) \right|
&\quad &\text{Dirichlet BC}\\
&= \left| \int_{-1}^{0} v'(x) dx - \int_{0}^{1} v'(x) dx \right|
&\quad &\text{FTC}\\
&\leq  \int_{-1}^{0} | v'(x) | dx + \int_{0}^{1} | v'(x) | dx
&\quad &\text{Jensen's Inequality}\\
&=  \int_{-1}^{0}  (v'(x)^{2})^{1/2} dx + \int_{0}^{1} ( v'(x)^{2} )^{1/2} dx
&\quad &\text{Absolute Value Equiv.}\\
&\leq  \left( \int_{-1}^{0}  v'(x)^{2} dx \right)^{1/2} + \left( \int_{0}^{1} v'(x)^{2} dx \right)^{1/2}
&\quad &\text{Cauchy Schwarz}
\end{align}
</div>
</li>
<li><a id="org6c437c3"></a>B<br />
<div class="outline-text-5" id="text-7-1-1-2">
<p>
First, a lemma:
</p>

\begin{align}
\frac{1}{2} (b - 1)^{2} + \frac{1}{2} (c - 1)^{2} &\geq 0
&\quad &\text{Sum of Squares}\\
\frac{1}{2} (b^{2} - 2b + 1) + \frac{1}{2} (c^{2} - 2c + 1) &\geq 0
&\quad &\text{Distribute}\\
\frac{1}{2} b^{2} + \frac{1}{2} c^{2} - b - c + 1 &\geq 0
&\quad &\text{Distribute}\\
\frac{1}{2} b^{2} + \frac{1}{2} c^{2} - b - c &\geq -1
&\quad &\text{Subtract}
\end{align}

\begin{align}
J(v)
&= \frac{1}{2} a(v,v) - \ell(v)
&\quad &\text{Def $J$}\\
&= \frac{1}{2} \int_{-1}^{1} v'(x)^{2} dx - 2 v(0)
&\quad &\text{Def $a$, $\ell$}\\
&\geq \frac{1}{2} \int_{-1}^{1} v'(x)^{2} dx - \left( \left( \int_{-1}^{0} v'(x)^{2} dx \right)^{1/2} + \left( \int_{0}^{1} v'(x)^{2} dx \right)^{1/2} \right)
&\quad &\text{Part A}\\
&= \frac{1}{2} \int_{-1}^{0} v'(x)^{2} dx + \frac{1}{2} \int_{0}^{1} v'(x)^{2} dx - \left( \left( \int_{-1}^{0} v'(x)^{2} dx \right)^{1/2} + \left( \int_{0}^{1} v'(x)^{2} dx \right)^{1/2} \right)
&\quad &\text{Split Integral}\\
&\geq 1
&\quad &\text{Lemma}
\end{align}
</div>
</li>
<li><a id="org9300b3c"></a>C<br />
<div class="outline-text-5" id="text-7-1-1-3">
<p>
Equality in Part A: Holds when \( v'(x) > 0 \) for \( -1 \leq x \leq 0 \), \( v'(x) < 0 \) for \( 0 \leq x \leq 1 \), also when \( v' \) is linearly dependent with the function \( 1 \).
Equality in Part B: Holds when equality in part A holds and when the two integrals are equal to \( 1 \).
</p>

<p>
Putting all of this together, we have a constant function over a domain with unit base. This describes a rectangle, hence we may solve for the constant.
</p>

\begin{align}
v'(x) = 
\begin{cases}
1 & -1 < x < 0 \\
-1 & 0 < x < 1
\end{cases}
\end{align}

<p>
We note that there is no choice of \( v'(0) \) which makes the function continuously differentiable. Because the minimizers of \( J \) are unique, no function \( v \in V \) can attain the minimum. Hence, \( J(v) > -1 \).    
</p>

<p>
Because \( J(v) = -1 \implies v \not\in C^{1}(\Omega) \) we have that \( v \in C^{1}(\Omega) \implies J(v) > -1 \).
</p>
</div>
</li>
<li><a id="orgd048f41"></a>D<br />
<div class="outline-text-5" id="text-7-1-1-4">
<p>
Let
</p>

\begin{align}
v_{n}(x) =
\begin{cases}
1 + x &  x \leq \frac{-1}{n} \\
1 - \frac{n}{2}x^{2} - \frac{1}{2n} &  \frac{-1}{n} < x < \frac{1}{n} \\
1 - x &  x \geq \frac{1}{n}
\end{cases}
\end{align}

<p>
We must check that \( v_{n}(x) \in V \).
</p>

<p>
That means checking that the function is continuous on the entire domain. We know that each piecewise defined component is smooth, hence we need only check the boundaries of the defined region.
</p>

<p>
\[ \lim_{x \to \frac{-1}{n}^{-}} v_{n}(x) = 1 - \frac{1}{n} = 1 - \frac{n}{2} \frac{1}{n^{2}} - \frac{1}{2n} = \lim_{x \to \frac{-1}{n}^{+}} v_{n}(x) \]
</p>

<p>
\[ \lim_{x \to \frac{-1}{n}^{-}} v_{n}(x) = 1 - \frac{n}{2} \frac{1}{n^{2}} - \frac{1}{2n} = 1 - \frac{1}{n} = \lim_{x \to \frac{-1}{n}^{+}} v_{n}(x) \]
</p>


<p>
The function is zero at the boundaries
</p>

<p>
\[ v_{n}(-1) = 1 - 1 = 0 \]
</p>

<p>
\[ v_{n}(1) = 1 - 1 = 0 \]
</p>


<p>
The function has matching derivatives at the piecewise defined regions
</p>

\begin{align}
v'_{n}(x) =
\begin{cases}
1 &  x \leq \frac{-1}{n} \\
- nx &  \frac{-1}{n} < x < \frac{1}{n} \\
-1 &  x \geq \frac{1}{n}
\end{cases}
\end{align}

<p>
\[ \lim_{x \to \frac{-1}{n}^{-}} v'_{n}(x) = 1 = -n \frac{-1}{n} = \lim_{x \to \frac{-1}{n}^{+}} v'_{n}(x) \]
</p>

<p>
\[ \lim_{x \to \frac{1}{n}^{-}} v'_{n}(x) = -n \frac{1}{n} = -1 = \lim_{x \to \frac{1}{n}^{+}} v'_{n}(x) \]
</p>


<p>
We may now compute \( J(v_{n}) \).
</p>

<p>
\[ n^{2} \frac{1}{3} \left( x^{3} \right) = \frac{n^{2}}{3} \left( \frac{2}{n^{3}} \right) \]
</p>


\begin{align}
J(v_{n})
&= \frac{1}{2} \int_{-1}^{1} v'_{n}(x)^{2} dx - 2 v_{n}(0) \\
&= \frac{1}{2} \left( \int_{-1}^{\frac{-1}{n}} v'_{n}(x)^{2} dx + \int_{\frac{-1}{n}}^{\frac{1}{n}} v'_{n}(x)^{2} dx + \int_{\frac{1}{n}}^{1} v'_{n}(x)^{2} dx \right) - 2 v_{n}(0) \\
&= \frac{1}{2} \left( \int_{-1}^{\frac{-1}{n}} 1 dx + \int_{\frac{-1}{n}}^{\frac{1}{n}} n^{2}x^{2} dx + \int_{\frac{1}{n}}^{1} 1 dx \right) - 2 \left( 1 - \frac{1}{2n} \right) \\
&= \frac{1}{2} \left( \frac{n-1}{n} + \frac{2}{3 n} + \frac{n-1}{n} \right) - 2 \left( 1 - \frac{1}{2n} \right) \\
&= \frac{1}{3 n} - 1
\end{align}

<p>
As \( n \to \infty \) we see that \( J(v_{n}) \to -1 \).
</p>
</div>
</li>
<li><a id="org26715dc"></a>E<br />
<div class="outline-text-5" id="text-7-1-1-5">
<p>
Given \( \tilde{v} \in V \), there exists be some large enough \( N \) such that \( J(\tilde{v}) > J(v_{N}) > -1 \). Hence there is always a smaller (in \( J \)) \( v_{n} \) in \( V \). Thus \( V \) cannot contain a minimizer. 
</p>
</div>
</li>
<li><a id="org7c1b75f"></a>F<br />
<div class="outline-text-5" id="text-7-1-1-6">
<p>
The minimizer is \( 1 - |x| \) which is a piecewise smooth function. Hence in \( H^{1}_{0}(\Omega) \).
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org8d8e5ab" class="outline-3">
<h3 id="org8d8e5ab"><span class="section-number-3">7.2.</span> Problem 2</h3>
<div class="outline-text-3" id="text-7-2">
</div>
<div id="outline-container-org8f6e47d" class="outline-4">
<h4 id="org8f6e47d"><span class="section-number-4">7.2.1.</span> Solution</h4>
<div class="outline-text-4" id="text-7-2-1">
<p>
Take the PDE, multiply by an arbitrary continuously differentiable \( v \in C^{1}(\Omega) \) with the same Dirichlet boundary conditions and integrate by parts.
</p>

\begin{align}
- \Delta u + u &= f &\quad & \text{PDE} \\
- v \Delta u + v u &= v f &\quad & \text{Multiply by $v$} \\
- \int_\Omega v \Delta u dx + \int_\Omega v u dx &= \int_\Omega v f dx &\quad & \text{Integrate over $\Omega$} \\
- \left(\int_{\partial \Omega} v \frac{ \partial u}{ \partial \nu} dS - \int_{\Omega} \nabla v \cdot \nabla u dx\right) + \int_\Omega v u dx &= \int_\Omega v f dx &\quad & \text{Integration by Parts} \\
\int_{\Omega} \nabla v \cdot \nabla u dx + \int_\Omega v u dx &= \int_\Omega v f dx &\quad & \text{Apply BC}
\end{align}

<p>
We may now define:
</p>

\begin{align}
a(u,v) &= \int_{\Omega} uv + \nabla u \cdot \nabla v dx = \left\langle u , v \right\rangle_{H^{1}_{0}(\Omega)} \\
\ell(v) &= \int_{\Omega} vf dx = \left\langle v, f \right\rangle_{L^{2}(\Omega)} 
\end{align}

<p>
We note that \( a \) and \( \ell \) satisfies all of the hypotheses of Lax-Milgram by noticing that they are equivalent to other well known norms / inner products. For example, \( a \) is symmetric bilinear by definition of an inner product. Continuity is established by Cauchy-Schwarz
</p>

<p>
\[ a(u,v) \leq \| u \|_{H^{1}_{0}(\Omega)} \| v \|_{H^{1}_{0}(\Omega)} \]
</p>

<p>
Coercivity can also be proved
</p>

<p>
\[ \| v \|^{2}_{H^{1}_{0}(\Omega)} = a(v,v) \]
</p>


\begin{align}
\| v \|^{2}
&= \int_{\Omega} v^{2} dx \\
&\leq \int_{\Omega} v^{2} + \nabla v \cdot \nabla v dx \\
&= a(v,v)
\end{align}

<p>
We note that \( \ell \) is continuous by Cauchy Schwarz
</p>

<p>
\[ \ell(v) = \left\langle v , f \right\rangle_{L^{2}(\Omega)} \leq \| v \|_{L^{2}(\Omega)} \| f \|_{L^{2}(\Omega)} \]
</p>

<p>
Hence \( \ell \) is bounded on a larger space \( L^{2}(\Omega) \) it will be bounded on the subspace \( H^{1}_{0}(\Omega) \).
</p>

<p>
\[ \frac{\ell(v)}{\| v \|_{H^{1}_{0}(\Omega)}} \leq \frac{\ell(v)}{\| v \|_{L^{2}(\Omega)}} \leq \| f \|_{L^{2}(\Omega)} \]
</p>


<p>
By Lax-Milgram we see that there is a solution to the equation,
</p>

<p>
\[ \int_{\Omega} vu + \nabla v \cdot \nabla u dx = a(u,v) = \ell(v) = \int_{\Omega} v f dx \]
</p>
</div>
</div>
</div>
<div id="outline-container-org71c5106" class="outline-3">
<h3 id="org71c5106"><span class="section-number-3">7.3.</span> Problem 3</h3>
<div class="outline-text-3" id="text-7-3">
</div>
<div id="outline-container-org29b1f68" class="outline-4">
<h4 id="org29b1f68"><span class="section-number-4">7.3.1.</span> Solution</h4>
<div class="outline-text-4" id="text-7-3-1">
</div>
<ol class="org-ol">
<li><a id="org5633f42"></a>A<br />
<div class="outline-text-5" id="text-7-3-1-1">
<p>
The linear system \( Ac = b \) is given in components: 
</p>

\begin{align}
\everymath{\displaystyle}
\begin{bmatrix}
\int_{0}^{\pi} \phi_{1}(x) \phi_{1}(x) dx & \int_{0}^{\pi} \phi_{1}(x) \phi_{2}(x) dx \\
\int_{0}^{\pi} \phi_{2}(x) \phi_{1}(x) dx & \int_{0}^{\pi} \phi_{2}(x) \phi_{2}(x) dx \\
\end{bmatrix}
\begin{bmatrix}
c_{1} \\
c_{2}
\end{bmatrix}
&=
\everymath{\displaystyle}
\begin{bmatrix}
\int_{0}^{\pi} f(x) \phi_{1}(x) dx \\
\int_{0}^{\pi} f(x) \phi_{2}(x) dx \\
\end{bmatrix} \\
\begin{bmatrix}
\frac{\pi}{2} & -4 \\
-4 & \frac{\pi^{5}}{30} \\
\end{bmatrix}
\begin{bmatrix}
c_{1} \\
c_{2}
\end{bmatrix}
&=
\begin{bmatrix}
\pi \\
\frac{-\pi^{4}}{12} \\
\end{bmatrix} \\
\end{align}

<p>
Solving yields:
</p>

\begin{align}
\begin{bmatrix}
c_{1}\\
c_{2}
\end{bmatrix}
=
\begin{bmatrix}
-18.2865 \\
-7.9665
\end{bmatrix}
\end{align}

<p>
The plot is:
</p>


<div id="orga2e1c84" class="figure">
<p><img src="figures/uh.png" alt="uh.png" />
</p>
</div>
</div>
</li>
<li><a id="orgd8dc9d6"></a>B<br />
<div class="outline-text-5" id="text-7-3-1-2">
<p>
The underlying problem is
</p>

\begin{align}
u''(x) = x \tag{PDE} \\
u(0) = u(\pi) = 0 \tag{BC}
\end{align}

<p>
The solution is given by integration twice.
</p>

<p>
\[ u''(x) = x \implies u'(x) = \frac{x^{2}}{2} + c_{1} \implies u(x) = \frac{x^{3}}{6} + c_{1}x + c_{2} \]
</p>

<p>
\[ u(0) = 0 = c_{2} \]
</p>

<p>
\[ u(\pi) = 0 = \frac{\pi^{3}}{6} + c_{1} \pi \implies c_{1} = \frac{-\pi^{2}}{6} \]
</p>


<div id="org4b671ca" class="figure">
<p><img src="figures/true_solution.png" alt="true_solution.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-octave">c <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>pi<span style="color: #8f0075;">/</span>2<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-</span>4<span style="color: #8f0075;">;</span> <span style="color: #8f0075;">-</span>4<span style="color: #8f0075;">,</span> pi<span style="color: #8f0075;">^</span>5 <span style="color: #8f0075;">/</span> 30<span style="color: #000000;">]</span> <span style="color: #8f0075;">\</span> <span style="color: #000000;">[</span>pi<span style="color: #8f0075;">;</span> <span style="color: #8f0075;">-</span>pi<span style="color: #8f0075;">^</span>4 <span style="color: #8f0075;">/</span> 12<span style="color: #000000;">]</span>

phi1 <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #000000;">)</span> c<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>sin<span style="color: #000000;">(</span>x<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> c<span style="color: #000000;">(</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>x<span style="color: #8f0075;">.^</span>2 <span style="color: #8f0075;">-</span> pi<span style="color: #8f0075;">*</span>x<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
fplot<span style="color: #000000;">(</span>phi1<span style="color: #8f0075;">,</span><span style="color: #dd22dd;">[</span>0<span style="color: #8f0075;">,</span>pi<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span>
grid

phi2 <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #000000;">)</span> x<span style="color: #8f0075;">^</span>3 <span style="color: #8f0075;">/</span> 6 <span style="color: #8f0075;">-</span> <span style="color: #000000;">(</span>pi<span style="color: #8f0075;">^</span>2 <span style="color: #8f0075;">/</span> 6<span style="color: #000000;">)</span><span style="color: #8f0075;">*</span>x<span style="color: #8f0075;">;</span>
fplot<span style="color: #000000;">(</span>phi2<span style="color: #8f0075;">,</span><span style="color: #dd22dd;">[</span>0<span style="color: #8f0075;">,</span>pi<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span>
grid
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orga1adffb" class="outline-2">
<h2 id="orga1adffb"><span class="section-number-2">8.</span> <span class="done DONE">DONE</span> Homework 8</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-octave">clc<span style="color: #8f0075;">;</span> clear<span style="color: #8f0075;">;</span> close all<span style="color: #8f0075;">;</span>
<span style="color: #595959;">%% </span><span style="color: #595959;">Problem 1</span>
load mesh.mat

<span style="color: #595959;">%% </span><span style="color: #595959;">Problem 2</span>
n_vertices <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>coord<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
label <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n_vertices<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n_vertices
    <span style="color: #531ab6;">if</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&lt;=</span> 1<span style="color: #8f0075;">/</span>3 <span style="color: #8f0075;">&amp;&amp;</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>2<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&lt;=</span> 1<span style="color: #8f0075;">/</span>3
        label<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 2<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">elseif</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">==</span> 1 <span style="color: #8f0075;">||</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>2<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">==</span> 1
        label<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

CheckLabels<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span>coord<span style="color: #8f0075;">,</span>label<span style="color: #000000;">)</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Problem 3</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Problem 4</span>

f <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> y<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span>sin<span style="color: #000000;">(</span>pi<span style="color: #8f0075;">*</span>x <span style="color: #8f0075;">/</span> 2<span style="color: #000000;">)</span> <span style="color: #8f0075;">.*</span> sin<span style="color: #000000;">(</span>pi<span style="color: #8f0075;">*</span>y <span style="color: #8f0075;">/</span> 2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
g <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>l<span style="color: #000000;">)</span> 0<span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> Assemble<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> f<span style="color: #8f0075;">,</span> g<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
u_h <span style="color: #8f0075;">=</span> A <span style="color: #8f0075;">\</span> b<span style="color: #8f0075;">;</span>
PlotSolution<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> u_h<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Problem 5</span>

f <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span> y<span style="color: #000000;">)</span> <span style="color: #8f0075;">-</span>sin<span style="color: #000000;">(</span>pi<span style="color: #8f0075;">*</span>x <span style="color: #8f0075;">/</span> 2<span style="color: #000000;">)</span> <span style="color: #8f0075;">.*</span> sin<span style="color: #000000;">(</span>pi<span style="color: #8f0075;">*</span>y <span style="color: #8f0075;">/</span> 2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
g <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>l<span style="color: #000000;">)</span> 0<span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>l<span style="color: #8f0075;">==</span>1<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> 1<span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>l<span style="color: #8f0075;">==</span>2<span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> 0<span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>l<span style="color: #8f0075;">==</span>0<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> Assemble<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> f<span style="color: #8f0075;">,</span> g<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
u_h <span style="color: #8f0075;">=</span> A <span style="color: #8f0075;">\</span> b<span style="color: #8f0075;">;</span>
PlotSolution<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> u_h<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

<span style="color: #595959;">%% </span><span style="color: #595959;">Problem 6</span>

u_true <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>y<span style="color: #000000;">)</span> sin<span style="color: #000000;">(</span>3 <span style="color: #8f0075;">*</span> pi <span style="color: #8f0075;">*</span> x<span style="color: #000000;">)</span> <span style="color: #8f0075;">.*</span> sin<span style="color: #000000;">(</span>3 <span style="color: #8f0075;">*</span> pi <span style="color: #8f0075;">*</span> y<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

figure<span style="color: #8f0075;">;</span>
fsurf<span style="color: #000000;">(</span>u_true<span style="color: #8f0075;">,</span> <span style="color: #dd22dd;">[</span><span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> 1<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> 1<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

f <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>y<span style="color: #000000;">)</span> 18 <span style="color: #8f0075;">*</span> pi<span style="color: #8f0075;">^</span>2 <span style="color: #8f0075;">*</span> sin<span style="color: #000000;">(</span>3 <span style="color: #8f0075;">*</span> pi <span style="color: #8f0075;">*</span> x<span style="color: #000000;">)</span> <span style="color: #8f0075;">.*</span> sin<span style="color: #000000;">(</span>3 <span style="color: #8f0075;">*</span> pi <span style="color: #8f0075;">*</span> y<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
g <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>l<span style="color: #000000;">)</span> 0<span style="color: #8f0075;">;</span>

<span style="color: #000000;">[</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> Assemble<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> f<span style="color: #8f0075;">,</span> g<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
u_h <span style="color: #8f0075;">=</span> A <span style="color: #8f0075;">\</span> b<span style="color: #8f0075;">;</span>
PlotSolution<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> u_h<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>rss_1<span style="color: #8f0075;">,</span> h_1<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> finite_element_error<span style="color: #000000;">(</span>u_h<span style="color: #8f0075;">,</span> u_true<span style="color: #8f0075;">,</span> conn<span style="color: #8f0075;">,</span> coord<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

load mesh2.mat
<span style="color: #000000;">[</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> Assemble<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> f<span style="color: #8f0075;">,</span> g<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
u_h <span style="color: #8f0075;">=</span> A <span style="color: #8f0075;">\</span> b<span style="color: #8f0075;">;</span>
PlotSolution<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> u_h<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>rss_2<span style="color: #8f0075;">,</span> h_2<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> finite_element_error<span style="color: #000000;">(</span>u_h<span style="color: #8f0075;">,</span> u_true<span style="color: #8f0075;">,</span> conn<span style="color: #8f0075;">,</span> coord<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

load mesh3.mat
<span style="color: #000000;">[</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> Assemble<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> f<span style="color: #8f0075;">,</span> g<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
u_h <span style="color: #8f0075;">=</span> A <span style="color: #8f0075;">\</span> b<span style="color: #8f0075;">;</span>
PlotSolution<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> u_h<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
<span style="color: #000000;">[</span>rss_3<span style="color: #8f0075;">,</span> h_3<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> finite_element_error<span style="color: #000000;">(</span>u_h<span style="color: #8f0075;">,</span> u_true<span style="color: #8f0075;">,</span> conn<span style="color: #8f0075;">,</span> coord<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

figure<span style="color: #8f0075;">;</span>
p <span style="color: #8f0075;">=</span> loglog<span style="color: #000000;">(</span><span style="color: #dd22dd;">[</span>h_1<span style="color: #8f0075;">,</span> h_2<span style="color: #8f0075;">,</span> h_3<span style="color: #dd22dd;">]</span><span style="color: #8f0075;">,</span> <span style="color: #dd22dd;">[</span>rss_1<span style="color: #8f0075;">,</span> rss_2<span style="color: #8f0075;">,</span> rss_3<span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
p.Marker <span style="color: #8f0075;">=</span> <span style="color: #3548cf;">"."</span><span style="color: #8f0075;">;</span>
polyfit<span style="color: #000000;">(</span>log10<span style="color: #dd22dd;">(</span><span style="color: #008899;">[</span>h_1<span style="color: #8f0075;">,</span> h_2<span style="color: #8f0075;">,</span> h_3<span style="color: #008899;">]</span><span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span>log10<span style="color: #dd22dd;">(</span><span style="color: #008899;">[</span>rss_1<span style="color: #8f0075;">,</span> rss_2<span style="color: #8f0075;">,</span> rss_3<span style="color: #008899;">]</span><span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span>


<span style="color: #595959;">%% </span><span style="color: #595959;">Functions</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>A<span style="color: #8f0075;">,</span> b<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">Assemble</span><span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> coord<span style="color: #8f0075;">,</span> f<span style="color: #8f0075;">,</span> g<span style="color: #000000;">)</span>
    n_vertices <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>coord<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    n_triangles <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>conn<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    
    label <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n_vertices<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n_vertices
        <span style="color: #531ab6;">if</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&lt;=</span> 1<span style="color: #8f0075;">/</span>3 <span style="color: #8f0075;">&amp;&amp;</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>2<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">&lt;=</span> 1<span style="color: #8f0075;">/</span>3
            label<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 2<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">elseif</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">==</span> 1 <span style="color: #8f0075;">||</span> abs<span style="color: #000000;">(</span>coord<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>2<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">==</span> 1
            label<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> 1<span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
    <span style="color: #531ab6;">end</span>

    phi_1 <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>y<span style="color: #000000;">)</span> 1 <span style="color: #8f0075;">-</span> x <span style="color: #8f0075;">-</span> y<span style="color: #8f0075;">;</span>
    phi_2 <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>y<span style="color: #000000;">)</span> x<span style="color: #8f0075;">;</span>
    phi_3 <span style="color: #8f0075;">=</span> @<span style="color: #000000;">(</span>x<span style="color: #8f0075;">,</span>y<span style="color: #000000;">)</span> y<span style="color: #8f0075;">;</span>

    phi <span style="color: #8f0075;">=</span> <span style="color: #000000;">{</span>phi_1<span style="color: #8f0075;">,</span> phi_2<span style="color: #8f0075;">,</span> phi_3<span style="color: #000000;">}</span><span style="color: #8f0075;">;</span>
   
    

    del_phi <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span><span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> 1<span style="color: #8f0075;">,</span> 0<span style="color: #8f0075;">;</span>
               <span style="color: #8f0075;">-</span>1<span style="color: #8f0075;">,</span> 0<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>

    A <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n_vertices<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    b <span style="color: #8f0075;">=</span> zeros<span style="color: #000000;">(</span>n_vertices<span style="color: #8f0075;">,</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>

    
    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n_triangles
        triangle <span style="color: #8f0075;">=</span> conn<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        v1 <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>triangle<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        v2 <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>triangle<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        v3 <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>triangle<span style="color: #dd22dd;">(</span>3<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        J <span style="color: #8f0075;">=</span> <span style="color: #000000;">[</span>v2<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> v3<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">;</span> v2<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> v3<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span><span style="color: #000000;">]</span><span style="color: #8f0075;">;</span>
        J_inv <span style="color: #8f0075;">=</span> inv<span style="color: #000000;">(</span>J<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        triangle_area <span style="color: #8f0075;">=</span> 0.5<span style="color: #8f0075;">*</span><span style="color: #000000;">(</span>abs<span style="color: #dd22dd;">(</span>det<span style="color: #008899;">(</span>J_inv<span style="color: #008899;">)</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>


        mid_x <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>v1<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">+</span> v2<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">+</span> v3<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> 3<span style="color: #8f0075;">;</span>
        mid_y <span style="color: #8f0075;">=</span> <span style="color: #000000;">(</span>v1<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">+</span> v2<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">+</span> v3<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">/</span> 3<span style="color: #8f0075;">;</span>
        ref_v <span style="color: #8f0075;">=</span> J_inv <span style="color: #8f0075;">*</span> <span style="color: #000000;">(</span><span style="color: #dd22dd;">[</span>mid_x<span style="color: #8f0075;">;</span> mid_y<span style="color: #dd22dd;">]</span> <span style="color: #8f0075;">-</span> <span style="color: #dd22dd;">[</span>v1<span style="color: #008899;">(</span>1<span style="color: #008899;">)</span><span style="color: #8f0075;">;</span> v1<span style="color: #008899;">(</span>2<span style="color: #008899;">)</span><span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        ref_x <span style="color: #8f0075;">=</span> ref_v<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        ref_y <span style="color: #8f0075;">=</span> ref_v<span style="color: #000000;">(</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        
        <span style="color: #531ab6;">for</span> j<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>3
            b<span style="color: #000000;">(</span>conn<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> b<span style="color: #000000;">(</span>conn<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> triangle_area <span style="color: #8f0075;">*</span> f<span style="color: #000000;">(</span>mid_x<span style="color: #8f0075;">,</span> mid_y<span style="color: #000000;">)</span> <span style="color: #8f0075;">*</span> phi<span style="color: #000000;">{</span>j<span style="color: #000000;">}(</span>ref_x<span style="color: #8f0075;">,</span> ref_y<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            <span style="color: #531ab6;">for</span> k<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>3
                A<span style="color: #000000;">(</span>conn<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> conn<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> A<span style="color: #000000;">(</span>conn<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>j<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,</span> conn<span style="color: #dd22dd;">(</span>i<span style="color: #8f0075;">,</span>k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">+</span> triangle_area <span style="color: #8f0075;">*</span> <span style="color: #000000;">(</span>J_inv<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> del_phi<span style="color: #dd22dd;">(</span><span style="color: #8f0075;">:,</span> j<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> <span style="color: #000000;">(</span>J_inv<span style="color: #8f0075;">'</span> <span style="color: #8f0075;">*</span> del_phi<span style="color: #dd22dd;">(</span><span style="color: #8f0075;">:,</span> k<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
            <span style="color: #531ab6;">end</span>
        <span style="color: #531ab6;">end</span>
    <span style="color: #531ab6;">end</span>

    I <span style="color: #8f0075;">=</span> eye<span style="color: #000000;">(</span>n_vertices<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n_vertices
        <span style="color: #531ab6;">if</span> label<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">~=</span> 0
            A<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">:</span><span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> I<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">';</span>
            b<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span> <span style="color: #8f0075;">=</span> g<span style="color: #000000;">(</span>label<span style="color: #dd22dd;">(</span>i<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        <span style="color: #531ab6;">end</span>
    <span style="color: #531ab6;">end</span>
<span style="color: #531ab6;">end</span>

<span style="color: #531ab6;">function</span> <span style="color: #000000;">[</span>rss<span style="color: #8f0075;">,</span> h<span style="color: #000000;">]</span> <span style="color: #8f0075;">=</span> <span style="color: #721045;">finite_element_error</span><span style="color: #000000;">(</span>u_h<span style="color: #8f0075;">,</span> u_true<span style="color: #8f0075;">,</span> conn<span style="color: #8f0075;">,</span> coord<span style="color: #000000;">)</span>
    triangle <span style="color: #8f0075;">=</span> conn<span style="color: #000000;">(</span>1<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    v1 <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>triangle<span style="color: #dd22dd;">(</span>1<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    v2 <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>triangle<span style="color: #dd22dd;">(</span>2<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    v3 <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>triangle<span style="color: #dd22dd;">(</span>3<span style="color: #dd22dd;">)</span><span style="color: #8f0075;">,:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    h <span style="color: #8f0075;">=</span> det<span style="color: #000000;">(</span><span style="color: #dd22dd;">[</span>v2<span style="color: #008899;">(</span>1<span style="color: #008899;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #008899;">(</span>1<span style="color: #008899;">)</span><span style="color: #8f0075;">,</span> v3<span style="color: #008899;">(</span>1<span style="color: #008899;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #008899;">(</span>1<span style="color: #008899;">)</span><span style="color: #8f0075;">;</span> v2<span style="color: #008899;">(</span>2<span style="color: #008899;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #008899;">(</span>2<span style="color: #008899;">)</span><span style="color: #8f0075;">,</span> v3<span style="color: #008899;">(</span>2<span style="color: #008899;">)</span> <span style="color: #8f0075;">-</span> v1<span style="color: #008899;">(</span>2<span style="color: #008899;">)</span><span style="color: #dd22dd;">]</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    n_vertices <span style="color: #8f0075;">=</span> size<span style="color: #000000;">(</span>coord<span style="color: #8f0075;">,</span> 1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
    rss <span style="color: #8f0075;">=</span> 0<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">for</span> i<span style="color: #8f0075;">=</span>1<span style="color: #8f0075;">:</span>n_vertices
        v <span style="color: #8f0075;">=</span> coord<span style="color: #000000;">(</span>i<span style="color: #8f0075;">,</span> <span style="color: #8f0075;">:</span><span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        x <span style="color: #8f0075;">=</span> v<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span> y <span style="color: #8f0075;">=</span> v<span style="color: #000000;">(</span>2<span style="color: #000000;">)</span><span style="color: #8f0075;">;</span>
        rss <span style="color: #8f0075;">=</span> rss <span style="color: #8f0075;">+</span> <span style="color: #000000;">(</span>u_h<span style="color: #dd22dd;">(</span>i<span style="color: #dd22dd;">)</span> <span style="color: #8f0075;">-</span> u_true<span style="color: #dd22dd;">(</span>x<span style="color: #8f0075;">,</span>y<span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span><span style="color: #8f0075;">^</span>2<span style="color: #8f0075;">;</span>
    <span style="color: #531ab6;">end</span>
    <span style="color: #595959;">%rss = rss / n_vertices;</span>
<span style="color: #531ab6;">end</span>
</pre>
</div>

<p>
For Problem 6
</p>

<p>
\[ u(x,y) = \sin \left( 3 \pi x \right) \sin \left( 3 \pi y \right) \]
</p>

<p>
We note that this choice of \( u \) satisfies the boundary conditions,
</p>

\begin{align}
u \left( \frac{1}{3}, y \right) = \sin(\pi) \sin(3 \pi y) = 0 \\
u \left( 1, y \right) = \sin(3 \pi) \sin(3 \pi y) = 0 \\
\end{align}

<p>
The function is symmetric in \( x \) and \( y \) and is odd in both arguments, hence the corresponding \( y \) values and \( -1, -\frac{1}{3} \) values have the proper boundary conditions.    
</p>

<p>
The Laplacian is,
</p>

<p>
\[ \Delta u = -18 \pi^{2} \sin \left( 3 \pi x \right) \sin \left( 3 \pi y \right)  \]
</p>

<p>
The slope in log-log scale is <code>0.9969</code> which is approximately \( 1 \). We may conclude that the relationship between mesh size and error rate is linear.
</p>

<p>
Figures:
</p>

<p>
<img src="file:///home/zjabbar/dwn/Homework 8/Labels.png" alt="Labels.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/Homogeneous BC Dirichlet Solution.png" alt="Homogeneous BC Dirichlet Solution.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/Inhomogeneous BC Dirichlet Solution.png" alt="Inhomogeneous BC Dirichlet Solution.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/True Solution.png" alt="True Solution.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/FE Approximation Mesh 1.png" alt="FE Approximation Mesh 1.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/FE Approximation Mesh 2.png" alt="FE Approximation Mesh 2.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/FE Approximation Mesh 3.png" alt="FE Approximation Mesh 3.png" />
<img src="file:///home/zjabbar/dwn/Homework 8/Error vs Grid Size.png" alt="Error vs Grid Size.png" />
</p>
</div>
</div>
<div id="outline-container-org0b976fa" class="outline-2">
<h2 id="org0b976fa"><span class="section-number-2">9.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-9">
<p>
Went over Matrix and Vector Norms.
</p>

<p>
While a matrix could be viewed as a (long) vector, they have a notion of multiplication.
The norm respects this fact by stipulating submultiplicativity of the norm when composing.
</p>

<p>
Given Homework which is due on the 31st.
</p>
</div>
</div>
<div id="outline-container-org7834be4" class="outline-2">
<h2 id="org7834be4"><span class="section-number-2">10.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-10">
<p>
Talked about SVD. Used compared SVD with Eigendecomposition.
</p>
</div>
</div>
<div id="outline-container-orge022324" class="outline-2">
<h2 id="orge022324"><span class="section-number-2">11.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-11">
<p>
Used the SVD to learn about our matrix. Showed that the low rank approximation (given by truncating the SVD rank 1 sums) are the best possible approximation for a given rank.
</p>
</div>
</div>
<div id="outline-container-orgf16acea" class="outline-2">
<h2 id="orgf16acea"><span class="section-number-2">12.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-12">
<p>
\[ A = \hat{Q}\hat{R} \]
</p>

<p>
Where \( \hat{Q} \in \mathbb{C}^{m\times n} \) has orthonormal columns and  \( \hat{R} \in \mathbb{C}^{n \times n} \) is upper triangular.
</p>

<p>
Classical Gram-Schmidt
</p>

<div class="VERBATIM" id="orgb4df28f">
\begin{lflalign}
q_{1} &= \frac{a_{1}}{\| a_{1} \|} \\
q_{2} &= \frac{a_{2} - q_{2} q_{2}^{\ast} a_{2}}{\| a_{1} \|} \\
q_{n} &= \frac{a_{n} - \sum q_{2} q_{2}^{\ast} a_{2}}{\| a_{1} \|}
\end{lflalign}

</div>
</div>
</div>
<div id="outline-container-org1ae641b" class="outline-2">
<h2 id="org1ae641b"><span class="section-number-2">13.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-13">
</div>
</div>
<div id="outline-container-org1205fe3" class="outline-2">
<h2 id="org1205fe3"><span class="section-number-2">14.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-14">
</div>
</div>
<div id="outline-container-org904fd77" class="outline-2">
<h2 id="org904fd77"><span class="section-number-2">15.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-15">
</div>
</div>
<div id="outline-container-org4e896ae" class="outline-2">
<h2 id="org4e896ae"><span class="section-number-2">16.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-16">
<p>
Talked about condition numbers and machine epsilon.
</p>
</div>
</div>
<div id="outline-container-org44f3c9b" class="outline-2">
<h2 id="org44f3c9b"><span class="section-number-2">17.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-17">
<p>
Problem:
</p>

<p>
\( f \colon \mathbb{C} \times \mathbb{C} \to \mathbb{C} \)
</p>


<p>
Algorithm
\( \tilde{f} \colon \mathbb{C} \times \mathbb{C} \to \mathbb{C} \)
</p>


<p>
Last class we showed that \( x - y \) is backwards stable:
</p>

<p>
\[ \operatorname{f\ell}(x) \]
</p>


\begin{align}
f &\colon (x,y) \mapsto x - y \tag{Problem} \\
\tilde{f} &\colon (x,y) \mapsto \fl(x) \ominus \fl(y) \tag{Algorithm}
\end{align}

<p>
Remark, \( \tilde{f} \) is not accurate (in the precise way).
</p>

<p>
Remark 2: A similar argument shows that \( \otimes, \odiv, \oplus \) are also backwards stable.
</p>
</div>
</div>
<div id="outline-container-orge9b59b7" class="outline-2">
<h2 id="orge9b59b7"><span class="section-number-2">18.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-18">
</div>
</div>
<div id="outline-container-org9d96527" class="outline-2">
<h2 id="org9d96527"><span class="section-number-2">19.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-19">
</div>
</div>
<div id="outline-container-org7bd346d" class="outline-2">
<h2 id="org7bd346d"><span class="section-number-2">20.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-20">
</div>
</div>
<div id="outline-container-org1369f86" class="outline-2">
<h2 id="org1369f86"><span class="section-number-2">21.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-21">
</div>
</div>
<div id="outline-container-orgc854e74" class="outline-2">
<h2 id="orgc854e74"><span class="section-number-2">22.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-22">
</div>
</div>
<div id="outline-container-orgddfe4b9" class="outline-2">
<h2 id="orgddfe4b9"><span class="section-number-2">23.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-23">
</div>
</div>
<div id="outline-container-org5395720" class="outline-2">
<h2 id="org5395720"><span class="section-number-2">24.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-24">
</div>
</div>
<div id="outline-container-orgec1517c" class="outline-2">
<h2 id="orgec1517c"><span class="section-number-2">25.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-25">
<p>
Test
1 - 16, 19-26
</p>
</div>
</div>
<div id="outline-container-org280fbb5" class="outline-2">
<h2 id="org280fbb5"><span class="section-number-2">26.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-26">
</div>
</div>
<div id="outline-container-org041ebec" class="outline-2">
<h2 id="org041ebec"><span class="section-number-2">27.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-27">
</div>
</div>
<div id="outline-container-orgc059d4d" class="outline-2">
<h2 id="orgc059d4d"><span class="section-number-2">28.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-28">
</div>
</div>
<div id="outline-container-org682cb24" class="outline-2">
<h2 id="org682cb24"><span class="section-number-2">29.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-29">
</div>
</div>
<div id="outline-container-orge54a0cd" class="outline-2">
<h2 id="orge54a0cd"><span class="section-number-2">30.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-30">
</div>
</div>
<div id="outline-container-org6dd0f45" class="outline-2">
<h2 id="org6dd0f45"><span class="section-number-2">31.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-31">
</div>
</div>
<div id="outline-container-orgfcf0901" class="outline-2">
<h2 id="orgfcf0901"><span class="section-number-2">32.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-32">
</div>
</div>
<div id="outline-container-org10b87d2" class="outline-2">
<h2 id="org10b87d2"><span class="section-number-2">33.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-33">
</div>
</div>
<div id="outline-container-orgcd82dae" class="outline-2">
<h2 id="orgcd82dae"><span class="section-number-2">34.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-34">
</div>
</div>
<div id="outline-container-org384ad2f" class="outline-2">
<h2 id="org384ad2f"><span class="section-number-2">35.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-35">
</div>
</div>
<div id="outline-container-orgcc19f7d" class="outline-2">
<h2 id="orgcc19f7d"><span class="section-number-2">36.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-36">
</div>
</div>
<div id="outline-container-org5e7d6ba" class="outline-2">
<h2 id="org5e7d6ba"><span class="section-number-2">37.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-37">
</div>
</div>
<div id="outline-container-org4f3099d" class="outline-2">
<h2 id="org4f3099d"><span class="section-number-2">38.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-38">
</div>
</div>
<div id="outline-container-org466cb69" class="outline-2">
<h2 id="org466cb69"><span class="section-number-2">39.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-39">
</div>
</div>
<div id="outline-container-org59b542e" class="outline-2">
<h2 id="org59b542e"><span class="section-number-2">40.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-40">
</div>
</div>
<div id="outline-container-orgf254e3b" class="outline-2">
<h2 id="orgf254e3b"><span class="section-number-2">41.</span> <span class="done DONE">DONE</span> MATH 607</h2>
<div class="outline-text-2" id="text-41">
</div>
</div>
</div>
</body>
</html>
